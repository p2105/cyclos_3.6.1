<?xml version="1.0"?>

<!DOCTYPE cyclos-changelog [
    <!-- Root element -->
    <!ELEMENT cyclos-changelog (version+)>

    <!-- Version descriptor -->
    <!ELEMENT version (
        description?, 
        enhancements?, 
        bug-fixes?, 
        new-libraries?, 
        removed-libraries?, 
        new-helps?, 
        removed-helps?, 
        new-static-files?, 
        removed-static-files?,
        new-translation-keys?,
        removed-translation-keys?,
        new-setup-keys?,
        removed-setup-keys?,
        new-css-classes?,
        removed-css-classes?,
        statements*,
        migration*
    )>
    <!ATTLIST version label CDATA #REQUIRED>

    <!-- Optional version description -->
    <!ELEMENT description (#PCDATA)>

    <!-- 
        Database statements to be applied if autoSchemaUpgrade is enabled.
        The required database attribute indicates the database name (same as the returned
        by java.sql.DatabaseMetaData.getDatabaseProductName(), but case insensitive)
        that the statements apply.
    -->
    <!ELEMENT statements (item*)>
    <!ATTLIST statements database CDATA #REQUIRED>

    <!-- 
        A migration class to be executed
    -->
    <!ELEMENT migration EMPTY>
    <!ATTLIST migration database CDATA #REQUIRED>
    <!ATTLIST migration class CDATA #REQUIRED>
    
    <!-- Contains a list of new / modified features -->
    <!ELEMENT enhancements (item*)>

    <!-- Contains a list of bug fixes -->
    <!ELEMENT bug-fixes (item*)>

    <!-- Contains a list of new help files -->
    <!ELEMENT new-helps (item*)>

    <!-- Contains a list of removed help files -->
    <!ELEMENT removed-helps (item*)>

    <!-- Contains a list of new static files -->
    <!ELEMENT new-static-files (item*)>

    <!-- Contains a list of removed static files -->
    <!ELEMENT removed-static-files (item*)>

    <!-- Contains a list of new translation keys -->
    <!ELEMENT new-translation-keys (item*)>

    <!-- Contains a list of removed translation keys -->
    <!ELEMENT removed-translation-keys (item*)>

    <!-- Contains a list of new translation keys on the setup package -->
    <!ELEMENT new-setup-keys (item*)>

    <!-- Contains a list of removed translation keys on the setup package -->
    <!ELEMENT removed-setup-keys (item*)>

    <!-- Contains a list of new CSS classes -->
    <!ELEMENT new-css-classes (item*)>

    <!-- Contains a list of removed CSS classes -->
    <!ELEMENT removed-css-classes (item*)>

    <!-- A list item -->
    <!ELEMENT item (#PCDATA)>
]>

<cyclos-changelog>
	<version label="3.6.1">
		<enhancements>
			<item>Improvements on account fee execution handling: It is now possible to view an specific account fee execution details</item>
			<item>Improved performance when used Hibernate second level cache</item>
			<item>It is now possible to export member records to CSV from the global search</item>
			<item>Added a message for the first execution on standalone, after creating the DB, that Cyclos is still initializing</item>
			<item>Now the variables in notifications have been standardized and documented. Existing notification on the database have been updated to the new value.</item>
			<item>Improved the extension point of defining Java class names which are notified on payments</item>
			<item>Improved the account fee charging handing. Now, no manual administrator intervention is needed, except for starting fees defined to manually run. The cancel and recharge actions were removed.</item>
			<item>On the transaction type details, the transaction fees and broker commissions lists now include a column for the 'enabled' property</item>
			<item>Added a permission to change member e-mail. All groups with permission to change the name should initially have that permission too.</item>
			<item>Added the transaction number to the mobile / wap view payment page</item>
			<item>Added a flag on member group to show the description field on payments performed via PosWeb access</item>
			<item>Improved default layout of the posweb access (if there is an applied theme, you may need to re-apply it)</item>
			<item>Added an option in cyclos.properties to control the creation of a new session cookie right after logging-in. This option is better for security, but caused problems with some versions of Joomla when embedding Cyclos in an IFrame</item>
		</enhancements>

		<bug-fixes>
			<item>If a member doesn't save his preferences he will never receive a sms mailing</item>
			<item>The member's group sms preferences were not taken into account when the sms status is created the first time</item>
			<item>Admins with permission to grant loans but without permission to make regular payments where being denied from granting loans</item>
			<item>Saving a transaction fee or broker commission while setting specific 'to groups' could result in permission denied errors</item>
			<item>Text custom fields which are set for search filters where not correctly being applied</item>
			<item>When customizing a new file, the 'Modify' button shouldn't be displayed</item>
			<item>Payment description was not being returned via web services</item>
			<item>Javascript error on print pages</item>
			<item>Actions in the payment confirmation page (print / go to profile / new payment) where not working on some cases</item>
			<item>After performing a system payment, the buttons on confirmation page didn't work</item>
			<item>Javascript error on edit guarantee type</item>
			<item>If an existing database with pending Lucene index operations in a future date are found, the index would be indefinitely rebuilt</item>
			<item>Under some circumstances, the low units notification was not being sent</item>
			<item>The low units message on the group account settings was never used, when it should override (if present) the body in the message settings</item>
			<item>It was not possible to permanently remove an inactive member if there where member records or remarks</item>
			<item>It was not possible to enable a loan transfer type due to a JavaScript error</item>
			<item>On the account fee executions page, the next execution for daily or weekly scheduled account fees where incorrect</item>
			<item>On the account fees list, on the account type details, for weekly fees, the weekday was not being correctly displayed</item>
			<item>When trying to login with an user of a group without permission to login, an error log was being mistakenly generated</item>
			<item>Removed unused alert setting: Alert new pending members. This setting is no longer used since we added the e-mail validation on registration</item>
			<item>If a member had a blocked transaction password, the admins or broker couldn't change his PIN</item>
			<item>It was not possible for admins to accept invoices in behalf of members if the payment type is disabled (only for generated invoices)</item>
			<item>Fixed a duplicate validation message on public registration indicating that the e-mail is not unique</item>
			<item>Filtering the account history by group filters or groups always resulted in empty list</item>
			<item>On mobile and WAP payments, the description shouldn't be required</item>
			<item>The standalone server was not working with Java 7 on Windows</item>
			<item>E-mails were being required to be unique even if the settings said they shouldn't</item>
			<item>Ugly radio buttons were being generated for custom fields (thanks to timreeves)</item>
			<item>In case of validation error on the account fee page, after showing the error popup window, the error was being shown again in a new page</item>
			<item>Volume account fees with period = 1 day where never being charged</item>
			<item>Removed an unnecessary warning when disabling a volume account fee</item>
			<item>Webshop (external) payments were broken</item>
			<item>Changed the color of the 'no e-mail' text in notification preferences to make it more visible</item>
			<item>On admin group permissions, the transfer types were not being updated on the fly when changing the system accounts visibility</item>
			<item>When making a payment from member to member as admin or broker, after selecting a destination member, the back button would jump to that member profile, instead of the original member's profile</item>
			<item>When an administrator or broker couldn't change a member pin, only the external access, the page was still showing the change pin form</item>
			<item>Sometimes, a message that there were errors while displaying the results was being shown on the error / information page by mistake</item>
			<item>When there where new translation-related settings, the first time the application starts up, it would show them always in English</item>
			<item>An administrator with the permission to view account management, but without permission to view account information for any system accounts always had an error when trying to view the system accounts overview page</item>
			<item>If a scheduled account fee was disabled for a long time and then re-enabled, the next charged period would be wrong, taking the old execution as base</item>
			<item>When a session was expired, the last login date of the user was not updated</item>
			<item>When using fixed numbers on a custom field mask (example: \0\9########), the value was not correctly being saved</item>
			<item>When permanently removing a message through the remove icon, but the checkbox was also checked, there was an error</item>
			<item>Expired advertisements or removed members could be loaded via web services using the load method</item>
			<item>The state report was showing wrong results for system / member account balance when there are chargebacks</item>
			<item>On profile or ad details, enumerated custom fields with parent fields had the first option selected when clicking modify / cancel, instead of the original value again</item>
			<item>Removing HTML tags from fields didn't handle spaces correctly on the output. This caused issues with indexing of HTML custom fields with nested tags</item>
			<item>Stop customizing an application page could lead to the old content being served</item>
			<item>On the login page, when pressing enter while on the login name field, the password field should receive focus</item>
			<item>Custom fields of type date, decimal or boolean, when used as search filters where always causing empty results</item>
			<item>For large number of results in export member records to CSV, an application error could happen</item>
			<item>It was possible to create an advertisement as scheduled with a future publication date, then changing it to permanent, making it appear first in the result list (which is ordered by publication start date)</item>
			<item>Entering invalid username in webshop payment generated an application error (and a new error log entry)</item>
		</bug-fixes>

		<new-libraries>
			<item>hazelcast-1.9.4.8.jar</item>
		</new-libraries>

		<removed-libraries>
			<item>hazelcast-1.9.4.4.jar</item>
		</removed-libraries>

		<new-translation-keys>
			<item>accountFee.noMatchingMembers</item>
			<item>accountFee.title.logDetails</item>
			<item>accountFee.title.memberSearch</item>
			<item>accountFeeLog.acceptedInvoices</item>
			<item>accountFeeLog.count</item>
			<item>accountFeeLog.failedMembers</item>
			<item>accountFeeLog.finishDate</item>
			<item>accountFeeLog.finished</item>
			<item>accountFeeLog.neverRan</item>
			<item>accountFeeLog.openInvoices</item>
			<item>accountFeeLog.payments</item>
			<item>accountFeeLog.period</item>
			<item>accountFeeLog.processedMembers</item>
			<item>accountFeeLog.rechargeFailed</item>
			<item>accountFeeLog.rechargingFailed</item>
			<item>accountFeeLog.running</item>
			<item>accountFeeLog.skippedMembers</item>
			<item>accountFeeLog.status.ACCEPTED_INVOICE</item>
			<item>accountFeeLog.status.ERROR</item>
			<item>accountFeeLog.status.INVOICE</item>
			<item>accountFeeLog.status.OPEN_INVOICE</item>
			<item>accountFeeLog.status.PROCESSED</item>
			<item>accountFeeLog.status.SKIPPED</item>
			<item>accountFeeLog.status.TRANSFER</item>
			<item>accountFeeLog.stillRunning</item>
			<item>accountFeeLog.totalAmount</item>
			<item>accountFeeLog.totalCollectedAmount</item>
			<item>accountFeeLog.totalInvoices</item>
			<item>alert.member.nullIRate</item>
			<item>alert.system.ACCOUNT_FEE_FINISHED_WITH_ERRORS</item>
			<item>alert.system.accountFeeFinishedWithErrors</item>
			<item>alert.system.nullIRate</item>
			<item>group.account.pendingAccounts</item>
			<item>group.settings.showPosWebPaymentDescription</item>
			<item>group.title.settings.payments</item>
			<item>message.error.pendingMessagesToBeSent</item>
			<item>mobile.viewPayments.transactionNumber</item>
			<item>permission.adminMembers.changeEmail</item>
			<item>permission.brokerMembers.changeEmail</item>
			<item>permission.memberProfile.changeEmail</item>
			<item>posweb.bannerText</item>
			<item>smsMailing.byBroker.all</item>
		</new-translation-keys>

		<removed-translation-keys>
			<item>accountFee.action.alreadyFinished</item>
			<item>accountFee.action.cancel.confirmation</item>
			<item>accountFee.action.canceled</item>
			<item>accountFee.action.recharge.confirmation</item>
			<item>accountFee.action.recharged</item>
			<item>accountFee.disableConfirmation</item>
			<item>accountFeeLog.status.CANCELED</item>
			<item>accountFeeLog.status.FINISHED</item>
			<item>accountFeeLog.status.NEVER_RAN</item>
			<item>accountFeeLog.status.PARTIALLY_FAILED</item>
			<item>accountFeeLog.status.RUNNING</item>
			<item>alert.system.ACCOUNT_FEE_CANCELLED</item>
			<item>alert.system.ACCOUNT_FEE_FAILED</item>
			<item>alert.system.ACCOUNT_FEE_RECOVERED</item>
			<item>alert.system.accountFeeCancelled</item>
			<item>alert.system.accountFeeFailed</item>
			<item>alert.system.accountFeeRecovered</item>
			<item>group.account.pendingInitialCredits</item>
			<item>group.title.settings.scheduledPayments</item>
			<item>lastTransaction.commit</item>
			<item>loan.title.canPerformExpiredAction</item>
			<item>permission.adminMemberRemarks</item>
			<item>permission.adminMemberRemarks.manage</item>
			<item>permission.adminMemberRemarks.view</item>
			<item>smsMailing.broker.group</item>
		</removed-translation-keys>

		<new-setup-keys>
			<item>setup.standalone.starting</item>
		</new-setup-keys>
		
        <statements database="mysql">
        	<item>alter table account_fee_logs add column finish_date datetime</item>
        	<item>update account_fee_logs l inner join account_fees f on l.account_fee_id = f.id set l.finish_date = l.date where l.status = 'F' or f.enabled_since is null</item>
        	<item>alter table account_fee_logs drop column status</item>
        	<item>delete from alerts where msg_key in ('alert.system.accountFeeCancelled', 'alert.system.accountFeeFailed', 'alert.system.accountFeeRecovered')</item>
			<item>update settings set value = replace(value, '#fromMemberName#', '#from_member#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#toMemberName#', '#to_member#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#fromMemberUsername#', '#from_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#toMemberUsername#', '#to_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#brokerUsername#', '#broker_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#memberUsername#', '#member_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#grantDate#', '#grant_date#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#issuerName#', '#issuer_member#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#issuerUsername#', '#issuer_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#buyerName#', '#buyer_member#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#buyerUsername#', '#buyer_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#sellerName#', '#seller_member#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#sellerUsername#', '#seller_login#') where type = 'message'</item>
			<item>update settings set value = replace(value, '#creditLimit#', '#credit_limit#') where type = 'message'</item>
			<item>alter table accounts add column last_low_units_sent datetime</item>
			<item>alter table account_fee_logs add unique key uk_fee_log_fee_date (account_fee_id, date)</item>
			<item>delete from settings where name='alertNewPendingMembers'</item>
			<item>insert into permissions (group_id, permission) select group_id, 'AdminMemberPermission.MEMBERS_CHANGE_EMAIL' from permissions where permission = 'AdminMemberPermission.MEMBERS_CHANGE_NAME'</item>
			<item>insert into permissions (group_id, permission) select group_id, 'BrokerPermission.MEMBERS_CHANGE_EMAIL' from permissions where permission = 'BrokerPermission.MEMBERS_CHANGE_NAME'</item>
			<item>insert into permissions (group_id, permission) select group_id, 'MemberPermission.PROFILE_CHANGE_EMAIL' from permissions where permission = 'MemberPermission.PROFILE_CHANGE_NAME'</item>
			<item>alter table member_account_fee_logs add column amount decimal(15,6), add column success bit(1) not null default false</item>
			<item>update member_account_fee_logs l inner join invoices i on l.invoice_id = i.id set l.amount = i.amount</item>
			<item>update member_account_fee_logs l inner join transfers t on l.transfer_id = t.id set l.amount = t.amount</item>
			<item>update member_account_fee_logs set amount = 0 where transfer_id is null and invoice_id is null</item>
			<item>update member_account_fee_logs set success = true</item>
			<item>alter table account_fee_logs add column recharging_failed bit(1) not null default false</item>
			<item>create table members_pending_charge (member_id integer not null, account_fee_log_id integer not null) ENGINE=InnoDB</item>
			<item>alter table members_pending_charge add index FK265D1E42EAE0AB57 (member_id), add constraint FK265D1E42EAE0AB57 foreign key (member_id) references members (id)</item>
			<item>alter table members_pending_charge add index FK265D1E426957A5AA (account_fee_log_id), add constraint FK265D1E426957A5AA foreign key (account_fee_log_id) references account_fee_logs (id)</item>
			<item>
				insert into members_pending_charge 
				(account_fee_log_id, member_id) 
				select l.id, m.id 
				from account_fee_logs l cross join members m
				where m.subclass = 'M'
				and l.finish_date is null 
				and m.group_id in (
					select gaf.group_id
					from groups_account_fees gaf
					where gaf.account_fee_id = l.account_fee_id
				)
				and not exists (
					select 1
					from member_account_fee_logs ml
					where ml.account_fee_log_id = l.id
					  and ml.member_id = m.id
				)
			</item>
			<item>alter table account_fee_logs add column total_members integer</item>
			<item>
				update account_fee_logs l 
				set l.total_members = (
						select count(*) as count
						from member_account_fee_logs mafl
						where mafl.account_fee_log_id = l.id
					) + (
						select count(*) as count
						from members_pending_charge mpc
						where mpc.account_fee_log_id = l.id
					)
				where l.total_members is null
			</item>
			<item>alter table account_fee_logs add column failed_members integer not null default 0</item>
			<item>alter table account_fee_logs add column recharge_attempt integer not null default 0</item>
			<item>alter table member_account_fee_logs add column recharge_attempt integer not null default 0</item>
			<item>alter table groups add column member_show_posweb_pmt_dsc bit(1) not null default false</item>
			<item>
				insert into alerts (subclass, date, removed, member_id, msg_key, arg0) 
				select 'M', current_timestamp(), false, m.id, 'alert.member.initialCreditFailed', at.name
				from pending_initial_credits pic 
					inner join accounts a on pic.account_id = a.id
					inner join account_types at on a.type_id = at.id
					inner join members m on a.member_id = m.id
			</item>
			<item>drop table pending_initial_credits</item>
			<item>update ads set publication_start = creation_date where permanent = true</item>
        </statements>
	</version>
	
    <version label="3.6">
        <enhancements>
        	<item>Improved HTML / JavaScript performance and standards compliance</item>
        	<item>On the login form, pressing enter will focus the next field, or submit the form if on password field</item>
		</enhancements>
		
		<bug-fixes>
			<item>Members couldn't see their operators. After the first member listed his operators / groups, other members wouldn't be able to see their own operators</item>
			<item>When an installment of a scheduled payment when authorization is needed is authorized, it means now that on due dates, the next installments won't go through the authorization process again</item>
			<item>When exporting members or advertisements as CSV, the last record was not being included on the file</item>
			<item>Scheduled payments from system to member would result in a permission error if the receiver member would try to view the payment details</item>
			<item>It was not possible to save transaction fees</item>
			<item>When using a customized login page for group / group filter, clicking on access options would show the global login page</item>
			<item>Now the error page during posweb has the posweb header and footer (if customized, as they are empty by default)</item>
			<item>There were no confirmation messages for info texts being inserted or modified</item>
			<item>Operators without permissions to view his member's account couldn't do receive payments on WebPOS. Also, without the regular make payment permission, the WebPOS make payment permission was not enough</item>
			<item>When an account fee was disabled, then re-enabled in a future date, the next execution was being based on the last execution, not on the new enabling date</item>
			<item>Administrator notifications from payments made through external channels were not being sent</item>
			<item>When editing an existing customized file, after clicking change and then cancel, the contents were cleared</item>
			<item>A permission denied exception was thrown when chargeback a payment to system</item>			
		</bug-fixes>

		<new-libraries>
			<item>json_simple-1.1.jar</item>
		</new-libraries>
				
		<new-translation-keys>
            <item>createMember.created</item>
            <item>createMember.created.mailError</item>
            <item>settings.local.language.GREEK</item>
		</new-translation-keys>
		
		<removed-translation-keys>
		            <item>createMember.admin.created</item>
		            <item>createMember.admin.created.mailError</item>
		            <item>createMember.broker.created</item>
		            <item>createMember.broker.created.mailError</item>
		            <item>settings.local.language.Greek</item>
		</removed-translation-keys>
		
		<statements database="mysql">
			<item>insert into settings(type, name, value) 
					select distinct 'local', 'smsEnabled', 'true' 
					from settings s 
					where not exists (select id from settings where type='local' and name = 'smsEnabled') 
	  				and exists (select id from settings where type='local' and name = 'sendSmsWebServiceUrl' and value is not null) 
	  				and exists (select id from settings where type='local' and name = 'smsChannelName' and value is not null) 
	  				and exists (select id from settings where type='local' and name = 'smsCustomFieldId' and value is not null)</item>
        </statements>
	</version>
	
    <version label="3.6_RC2">
        <enhancements>
        	<item>General auditing and review on security. Cyclos should be much more secure now</item>
        	<item>Faster startup times</item>
        	<item>Lots of performance improvements</item>
        	<item>It is now possible to deploy Cyclos in a cluster, allowing not only high availability, but better scalability</item>
        	<item>It is now possible to choose whether to log to trace file only if there were database writes</item>
        	<item>Now logging generated from web service access goes to a separate file</item>
        	<item>Added an access setting to allow or not concurrent logins from the same user</item>
			<item>Support was added to allow a WS client to set a trace data that will be transferred to the external WS implementors. For example: trace data attached to a payment done by WS will be transferred to the receiver through the corresponding notification generated from that payment</item>
        	<item>Added the possibility to use a local receipt printer on PosWeb and in the main web interface for printing transaction receipts (a permission should be granted first)</item>
        	<item>Processed payment requests can now be printed directly on the request payment page</item>
        	<item>Now operators can filter the account history by operator, just like the member</item>
        	<item>Payments generated through accepted invoices which were sent by operators can now be queried on the account history through the operator filter</item>
        	<item>Added a blacklist and a whitelist for groups allowed to login in cyclos.properties</item>
        	<item>Added 2 extra options for transaction fees as payer or receiver: source member broker and destination member broker</item>
        	<item>Added to member group the default options for SMS notifications (allow charging, accept free mailings and accept paid mailings)</item>
        	<item>When no card types or registration agreements, those no longer appear on group details page</item>
        	<item>It is now possible to have ad interests only with title and type</item>
        	<item>When there are pending commission contracts, the member home shows a link now</item>
        	<item>The admin e-mail notification for new registered members has been extended not only to public registration, but now allows any member group and any type of registration</item>
        	<item>On broker's registered members list the status filter for 'Awaiting activation' now only shows up if the broker's group has inactive groups as possible initial groups for registration</item>
        	<item>Broker commissions paid by members now only allows the corresponding broker in relation to the member paying the commission (either source or destination). Previous versions allowed a quite strange combination of one member paying to the other one's broker, which conflicted with commission contracts and default commission settings</item>
        	<item>Now it's possible to have a catalog with the SMS operations. This will allow, for example, add custom commands to the SMS module and set the corresponding message showed in the SMS log</item>
        	<item>The state overview report now supports a date / time for historical data. However, this is not available for invoices, loans and references, as historical data is not stored</item>
        	<item>Added a class name for callbacks on processed transactions in both transfer type (for specific transactions) and in local settings (for all transactions)</item>
        	<item>Now there is a checkbox in the payment custom field to enable / disable it for new payments. It is not possible to remove custom fields once they are used</item>
        	<item>Association or deactivation of new accounts now runs in background.</item> 
        </enhancements>
        
        <bug-fixes>
        	<item>When inserting advertisement categories, the newly created category's order was not at the end of the list</item>
        	<item>When mixing scheduled payments which reserve the total amount with authorized payments, amount reservations were not being correctly returned</item>
        	<item>On posweb access, if the user had an expired password, he/she'd not be forced to change</item>
        	<item>On posweb access, if the member had a pending registration agreement, he/she'd not be forced to accept it</item>
        	<item>Limited system accounts with credit limit greater than zero were not honoring the limit</item>
        	<item>The form for new static document and edit member document didn't work on Google Chrome</item>
        	<item>Removing images didn't remove them from disk cache on the server</item>
        	<item>It was not being validated that a payment cannot be performed if there are pending commission contracts</item>
        	<item>On database creation groups with associated accounts were not set active</item>
        	<item>On the edit transfer type page, scheduled payment settings shouldn't be displayed for loans</item>
        	<item>Customized files which are no longer used will be automatically removed from database on next startup</item>
        	<item>On the account fees log file, when a fee is finished, the log was being generated as if it were starting</item>
        </bug-fixes>
        
		<new-libraries>
			<item>FastInfoset-1.2.9.jar</item>
			<item>antlr-2.7.7.jar</item>
			<item>cxf-2.4.4.jar</item>
			<item>ehcache-core-2.4.6.jar</item>
			<item>hazelcast-1.9.4.4.jar</item>
			<item>hibernate-3.6.8.jar</item>
			<item>hibernate-jpa-2.0-api-1.0.1.Final.jar</item>
			<item>lucene-analyzers-3.4.0.jar</item>
			<item>lucene-core-3.4.0.jar</item>
			<item>lucene-misc-3.4.0.jar</item>
			<item>lucene-queries-3.4.0.jar</item>
			<item>mysql-connector-java-5.1.18.jar</item>
			<item>neethi-3.0.0.jar</item>
			<item>neethi-3.0.1.jar</item>
			<item>org.springframework.aop-3.0.6.RELEASE.jar</item>
			<item>org.springframework.asm-3.0.6.RELEASE.jar</item>
			<item>org.springframework.beans-3.0.6.RELEASE.jar</item>
			<item>org.springframework.context-3.0.6.RELEASE.jar</item>
			<item>org.springframework.context.support-3.0.6.RELEASE.jar</item>
			<item>org.springframework.core-3.0.6.RELEASE.jar</item>
			<item>org.springframework.expression-3.0.6.RELEASE.jar</item>
			<item>org.springframework.jdbc-3.0.6.RELEASE.jar</item>
			<item>org.springframework.orm-3.0.6.RELEASE.jar</item>
			<item>org.springframework.transaction-3.0.6.RELEASE.jar</item>
			<item>org.springframework.web-3.0.6.RELEASE.jar</item>
			<item>xmlschema-core-2.0.1.jar</item>
		</new-libraries>

		<removed-libraries>
			<item>FastInfoset-1.2.7.jar</item>
			<item>XmlSchema-1.4.5.jar</item>
			<item>antlr-2.7.6.jar</item>
			<item>cxf-2.3.0.jar</item>
			<item>ehcache-core-2.3.2.jar</item>
			<item>geronimo-annotation_1.0_spec-1.1.1.jar</item>
			<item>geronimo-stax-api_1.0_spec-1.0.1.jar</item>
			<item>geronimo-ws-metadata_2.0_spec-1.1.2.jar</item>
			<item>hibernate-3.6.1.jar</item>
			<item>hibernate-jpa-2.0-api-1.0.0.Final.jar</item>
			<item>hsqldb.jar</item>
			<item>jakarta-oro.jar</item>
			<item>jaxb-api-2.2.1.jar</item>
			<item>jaxb-impl-2.2.1.1.jar</item>
			<item>jaxen-1.1.1.jar</item>
			<item>jaxws-api-2.1-1.jar</item>
			<item>jdom-1.0.jar</item>
			<item>lucene-analyzers-3.0.1.jar</item>
			<item>lucene-core-3.0.1.jar</item>
			<item>lucene-misc-3.0.1.jar</item>
			<item>lucene-queries-3.0.1.jar</item>
			<item>mysql-connector-java-5.1.10-bin.jar</item>
			<item>neethi-2.0.4.jar</item>
			<item>org.springframework.aop-3.0.4.RELEASE.jar</item>
			<item>org.springframework.asm-3.0.4.RELEASE.jar</item>
			<item>org.springframework.beans-3.0.4.RELEASE.jar</item>
			<item>org.springframework.context-3.0.4.RELEASE.jar</item>
			<item>org.springframework.context.support-3.0.4.RELEASE.jar</item>
			<item>org.springframework.core-3.0.4.RELEASE.jar</item>
			<item>org.springframework.expression-3.0.4.RELEASE.jar</item>
			<item>org.springframework.jdbc-3.0.4.RELEASE.jar</item>
			<item>org.springframework.orm-3.0.4.RELEASE.jar</item>
			<item>org.springframework.transaction-3.0.4.RELEASE.jar</item>
			<item>org.springframework.web-3.0.4.RELEASE.jar</item>
			<item>saaj-api-1.3.jar</item>
			<item>saaj-impl-1.3.2.jar</item>
			<item>stax-utils-20060502.jar</item>
			<item>wss4j-1.5.8.jar</item>
			<item>wstx-asl-3.2.9.jar</item>
		</removed-libraries>

		<new-helps>
			<item>preferences.jsp</item>
		</new-helps>

		<removed-helps>
			<item>notifications.jsp</item>
		</removed-helps>

		<new-translation-keys>
			<item>account.iRate</item>
			<item>accountFee.error.multipleVolumeFees</item>
			<item>accountFee.error.mustRechargeOldestLogFirst</item>
			<item>alert.member.ACCOUNT_ACTIVATION_FAILED</item>
			<item>alert.member.INITIAL_CREDIT_FAILED</item>
			<item>alert.member.NULL_IRATE</item>
			<item>alert.member.accountActivationFailed</item>
			<item>alert.member.initialCreditFailed</item>
			<item>alert.member.nullIrate</item>
			<item>alert.system.NULL_IRATE</item>
			<item>alert.system.RATE_INITIALIZATION_FINISHED</item>
			<item>alert.system.RATE_INITIALIZATION_STARTED</item>
			<item>alert.system.nullIrate</item>
			<item>alert.system.rateInitializationFinished</item>
			<item>alert.system.rateInitializationStarted</item>
			<item>brokerCommissionContract.error.contractNotFound</item>
			<item>brokerCommissionContract.title.view</item>
			<item>changePassword.currentPassword</item>
			<item>channel.enableSMS</item>
			<item>channel.enableSMSLinkTo</item>
			<item>channel.internalNameAlreadyInUse</item>
			<item>currency.enableIRate</item>
			<item>currency.pendingRateInitProgression</item>
			<item>currency.rates</item>
			<item>customField.member.error.indexingVisibility</item>
			<item>customField.payment.enabled</item>
			<item>error.aRateParameters.noFutureInitEmission</item>
			<item>error.iRateParameters.notOffLine</item>
			<item>error.rateParameters.creationExpirationSmallerThanEmission</item>
			<item>error.rateParameters.initExpirationBeforeEmission</item>
			<item>error.session.timeout</item>
			<item>errors.javaClass</item>
			<item>errors.pageNotFound</item>
			<item>global.iRate.steps</item>
			<item>group.account.pendingInitialCredits</item>
			<item>group.defaultAcceptFreeMailing</item>
			<item>group.defaultAcceptPaidMailing</item>
			<item>group.defaultAllowChargingSms</item>
			<item>group.invalidNature</item>
			<item>help.title.preferences</item>
			<item>home.status.hasPendingCommissionContracts</item>
			<item>login.error.alreadyConnected</item>
			<item>login.redirectFromMessage</item>
			<item>memberImport.status.INVALID_CUSTOM_FIELD_VALUE_MAX_LENGTH</item>
			<item>memberImport.status.INVALID_CUSTOM_FIELD_VALUE_MIN_LENGTH</item>
			<item>memberImport.status.INVALID_CUSTOM_FIELD_VALUE_UNIQUE</item>
			<item>memberPos.assign.memberWithoutAccount</item>
			<item>menu.member.preferences.receiptPrinterSettings</item>
			<item>menu.operator.preferences.receiptPrinterSettings</item>
			<item>payment.error.manageFrom</item>
			<item>payment.error.manageRelates</item>
			<item>payment.error.ratesRequiresLocksOnAllAccounts</item>
			<item>payment.error.relatesTo</item>
			<item>paymentRequest.error.invalidChannel</item>
			<item>permission.adminMemberPos.changeParameters</item>
			<item>permission.adminMemberPos.changePin</item>
			<item>permission.memberPreferences.manageReceiptPrinterSettings</item>
			<item>permission.memberReceiptPrinterSettings</item>
			<item>permission.memberReceiptPrinterSettings.manage</item>
			<item>permission.operatorPayments.poswebMakePayment</item>
			<item>permission.operatorPayments.poswebReceivePayment</item>
			<item>permission.systemPayments.blockScheduled</item>
			<item>permission.systemPayments.cancelScheduled</item>
			<item>posweb.action.printSettings</item>
			<item>posweb.action.searchTransactions</item>
			<item>posweb.printSettings.title</item>
			<item>posweb.searchTransactions.noTransactions</item>
			<item>posweb.searchTransactions.print</item>
			<item>posweb.searchTransactions.title</item>
			<item>posweb.searchTransactions.title.scheduledPayments</item>
			<item>posweb.searchTransactions.title.transactions</item>
			<item>rates.a</item>
			<item>rates.d</item>
			<item>rates.error.initializationAlreadyRunning</item>
			<item>rates.error.notOnlineWhileRateInitsPending</item>
			<item>rates.error.pendingRateExists</item>
			<item>rates.error.rateNotEnabledForInit</item>
			<item>rates.error.reinitValidation.noEditDuringRateReinit</item>
			<item>rates.error.reinitValidation.noRateSpecified</item>
			<item>rates.error.reinitValidation.reinitDateAfterEnableDate</item>
			<item>rates.i</item>
			<item>rates.message.initializationAlreadyRunning</item>
			<item>rates.reinit.date</item>
			<item>rates.reinit.enabledSince</item>
			<item>rates.reinit.maintainLast</item>
			<item>rates.reinit.reinit</item>
			<item>rates.reinit.type</item>
			<item>rates.reinit.warning</item>
			<item>rates.reinitialize</item>
			<item>receipt.posweb.transactions.date</item>
			<item>receipt.posweb.transactions.header</item>
			<item>receipt.posweb.transactions.member</item>
			<item>receipt.posweb.transactions.noTransfers</item>
			<item>receipt.posweb.transactions.scheduledPayment</item>
			<item>receipt.posweb.transactions.scheduledPayments</item>
			<item>receipt.posweb.transactions.transfer</item>
			<item>receipt.posweb.transactions.transfers</item>
			<item>receipt.transfer.amount</item>
			<item>receipt.transfer.date</item>
			<item>receipt.transfer.from</item>
			<item>receipt.transfer.header</item>
			<item>receipt.transfer.installment</item>
			<item>receipt.transfer.installments</item>
			<item>receipt.transfer.scheduledFor</item>
			<item>receipt.transfer.status</item>
			<item>receipt.transfer.textAfter</item>
			<item>receipt.transfer.textBefore</item>
			<item>receipt.transfer.to</item>
			<item>receipt.transfer.transactionNumber</item>
			<item>receiptPrinter.error.applet</item>
			<item>receiptPrinter.error.ie</item>
			<item>receiptPrinter.error.noConfiguration</item>
			<item>receiptPrinter.error.printerNotFoundError</item>
			<item>receiptPrinterSettings.beginOfDocCommand</item>
			<item>receiptPrinterSettings.created</item>
			<item>receiptPrinterSettings.endOfDocCommand</item>
			<item>receiptPrinterSettings.helpMessage</item>
			<item>receiptPrinterSettings.localPrinter</item>
			<item>receiptPrinterSettings.localPrinter.defaultBrowserPrinting</item>
			<item>receiptPrinterSettings.modified</item>
			<item>receiptPrinterSettings.name</item>
			<item>receiptPrinterSettings.new</item>
			<item>receiptPrinterSettings.paymentAdditionalMessage</item>
			<item>receiptPrinterSettings.printerName</item>
			<item>receiptPrinterSettings.remove.confirm</item>
			<item>receiptPrinterSettings.removed</item>
			<item>receiptPrinterSettings.title.list</item>
			<item>receiptPrinterSettings.title.modify</item>
			<item>receiptPrinterSettings.title.new</item>
			<item>reference.transactionFeedback.feedbackPeriodExpired</item>
			<item>serviceClient.ignoreRegistrationValidations</item>
			<item>settings.access.allowMultipleLogins</item>
			<item>settings.local.extra</item>
			<item>settings.local.transferListenerClass</item>
			<item>settings.log.traceWritesOnly</item>
			<item>settings.log.webServiceFile</item>
			<item>settings.log.webServiceLevel</item>
			<item>settings.log.webServiceLevel.DETAILED</item>
			<item>settings.log.webServiceLevel.ERRORS</item>
			<item>settings.log.webServiceLevel.OFF</item>
			<item>settings.log.webServiceLevel.SIMPLE</item>
			<item>sms.type.ACCOUNT_DETAILS.description</item>
			<item>sms.type.ACCOUNT_DETAILS_ERROR.description</item>
			<item>sms.type.GENERAL.description</item>
			<item>sms.type.HELP.description</item>
			<item>sms.type.HELP_ERROR.description</item>
			<item>sms.type.INFO_TEXT.description</item>
			<item>sms.type.INFO_TEXT_ERROR.description</item>
			<item>sms.type.OPERATION_CONFIRMATION.description</item>
			<item>sms.type.PAYMENT.description</item>
			<item>sms.type.PAYMENT_ERROR.description</item>
			<item>sms.type.REQUEST_PAYMENT.description</item>
			<item>sms.type.REQUEST_PAYMENT_ERROR.description</item>
			<item>transactionFee.subject.DESTINATION_BROKER</item>
			<item>transactionFee.subject.SOURCE_BROKER</item>
			<item>transfer.guarantee</item>
			<item>transfer.guarantee.details</item>
			<item>transfer.hour</item>
			<item>transferType.transferListenerClass</item>
		</new-translation-keys>

		<removed-translation-keys>
			<item>accountFee.tolerance</item>
			<item>adInterest.error.missingData</item>
			<item>alert.member.NULL_RATE</item>
			<item>alert.member.nullRate</item>
			<item>alert.system.NULL_RATE</item>
			<item>alert.system.nullRate</item>
			<item>customField.error.invalidValidatorClass</item>
			<item>help.title.notifications</item>
			<item>loan.title.canPerformExpiredAction</item>
			<item>paymentRequest.error.member</item>
			<item>permission.adminMemberInvoices.directSend</item>
			<item>permission.adminMemberPayments.directPayment</item>
			<item>permission.adminMemberPos.changeParameters </item>
			<item>permission.adminMemberPos.changePin </item>
			<item>permission.basic.quickAccess</item>
			<item>permission.memberCommissions</item>
			<item>permission.memberCommissions.view</item>
			<item>permission.memberInvoices.directSendToMember</item>
			<item>permission.memberPayments.directPaymentToMember</item>
			<item>permission.operatorInvoices.directSendToMember</item>
			<item>permission.operatorPayments.directPaymentToMember</item>
			<item>permission.operatorPayments.externalMakePayment</item>
			<item>permission.operatorPayments.externalReceivePayment</item>
		</removed-translation-keys>
        
        <statements database="mysql">
        	<item>create table wrong_credential_attempts (id integer not null auto_increment, date datetime not null, credential_type varchar(1), user_id integer, card_id integer, member_pos_id integer, primary key (id)) ENGINE=InnoDB</item>
        	<item>alter table wrong_credential_attempts add index FK80BA49CA19267FC (user_id), add constraint FK80BA49CA19267FC foreign key (user_id) references users (id)</item>
			<item>alter table wrong_credential_attempts add index FK80BA49C293F7A45 (card_id), add constraint FK80BA49C293F7A45 foreign key (card_id) references cards (id)</item>
			<item>alter table wrong_credential_attempts add index FK80BA49C13A66F8B (member_pos_id), add constraint FK80BA49C13A66F8B foreign key (member_pos_id) references member_pos (id)</item>
			<item>alter table users add column password_blocked_until datetime, add column pin_blocked_until datetime</item>
			<item>alter table cards add column card_security_code_blocked_until datetime</item>
			<item>alter table member_pos add column pin_blocked_until datetime</item>
			<item>create table permission_denieds (id integer not null auto_increment, date datetime not null, user_id integer not null, primary key (id)) ENGINE=InnoDB</item>
			<item>alter table permission_denieds add index FK61FE25C8A19267FC (user_id), add constraint FK61FE25C8A19267FC foreign key (user_id) references users (id)</item>
			<item>create table sessions (id integer not null auto_increment, identifier varchar(255) not null unique, creation_date datetime not null, expiration_date datetime not null, remote_addr varchar(64) not null, user_id integer not null, primary key (id)) ENGINE=InnoDB</item>
			<item>alter table sessions add index FK53BFD09DA19267FC (user_id), add constraint FK53BFD09DA19267FC foreign key (user_id) references users (id)</item>
			<item>create table wrong_username_attempts (id integer not null auto_increment, date datetime not null, remote_address varchar(64) not null, primary key (id)) ENGINE=InnoDB</item>
			<item>create index ix_wua_remote_address on wrong_username_attempts (remote_address)</item>
			<item>update transfers set process_date = null where status &lt;&gt; 'O'</item>
			<item>create table closed_account_balances (id bigint not null auto_increment, account_id integer not null, date date not null, balance decimal(21,6) default 0 not null, reserved decimal(21,6) default 0 not null, primary key (id)) ENGINE=InnoDB</item>
			<item>create index ix_cldacctbal_account_date on closed_account_balances (account_id, date)</item>
			<item>alter table closed_account_balances add index FK8FF83D5C3317FFBA (account_id), add constraint FK8FF83D5C3317FFBA foreign key (account_id) references accounts (id)</item>
			<item>drop table account_fee_charges</item>
			<item>update account_status set account_fee_log_id = null</item>
			<item>delete from account_fee_logs where status = 'S'</item>
			<item>update application set account_status_enabled_since = current_date()</item>
			<item>create table account_fee_amounts (id integer not null auto_increment, account_id integer not null, date date not null, available_balance decimal(18,6) not null, amount decimal(15,6) not null, account_fee_id integer not null, primary key (id), unique (account_id, date)) ENGINE=InnoDB</item>
			<item>alter table account_fee_amounts add index FK8A011450DA75B281 (account_fee_id), add constraint FK8A011450DA75B281 foreign key (account_fee_id) references account_fees (id)</item>
			<item>alter table account_fee_amounts add index FK8A0114508AD473C0 (account_id), add constraint FK8A0114508AD473C0 foreign key (account_id) references accounts (id)</item>
			<item>create table amount_reservations (id bigint not null auto_increment, subclass varchar(1) not null, account_id integer not null, date datetime not null, amount decimal(15,6), transfer_id bigint, transfer_authorization_id bigint, scheduled_payment_id integer, primary key (id)) ENGINE=InnoDB</item>
			<item>create index ix_amtres_account_date on amount_reservations (account_id, date)</item>
			<item>alter table amount_reservations add index FKE0379EAEB3A79238 (scheduled_payment_id), add constraint FKE0379EAEB3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
			<item>alter table amount_reservations add index FKE0379EAE2F78F3B3 (transfer_id), add constraint FKE0379EAE2F78F3B3 foreign key (transfer_id) references transfers (id)</item>
			<item>alter table amount_reservations add index FKE0379EAE108D798A (transfer_authorization_id), add constraint FKE0379EAE108D798A foreign key (transfer_authorization_id) references transfer_authorizations (id)</item>
			<item>alter table amount_reservations add index FKE0379EAE3317FFBA (account_id), add constraint FKE0379EAE3317FFBA foreign key (account_id) references accounts (id)</item>
			<item>create table account_limit_logs (id bigint not null auto_increment, account_id integer not null, date datetime not null, by_id integer, credit_limit decimal(15,6), upper_credit_limit decimal(15,6), primary key (id)) ENGINE=InnoDB</item>
			<item>create index ix_acctlimlog_account_date on account_limit_logs (account_id, date)</item>
			<item>alter table account_limit_logs add index FKEA45ED05123F9A53 (by_id), add constraint FKEA45ED05123F9A53 foreign key (by_id) references members (id)</item>
			<item>alter table account_limit_logs add index FKEA45ED053317FFBA (account_id), add constraint FKEA45ED053317FFBA foreign key (account_id) references accounts (id)</item>
			<item>alter table account_fees drop column tolerance_number, drop column tolerance_field</item>
			<item>alter table account_fee_logs drop column tolerance_number, drop column tolerance_field</item>
			<item>alter table accounts add column last_closing_date date</item>
			<item>alter table application add column online bit default true not null</item>
			<item>update settings set value = '10' where name in ('adminTimeout.number', 'memberTimeout.number', 'poswebTimeout.number') and value = '0'</item>
			<item>alter table sessions add column pos_web bit(1) not null default false</item>
			<item>create table account_rates (id integer not null auto_increment, emission_date datetime, expiration_date datetime, rate_balance_correction decimal(21,6), date datetime not null, account_id integer not null, primary key (id)) ENGINE=InnoDB</item>
			<item>alter table account_rates add index FK86A0F46B3317FFBA (account_id), add constraint FK86A0F46B3317FFBA foreign key (account_id) references accounts (id)</item>
			<item>alter table transfers drop column d_rate</item>
			<item>alter table transfers add column expiration_date datetime</item>
            <item>create table trace_numbers (id bigint not null auto_increment, date datetime not null, trace_number varchar(100), client_id bigint, primary key (id)) ENGINE=InnoDB</item>
			<item>alter table trace_numbers add constraint unique trace_number (trace_number, client_id)</item>
			<item>insert into trace_numbers(date, trace_number, client_id) select date, trace_number, client_id from reverses </item>
			<item>drop table reverses</item>
			<item>create table index_operations (id integer not null auto_increment, date datetime not null, entity_type varchar(3) not null, operation_type varchar(3) not null, entity_id bigint, primary key (id)) ENGINE=InnoDB</item>
			<item>create index ix_indexops_date on index_operations (date)</item>
			<item>alter table members drop column is_indexed</item>
			<item>alter table ads drop column is_indexed</item>
			<item>alter table member_records drop column is_indexed</item>
			<item>delete from translation_messages where msg_key like 'alert.system.index%'</item>
			<item>create table member_sms_status_locks (id integer not null, primary key (id)) ENGINE=InnoDB</item>
			<item>alter table account_rates add column transfer_id bigint not null</item>
			<item>alter table account_rates add index FKE08D27012F78F3B3 (transfer_id), add constraint FKE08D27012F78F3B3 foreign key (transfer_id) references transfers (id)</item>
			<item>alter table account_rates drop column date</item>
			<item>drop table if exists rate_updates</item>
			<item>alter table rate_parameters add column disabled_since datetime</item>
			<item>alter table ad_categories drop column count_offer, drop column count_search</item>
            <item>alter table currencies add column i_rate_params_id integer</item>
			<item>alter table account_rates add column raw_i datetime after expiration_date</item>
            <item>alter table rate_parameters change init_value init_value decimal(15,6), change init_date init_date datetime</item>
            <item>alter table account_rates drop column raw_i</item>
            <item>alter table account_rates add column i_rate decimal(15,6) after expiration_date</item>
            <item>alter table transfers add column i_rate decimal(15,6) after expiration_date</item>
            <item>alter table tickets add column trace_data varchar(50)</item>
            <item>alter table transfers add column trace_data varchar(50)</item>
            <item>create table print_settings (id integer not null auto_increment, member integer, name varchar(100) not null, printer_name varchar(100) not null, begin_doc_cmd varchar(100), end_doc_cmd varchar(100), payment_message varchar(500), primary key (id)) ENGINE=InnoDB</item>
            <item>alter table print_settings add index FK35B1ED755AA28D11 (member), add constraint FK35B1ED755AA28D11 foreign key (member) references members (id)</item>
            <item>alter table scheduled_payments add column show_to_receiver bit(1) not null default false</item>
            <item>update scheduled_payments sp inner join transfer_types tt on sp.type_id = tt.id set show_to_receiver = true where tt.show_sched_to_dest = true or exists (select 1 from invoices i where i.scheduled_payment_id = sp.id)</item>
            <item>update invoices i inner join transfers t on i.transfer_id = t.id set t.receiver_id = i.sent_by_id</item>
            <item>create table pending_initial_credits (id bigint not null auto_increment, account_id integer not null, transfer_type_id integer not null, amount decimal(15,6) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table pending_initial_credits add index FK9958FFF7A4766B0A (transfer_type_id), add constraint FK9958FFF7A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table pending_initial_credits add index FK9958FFF73317FFBA (account_id), add constraint FK9958FFF73317FFBA foreign key (account_id) references accounts (id)</item>
            <item>alter table rate_parameters add column reinit_date datetime</item>
            <item>alter table tickets add column transfer_id bigint</item>
            <item>alter table tickets add index FKB124F6E72F78F3B3 (transfer_id), add constraint FKB124F6E72F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>create table admin_preferences_member_alerts (preference_id integer not null, type varchar(70) not null, primary key (preference_id, type)) ENGINE=InnoDB</item>
            <item>create table admin_preferences_system_alerts (preference_id integer not null, type varchar(70) not null, primary key (preference_id, type)) ENGINE=InnoDB</item>
            <item>alter table admin_preferences_member_alerts add index FK70B839E5FB43CB21 (preference_id), add constraint FK70B839E5FB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <item>alter table admin_preferences_system_alerts add index FK44CB90B0FB43CB21 (preference_id), add constraint FK44CB90B0FB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <item>insert into admin_preferences_member_alerts (preference_id, type) select preference_id, type from admin_alert_notification_preferences where subclass='M' and preference_id is not null</item>
            <item>insert into admin_preferences_system_alerts (preference_id, type) select preference_id, type from admin_alert_notification_preferences where subclass='S' and preference_id is not null</item>
            <item>drop table admin_alert_notification_preferences</item>
            <item>alter table groups add column member_default_allow_charging_sms bit default false not null, add column member_default_accept_free_mailing bit default false not null, add column member_default_accept_paid_mailing bit default false not null</item>
            <item>update accounts set credit_limit = abs(credit_limit)</item>
            <item>update account_limit_logs set credit_limit = abs(credit_limit)</item>
            <item>alter table cards modify column expiration_date date</item>
            <item>update groups set member_active=1 where id in (select group_id from member_group_account_settings)</item>            
            <item>create table sms_types (id integer not null auto_increment, code varchar(100) not null unique, order_index integer, primary key (id)) ENGINE=InnoDB</item>
            <item>insert into sms_types(code, order_index) values
					('REQUEST_PAYMENT', 0),
					('REQUEST_PAYMENT_ERROR', 1),
					('PAYMENT', 2),
					('PAYMENT_ERROR', 3),
					('ACCOUNT_DETAILS', 4),
					('ACCOUNT_DETAILS_ERROR', 5),
					('HELP', 6),
					('HELP_ERROR', 7),
					('INFO_TEXT', 8),
					('INFO_TEXT_ERROR', 9),
					('OPERATION_CONFIRMATION', 10),
					('GENERAL', 11)
            </item>
            <item>alter table sms_logs 
            		add column sms_type_id integer, 
            		add column arg0 varchar(150), 
            		add column arg1 varchar(150), 
            		add column arg2 varchar(150), 
            		add column arg3 varchar(150), 
            		add column arg4 varchar(150)
            </item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='REQUEST_PAYMENT') where sms_type = 'RP'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='REQUEST_PAYMENT_ERROR') where sms_type = 'RPE'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='PAYMENT') where sms_type = 'P'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='PAYMENT_ERROR') where sms_type = 'PE'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='ACCOUNT_DETAILS') where sms_type = 'AD'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='ACCOUNT_DETAILS_ERROR') where sms_type = 'ADE'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='HELP') where sms_type = 'H'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='HELP_ERROR') where sms_type = 'HE'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='INFO_TEXT') where sms_type = 'IT'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='INFO_TEXT_ERROR') where sms_type = 'ITE'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='OPERATION_CONFIRMATION') where sms_type = 'CC'</item>
            <item>update sms_logs set sms_type_id=(select id from sms_types where code='GENERAL') where sms_type = 'G'</item>
            <item>alter table sms_logs add index FKF9D930D5D76E1B90 (sms_type_id), add constraint FKF9D930D5D76E1B90 foreign key (sms_type_id) references sms_types (id)</item>
            <item>alter table sms_logs drop column sms_type</item>
            <item>alter table transfer_types add column transfer_listener_class varchar(200)</item>
            <item>alter table custom_fields add column payment_enabled bit(1) not null default true</item>
            <item>alter table accounts add column member_action varchar(1)</item>
            <item>update transfers t inner join members m on t.receiver_id = m.id set t.receiver_id = null where m.subclass &lt;&gt; 'O'</item>
            <item>alter table transfers add column feedback_deadline datetime</item>
            <item>update transfers t inner join transfer_types tt on t.type_id = tt.id 
            		set t.feedback_deadline = date_add(t.date, 
            			INTERVAL tt.feedback_expiration_time_number * case tt.feedback_expiration_time_field when 3 /* WEEKS */ then 7 when 2 /* MONTHS */ then 30 else 1 end DAY) 
            		where tt.requires_feedback = true 
            		and t.date >= tt.feedback_enabled_since</item>
            <item>alter table scheduled_payments add column feedback_deadline datetime</item>
            <item>update scheduled_payments sp inner join transfer_types tt on sp.type_id = tt.id 
            		set sp.feedback_deadline = date_add(sp.date, 
            			INTERVAL tt.feedback_expiration_time_number * case tt.feedback_expiration_time_field when 3 /* WEEKS */ then 7 when 2 /* MONTHS */ then 30 else 1 end DAY) 
            		where tt.requires_feedback = true 
            		and sp.date >= tt.feedback_enabled_since</item>
        </statements>
        
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.ChangePermissionSchemeMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.ClosedAccountBalancesMigration" />
    </version>
    
    <version label="3.6_RC1a">
    	<enhancements>
        	<item>Added to the web service client the possibility to ignore e-mail and custom field validations for member registrations</item>
    	</enhancements>
    	
        <bug-fixes>
        	<item>On broker group permissions, transfer types for chargebacks and channels for request payment were not being saved</item>
        	<item>It was not possible to remove a member's broker. It is now possible on the change broker to leave the new broker empty</item>
        	<item>Broker commissions for newly created brokers were not being paid, until the first customization of default commission status</item>
        	<item>Fees with a very small percentage on small payments which generated amounts smaller than than 0.01 (depending on the precision) could generate payments of amount zero, which caused errors</item>
        	<item>A member was able to pay via Web services to another member he couldn't see the profile</item>
        	<item>Theme was not persisted when applied and an image referenced by it didn't previously exist</item>
		</bug-fixes>
		
		<statements database="mysql">
			<item>alter table service_clients add column ignore_registration_validations bit(1) default false not null</item>
		</statements>
	</version> 


    <version label="3.6_RC1">
        <enhancements>
        	<item>Several database queries have been optimized, which yields noticeable performance improvements in large databases</item>
        	<item>Now, for new databases, a per-user hash is used, which is more secure</item>
        	<item>Now making payments no longer forces the user to keep waiting until it is processed</item>
        	<item>All themes have been improved</item>
        	<item>A broker can now register another broker</item>
        	<item>Various performance improvements have been implemented</item>
        	<item>Implemented various security fixes</item>
            <item>Now channels can have multiple ways to identify members, which, for example, allows members to login by custom fields or e-mail</item>
            <item>New web service operations, which allows managing members</item>
            <item>Format of integer values were added to the Current State Overview report</item>
            <item>A new chargeback status was added to the chargeback/reverse WebServices operations: TRANSFER_NOT_FOUND</item>
            <item>The account history print report has been modified to show the member name or username depending on the settings</item>
            <item>The account history and reports (CSV generation and printing) can be limited to a maximum number of results according to a setting</item>
            <item>The description field has been added to imported transactions</item>
            <item>A web service client which is not restricted to member could be set to always check credentials</item>
            <item>A system payment can be approved by the receiver (only first level)</item>
            <item>Authorizing a guarantee will also authorize the corresponding loan if the same user is the authorizer for both and he checked to do it.</item>
            <item>Several enhancements to web service methods and SMS integration</item>
            <item>Now the sms channel used to operate by sms can be set in the local setting page (sms section)</item>
            <item>Now a different translation message is used for pos web payments on not enough credits error</item>
            <item>If there are circular fees, which would lead to an eternal loop, an specific error is displayed</item>
            <item>Now the account fee charging happens in smaller database transactions, which speeds up charging on large databases</item>
            <item>Added permissions to change a member name and username</item>
            <item>New properties regarding to external web services SSL connection and timeouts were added</item>
            <item>The payment request search page was improved showing useful data (ticket creation date, request/confirmation channel)</item>
            <item>Now Broker/Admin can select a member as the target of a SMS mailing</item>
            <item>Added an option in cyclos.properties to skip members and advertisements ordering, not to impact performance too much on large databases</item>
            <item>Now the history for system accounts is initially filtered for payments starting at the first day of the previous month, so that on large databases, the impact will be low for system accounts, which tend to have many payments</item>
            <item>Allows searching advertisements via web services by status</item>
            <item>Allows searching members via web services by e-mail</item>
            <item>Added the info texts, which are messages which can be retrieved through web services</item>
            <item>Now, if there are missing translation keys, the English translations will be used</item>
            <item>Now, for a group password policy, it is possible to require letters, digits and special characters in passwords</item>
            <item>Messages sent from admins to groups or from brokers to their members are now sent in the background, and the copy on the sent items will show how many internal messages / mails were sent</item>
            <item>Simplified the settings for message format: Now there's only one option for message format, the the options (for both ad descriptions and messages) can be either plain text or rich text (no user choice anymore)</item>
            <item>Added an option on transfer types to allow SMS notifications</item>
            <item>Improved the SMS log search and report</item>
        </enhancements>
        
        <bug-fixes>
        	<item>Some request parameters were not being sanitized, allowing XSS</item>
        	<item>Some urls were not protected from unauthorized access</item>
        	<item>Once the transaction password has been disabled in group edition, it can't be enabled again.</item>
            <item>Page breaks were added to the printed manual</item>
            <item>A negative value could be entered in the deactivation time for exceeded the max. PIN tries field</item>
            <item>In Internet Explorer, text areas and rich texts on custom fields were too wide</item>
            <item>Loan details are showing the currency simbol</item>
            <item>Now you can remove a currency that has an aRate or dRate</item>
            <item>Ad webservice is formatting the price</item>
            <item>Category counter now count the categories correctly</item>
            <item>Bookeeping, now you see the right field classification when editing a mapped field.</item>
            <item>Bookeeping fields order are correct after removing a mapping</item>
            <item>It wasn't possible to remove a member from the broker's member list</item>
            <item>Operator weren't able to send an invoice</item>
            <item>Notifications sent by e-mail to administrators were not sent on background, causing the process to hang until the e-mail was sent</item>
            <item>If the PIN (Card Security Code) was blocked and the blocked time (after max wrong tries) was expired then the PIN (Card Security Code) never could be unblocked</item>
            <item>The member transaction summary report was not returning all data when the member result display (in local settings) was set to username</item>
            <item>On web services, loading an advertisement was not returning the custom fields</item>
            <item>Searching members / ads using keywords (full text search) and filtering with enumerated custom fields always had no results</item>
            <item>The search invoices was not using the setting to display members as name / username - username was always being used</item>
            <item>The confirm webshop payment page was displaying a selection field for principal type when only a single option was allowed</item>
            <item>Searching member record types using keywords by admins was never returning results</item>
            <item>Scheduled payments which reserved the total amount were not validating the account balance</item>
            <item>Canceling scheduled payment installments with a reserved amount didn't return the reserved amount to the account</item>
            <item>The external login was only usable if the script tag including the cyclos_root/externalLogin.js was the first script tag on the document</item>
            <item>The member transaction details was printing the inverse signal on transactions</item>
            <item>When using zero as max print results, print pages were returning no results, instead of unlimited (which is the semantic of max = zero)</item>
            <item>Custom fields which used text areas were not allowing input if the max length was not defined</item>
            <item>The account status for scheduled payments was being correctly updated</item>
            <item>Some payment notifications were not correct</item>
            <item>Members were not being able to see the 'brokering events' notification type in the notification preferences page. This type is only shown to member with a broker</item>
            <item>If a payment is set to be authorized by a broker, and the member receiving the payment chose not to be notified, the broker also wouldn't be notified about the authorization</item>
            <item>When an invoice expired, the member which sent it was being notified twice, and the receiver was not being notified</item>
            <item>Manually processing an scheduled payment was not generating notifications</item>
            <item>The low units notification was never being sent</item>
            <item>In Firefox, if Cyclos was running in an iframe, every click on links would make a jumpy box appear for a few instants</item>
            <item>Alerts were not being notified by e-mail to admins</item>
            <item>A payment which is charged back on the same day should subtract the amount from the max amount per day</item>
            <item>If the admin removes the permission for a group for a given transfer type, and a member had an scheduled payment of that type, he could still manually process an installment</item>
            <item>When using a timezone, the scheduling hour was being considered as the local server's time, not as the Cyclos instance time</item>
            <item>The semantics when setting an advertisement category to active / inactive were sometimes not correct</item>
            <item>The transaction number was not being assigned for scheduled payments</item>
            <item>If the public registration was in a group which has a customized login page, after confirming the registration, that customized login page was not being displayed</item>
            <item>Invoices search was missing the result pagination</item>
            <item>In the notification translation, changed the SMS one-line text field to a multi-line field</item>
            <item>Admin records were not showing up</item>
            <item>Right after inserting a new document, if the admin tried to view that document on a member's profile, there would be a permission denied error</item>
            <item>The load by username on login was being performed 3 times</item>
            <item>Make sure that all updates occur only on actually modified columns (avoids missing data concurrent updates for different columns)</item>
            <item>Payments as member by admins for authorized payments, when the same admin performing the payment is also the authorizer could lead to incorrect account balance</item>
            <item>Error when a member was changing his operator's password</item>
            <item>Print account history was not showing charged back payments as strike-through</item>
            <item>When multiple rich text editors were displayed on the same page, in Firefox 4, only the last one was editable</item>
            <item>On the member transaction summary report, on transaction details, chargebacks were sometimes being displayed with the wrong sign</item>
            <item>On member import, when importing a non-existing value for enumerated custom field, the error message was incomplete</item>
            <item>When saving / activating / deactivating an advertisement category, the counters would sometimes be incorrect</item>
            <item>There was an error when an operators would attempt to accept an invoice</item>
            <item>Linked (parent-child) custom fields for payments was not working</item>
            <item>Previously, on the member transactions report summary, payment filters only with system to member payments would never show a debits column. The same for member to system and credits. This prevented chargebacks from showing up. So, now all columns are shown (depending solely on the checkboxes for debits / credits)</item>
            <item>After including a login form from another website, if the user performed a 'regular' login in cyclos, after logging out, the user would still be redirected to the url passed by the external login form</item>
            <item>The account history for removed member was not visible</item>
            <item>It was possible to chargeback a transfer from / to a removed member</item>
            <item>When moving an user to a removed group, if the user was logged in, his session would still be valid (until logging out / timeout). Now the user is immediately disconnected.</item>
            <item>On Internet Explorer, the layout for search POS devices and SMS logs reports was broken</item>
            <item>The 'performed by' (admin / broker / operator) field was not being copied from transfers to the generated fees</item>
            <item>Printing the manual would lead to wrong formatting</item>
            <item>On the ads search, after searching with groups or group filters on the search, it was not possible to uncheck them (unless clicking the menu item again)</item>
        </bug-fixes>
        
		<new-libraries>
			<item>cglib-nodep-2.2.jar</item>
			<item>commons-chain-1.2.jar</item>
			<item>commons-digester-1.8.jar</item>
			<item>commons-lang-2.5.jar</item>
			<item>cxf-2.3.0.jar</item>
			<item>ehcache-core-2.3.2.jar</item>
			<item>hibernate-3.6.1.jar</item>
			<item>hibernate-jpa-2.0-api-1.0.0.Final.jar</item>
			<item>jaxb-api-2.2.1.jar</item>
			<item>jaxb-impl-2.2.1.1.jar</item>
			<item>jaxen-1.1.1.jar</item>
			<item>jstl-1.1.jar</item>
			<item>jtidy-r938.jar</item>
			<item>org.springframework.aop-3.0.4.RELEASE.jar</item>
			<item>org.springframework.asm-3.0.4.RELEASE.jar</item>
			<item>org.springframework.beans-3.0.4.RELEASE.jar</item>
			<item>org.springframework.context-3.0.4.RELEASE.jar</item>
			<item>org.springframework.context.support-3.0.4.RELEASE.jar</item>
			<item>org.springframework.core-3.0.4.RELEASE.jar</item>
			<item>org.springframework.expression-3.0.4.RELEASE.jar</item>
			<item>org.springframework.jdbc-3.0.4.RELEASE.jar</item>
			<item>org.springframework.orm-3.0.4.RELEASE.jar</item>
			<item>org.springframework.transaction-3.0.4.RELEASE.jar</item>
			<item>org.springframework.web-3.0.4.RELEASE.jar</item>
			<item>standard-1.1.2.jar</item>
			<item>struts-core-1.3.10.jar</item>
			<item>struts-extras-1.3.10.jar</item>
			<item>struts-taglib-1.3.10.jar</item>
			<item>struts-tiles-1.3.10.jar</item>
		</new-libraries>

		<removed-libraries>
			<item>cglib-nodep-2.1_3.jar</item>
			<item>commons-digester-1.7.jar</item>
			<item>commons-lang-2.1.jar</item>
			<item>cxf-2.2.6.jar</item>
			<item>hibernate-3.3.2.jar</item>
			<item>hibernate-commons-annotations.jar</item>
			<item>jaxb-api-2.1.jar</item>
			<item>jaxb-impl-2.1.12.jar</item>
			<item>jaxen-1.1.jar</item>
			<item>jstl.jar</item>
			<item>oscache-2.4.jar</item>
			<item>spring-2.0.8.jar</item>
			<item>standard.jar</item>
			<item>struts-1.2.9.jar</item>
		</removed-libraries>

		<new-translation-keys>
			<item>accountFeeLog.status.PARTIALLY_FAILED</item>
			<item>adCategory.error.cantActivateCategoryWithInactiveParent</item>
			<item>alert.member.LOGIN_BLOCKED_BY_PERMISSION_DENIEDS</item>
			<item>alert.member.NULL_RATE</item>
			<item>alert.member.loginBlockedByPermissionDenieds</item>
			<item>alert.system.ADMIN_LOGIN_BLOCKED_BY_PERMISSION_DENIEDS</item>
			<item>alert.system.NULL_RATE</item>
			<item>alert.system.adminLoginBlockedByPermissionDenieds</item>
			<item>alert.system.adminTransactionPasswordBlockedByTries</item>
			<item>card.changeSecurityCode.error.obvious</item>alert
			<item>card.securityCode</item>
			<item>cardType.showCardSecurityCode</item>
			<item>changeGroup.error.move.hasBalance</item>
			<item>changeGroup.error.move.hasOpenInvoices</item>
			<item>changeGroup.error.move.hasOpenLoans</item>
			<item>changeGroup.error.move.hasPendingScheduledPayments</item>
			<item>changeGroup.error.remove.hasOpenLoans</item>
			<item>changeGroup.error.remove.hasPendingScheduledPayments</item>
			<item>changePassword.error.mustContainOnlyLettersOrNumbers</item>
			<item>changePassword.error.mustIncludeLettersNumbersSpecial</item>
			<item>changePassword.error.obvious</item>
			<item>changePassword.error.userBlocked</item>
			<item>changePassword.forceChange</item>
			<item>changePassword.newPassword</item>
			<item>changePassword.newPasswordConfirmation</item>
			<item>changePassword.oldPassword</item>
			<item>changePin.error.obvious</item>
			<item>changePin.newPin</item>
			<item>changePin.newPinConfirmation</item>
			<item>channel.defaultPrincipal</item>
			<item>channel.principals</item>
			<item>conversionSimulation.result.total</item>
			<item>customImage.system.active</item>
			<item>customImage.system.calendar</item>
			<item>customImage.system.captchaBackground</item>
			<item>customImage.system.checked</item>
			<item>customImage.system.conciliated</item>
			<item>customImage.system.delete</item>
			<item>customImage.system.dropdown</item>
			<item>customImage.system.edit</item>
			<item>customImage.system.edit_gray</item>
			<item>customImage.system.help</item>
			<item>customImage.system.icon</item>
			<item>customImage.system.import</item>
			<item>customImage.system.inactive</item>
			<item>customImage.system.incomplete</item>
			<item>customImage.system.message_read</item>
			<item>customImage.system.message_removed</item>
			<item>customImage.system.message_replied</item>
			<item>customImage.system.message_unread</item>
			<item>customImage.system.mobileLogo</item>
			<item>customImage.system.next</item>
			<item>customImage.system.noPicture</item>
			<item>customImage.system.pay</item>
			<item>customImage.system.pending</item>
			<item>customImage.system.permissions</item>
			<item>customImage.system.permissions_gray</item>
			<item>customImage.system.preview</item>
			<item>customImage.system.previous</item>
			<item>customImage.system.print</item>
			<item>customImage.system.quickAccess_accountInfo</item>
			<item>customImage.system.quickAccess_contacts</item>
			<item>customImage.system.quickAccess_makePayment</item>
			<item>customImage.system.quickAccess_messages</item>
			<item>customImage.system.quickAccess_placeAd</item>
			<item>customImage.system.quickAccess_searchAds</item>
			<item>customImage.system.quickAccess_updateProfile</item>
			<item>customImage.system.save</item>
			<item>customImage.system.systemLogo</item>
			<item>customImage.system.view</item>
			<item>error.image.dimension</item>
			<item>error.systemOverloaded</item>
			<item>externalAccountHistory.transferImport.title</item>
			<item>externalTransfer.description</item>
			<item>fieldMapping.field.DESCRIPTION</item>
			<item>global.no.defined</item>
			<item>global.textFormat.PLAIN</item>
			<item>global.textFormat.RICH</item>
			<item>global.timePeriod.invalid</item>
			<item>global.total</item>
			<item>group.error.passwordPolicyNumeric</item>
			<item>group.error.passwordPolicySpecialVirtualKeyboard</item>
			<item>group.settings.emailValidation.EXTERNAL</item>
			<item>group.settings.passwordPolicy.AVOID_OBVIOUS_LETTERS_NUMBERS_SPECIAL</item>
			<item>group.settings.pinBlockTimeAfterMaxTries.number</item>
			<item>group.settings.smsAdditionalCharged</item>
			<item>group.settings.smsAdditionalChargedPeriod</item>
			<item>group.settings.smsContextClassName</item>
			<item>group.settings.smsCustomContext</item>
			<item>group.settings.smsCustomContextInvalid</item>
			<item>group.settings.smsFree</item>
			<item>group.settings.smsShowFreeThreshold</item>
			<item>guarantee.automaticLoanAuthorization</item>
			<item>guarantee.error.invalidGuarantee</item>
			<item>infoText.empty.subject</item>
			<item>infoText.enabled</item>
			<item>infoText.end</item>
			<item>infoText.errorRemoving</item>
			<item>infoText.new</item>
			<item>infoText.noMatch</item>
			<item>infoText.nomatch.subject</item>
			<item>infoText.removeConfirmation</item>
			<item>infoText.removed</item>
			<item>infoText.start</item>
			<item>infoText.title.edit</item>
			<item>infoText.title.new</item>
			<item>infoText.title.search</item>
			<item>infoText.validity</item>
			<item>infotext.active</item>
			<item>infotext.aliases</item>
			<item>infotext.body</item>
			<item>infotext.subject</item>
			<item>invoice.destinationAccountType</item>
			<item>login.accessOptions</item>
			<item>login.accessUsing</item>
			<item>login.memberUsername</item>
			<item>menu.admin.messages.infoTexts</item>
			<item>menu.admin.messages.smsMailings</item>
			<item>menu.member.broker.smsMailings</item>
			<item>message.emailsSent</item>
			<item>message.messagesSent</item>
			<item>message.stillSending</item>
			<item>mobile.login.accessUsing</item>
			<item>notificationPreferences.acceptFreeMailing</item>
			<item>notificationPreferences.acceptPaidMailing</item>
			<item>notificationPreferences.allowChargingSms</item>
			<item>notificationPreferences.allowChargingSmsPackage</item>
			<item>notificationPreferences.costPerAdditionalMessages</item>
			<item>notificationPreferences.costPerMessage</item>
			<item>notificationPreferences.disableSms</item>
			<item>notificationPreferences.disableSms.confirmation</item>
			<item>notificationPreferences.enableSmsOperations</item>
			<item>notificationPreferences.freeSmsUsed</item>
			<item>notificationPreferences.my.title.name</item>
			<item>notificationPreferences.noPaidSmsLeft</item>
			<item>notificationPreferences.paidSmsLeft</item>
			<item>notificationPreferences.selectAll</item>
			<item>notificationPreferences.selectNone</item>
			<item>notificationPreferences.smsHeading</item>
			<item>payment.error.circularFees</item>
			<item>payment.error.enoughCreditsOtherAccount</item>
			<item>payment.error.negativeFinalAmount</item>
			<item>paymentRequest.error.member</item>
			<item>paymentRequest.error.noChannels</item>
			<item>paymentRequest.error.sending</item>
			<item>permission.adminMemberPos.unblockPin</item>
			<item>permission.adminMemberPreferences</item>
			<item>permission.adminMemberPreferences.manageNotifications</item>
			<item>permission.adminMemberSmsMailings</item>
			<item>permission.adminMemberSmsMailings.freeSmsMailings</item>
			<item>permission.adminMemberSmsMailings.paidSmsMailings</item>
			<item>permission.adminMemberSmsMailings.view</item>
			<item>permission.adminMembers.changeName</item>
			<item>permission.adminMembers.changeUsername</item>
			<item>permission.brokerMembers.changeName</item>
			<item>permission.brokerMembers.changeUsername</item>
			<item>permission.brokerPos.unblockPin</item>
			<item>permission.brokerPreferences</item>
			<item>permission.brokerPreferences.manageNotifications</item>
			<item>permission.brokerSmsMailings</item>
			<item>permission.brokerSmsMailings.freeSmsMailings</item>
			<item>permission.brokerSmsMailings.paidSmsMailings</item>
			<item>permission.memberProfile.changeName</item>
			<item>permission.memberProfile.changeUsername</item>
			<item>permission.systemInfoTexts</item>
			<item>permission.systemInfoTexts.manage</item>
			<item>permission.systemInfoTexts.view</item>
			<item>pos.actions.unblockPin</item>
			<item>pos.pinUnblocked</item>
			<item>pos.unblockPin.confirmation</item>
			<item>posweb.error.notEnoughCredits</item>
			<item>profile.action.manageNotifications</item>
			<item>profile.action.preferencesActions</item>
			<item>quickAccess.accountInfo</item>
			<item>reports.print.limitation</item>
			<item>serviceClient.credentialsRequired</item>
			<item>serviceOperation.INFO_TEXTS</item>
			<item>serviceOperation.MANAGE_MEMBERS</item>
			<item>serviceOperation.SMS</item>
			<item>settings.access.error.numericPassword.groupsRequireLetters</item>
			<item>settings.access.error.virtualKeyboard.groupsRequireSpecial</item>
			<item>settings.local.emailUnique</item>
			<item>settings.local.maxIteratorResults</item>
			<item>settings.local.messageFormat</item>
			<item>settings.local.sms.channel</item>
			<item>settings.local.sms.customField</item>
			<item>settings.message.adminPendingBuyerOnlyGuarantee</item>
			<item>settings.message.adminPendingGuarantee</item>
			<item>settings.message.cardSecurityCodeBlocked</item>
			<item>settings.message.externalChannelPaymentPerformed</item>
			<item>settings.message.externalChannelPaymentRequestExpiredPayer</item>
			<item>settings.message.externalChannelPaymentRequestExpiredReceiver</item>
			<item>settings.message.newPendingPaymentByPayer</item>
			<item>settings.message.posPinBlocked</item>
			<item>sms.error.type.ALLOW_CHARGING_DISABLED</item>
			<item>sms.error.type.NOT_ENOUGH_FUNDS</item>
			<item>sms.error.type.NO_PHONE</item>
			<item>sms.error.type.NO_SMS_LEFT</item>
			<item>sms.error.type.SEND_ERROR</item>
			<item>sms.type.ACCOUNT_DETAILS</item>
			<item>sms.type.ACCOUNT_DETAILS_ERROR</item>
			<item>sms.type.GENERAL</item>
			<item>sms.type.HELP</item>
			<item>sms.type.HELP_ERROR</item>
			<item>sms.type.INFO_TEXT</item>
			<item>sms.type.INFO_TEXT_ERROR</item>
			<item>sms.type.OPERATION_CONFIRMATION</item>
			<item>sms.type.PAYMENT</item>
			<item>sms.type.PAYMENT_ERROR</item>
			<item>sms.type.REQUEST_PAYMENT</item>
			<item>sms.type.REQUEST_PAYMENT_ERROR</item>
			<item>smsLog.free</item>
			<item>smsLog.mailingType</item>
			<item>smsLog.messageType</item>
			<item>smsLog.smsType</item>
			<item>smsLog.status.DELIVERED</item>
			<item>smsLog.status.ERROR</item>
			<item>smsLog.type</item>
			<item>smsLog.type.MAILING</item>
			<item>smsLog.type.NOTIFICATION</item>
			<item>smsLog.type.SMS_OPERATION</item>
			<item>smsMailing.broker.all</item>
			<item>smsMailing.broker.group</item>
			<item>smsMailing.by</item>
			<item>smsMailing.date</item>
			<item>smsMailing.error.noMobilePhone</item>
			<item>smsMailing.groups</item>
			<item>smsMailing.mailingType.FREE_FROM_BROKER</item>
			<item>smsMailing.mailingType.FREE_TO_GROUP</item>
			<item>smsMailing.mailingType.INDIVIDUAL</item>
			<item>smsMailing.mailingType.PAID_FROM_BROKER</item>
			<item>smsMailing.mailingType.PAID_TO_GROUP</item>
			<item>smsMailing.member</item>
			<item>smsMailing.new</item>
			<item>smsMailing.recipients</item>
			<item>smsMailing.search.noResults</item>
			<item>smsMailing.sendType</item>
			<item>smsMailing.sendType.group</item>
			<item>smsMailing.sendType.member</item>
			<item>smsMailing.sent</item>
			<item>smsMailing.sentSms</item>
			<item>smsMailing.stillSending</item>
			<item>smsMailing.text</item>
			<item>smsMailing.title.search</item>
			<item>smsMailing.title.send</item>
			<item>smsMailing.type</item>
			<item>smsMailing.type.FREE</item>
			<item>smsMailing.type.PAID</item>
			<item>ticket.date</item>
			<item>ticket.fromChannel</item>
			<item>ticket.toChannel</item>
			<item>transfer.commision.broker.notcommision</item>
			<item>transferType.allowSmsNotification</item>
			<item>transferType.reserveTotalAmountOnScheduling</item>
		</new-translation-keys>

		<removed-translation-keys>
			<item>account.creditsPendingAuthorization</item>
			<item>accountFeeLog.status.FAILED</item>
			<item>alert.system.adminTransactionPasswordBlockedByTrials</item>
			<item>changePassword.currentPassword</item>
			<item>changePassword.error.tooSimple</item>
			<item>changePassword.forceChangeOnNextLogin</item>
			<item>changePassword.newPassword1</item>
			<item>changePassword.newPassword2</item>
			<item>changePin.error.tooSimple</item>
			<item>changePin.newPin1</item>
			<item>changePin.newPin2</item>
			<item>channel.principal</item>
			<item>channel.principal.ANY</item>
			<item>channel.principal.CARD</item>
			<item>channel.principal.USER</item>
			<item>customImage.system.active.gif</item>
			<item>customImage.system.calendar.gif</item>
			<item>customImage.system.captchaBackground.jpg</item>
			<item>customImage.system.checked.gif</item>
			<item>customImage.system.conciliated.gif</item>
			<item>customImage.system.delete.gif</item>
			<item>customImage.system.dropdown.gif</item>
			<item>customImage.system.edit.gif</item>
			<item>customImage.system.edit_gray.gif</item>
			<item>customImage.system.help.gif</item>
			<item>customImage.system.icon.ico</item>
			<item>customImage.system.import.gif</item>
			<item>customImage.system.inactive.gif</item>
			<item>customImage.system.incomplete.gif</item>
			<item>customImage.system.message_read.gif</item>
			<item>customImage.system.message_removed.gif</item>
			<item>customImage.system.message_replied.gif</item>
			<item>customImage.system.message_unread.gif</item>
			<item>customImage.system.mobileLogo.gif</item>
			<item>customImage.system.next.gif</item>
			<item>customImage.system.noPicture.gif</item>
			<item>customImage.system.pay.gif</item>
			<item>customImage.system.pending.gif</item>
			<item>customImage.system.permissions.gif</item>
			<item>customImage.system.permissions_gray.gif</item>
			<item>customImage.system.preview.gif</item>
			<item>customImage.system.previous.gif</item>
			<item>customImage.system.print.gif</item>
			<item>customImage.system.quickAccess_contacts.png</item>
			<item>customImage.system.quickAccess_makePayment.png</item>
			<item>customImage.system.quickAccess_messages.png</item>
			<item>customImage.system.quickAccess_placeAd.png</item>
			<item>customImage.system.quickAccess_searchAds.png</item>
			<item>customImage.system.quickAccess_updateProfile.png</item>
			<item>customImage.system.save.gif</item>
			<item>customImage.system.systemLogo.gif</item>
			<item>customImage.system.view.gif</item>
			<item>global.textFormat.BOTH_DEFAULT_PLAIN_TEXT</item>
			<item>global.textFormat.BOTH_DEFAULT_RICH_TEXT</item>
			<item>global.textFormat.PLAIN_TEXT_ONLY</item>
			<item>global.textFormat.RICH_TEXT_ONLY</item>
			<item>global.textFormat.plainText</item>
			<item>global.textFormat.richText</item>
			<item>guarantee.enabledGuaranteeType</item>
			<item>login.member</item>
			<item>member.memberUsername</item>
			<item>message.received.fromAdministration</item>
			<item>message.received.fromMember</item>
			<item>mobile.login.username</item>
			<item>payment.awaitingProcessing</item>
			<item>payment.pendingProcessing</item>
			<item>payment.title.awaitingProcessing</item>
			<item>paymentRequest.error.INVALID_MEMBER</item>
			<item>paymentRequest.error.SYSTEM_OFFLINE</item>
			<item>paymentRequest.error.UNKNOWN_ERROR</item>
			<item>permission.operatorReferences.give</item>
			<item>settings.local.simpleMessageFormat</item>
			<item>settings.local.toBrokeredMembersMessageFormat</item>
			<item>settings.local.toGroupMessageFormat</item>
			<item>settings.message.pendingBuyerOnlyGuaranteeAdmin</item>
			<item>settings.message.pendingGuaranteeAdmin</item>
			<item>smsLog.status.CHARGE_FAILED</item>
			<item>smsLog.status.FAILED</item>
			<item>smsLog.status.INVALID_MEMBER</item>
			<item>smsLog.status.NOT_ENOUGH_CREDITS</item>
			<item>smsLog.status.SUCCESS</item>
			<item>smsLog.status.SYSTEM_OFFLINE</item>
			<item>smsLog.status.UNKNOWN_ERROR</item>
			<item>smsLogs.CHARGE_FAILED</item>
			<item>transferType.reserveTotalAmountOnSchedling</item>
		</removed-translation-keys>

		<new-setup-keys>
			<item>settings.message.admin-payment-from-member-to-system.body</item>
			<item>settings.message.admin-payment-from-member-to-system.subject</item>
			<item>settings.message.admin-payment-from-system-to-member.body</item>
			<item>settings.message.admin-payment-from-system-to-member.subject</item>
			<item>settings.message.admin-payment-from-system-to-system.body</item>
			<item>settings.message.admin-payment-from-system-to-system.subject</item>
			<item>settings.message.admin-pending-buyer-only-guarantee.body</item>
			<item>settings.message.admin-pending-buyer-only-guarantee.subject</item>
			<item>settings.message.admin-pending-guarantee.body</item>
			<item>settings.message.admin-pending-guarantee.subject</item>
			<item>settings.message.broker-removed-remark-comments</item>
			<item>settings.message.brokering-expiration.sms</item>
			<item>settings.message.brokering-removed.sms</item>
			<item>settings.message.buyer-only-guarantee-status-changed.body</item>
			<item>settings.message.buyer-only-guarantee-status-changed.sms</item>
			<item>settings.message.buyer-only-guarantee-status-changed.subject</item>
			<item>settings.message.certification-issued.sms</item>
			<item>settings.message.certification-status-changed.sms</item>
			<item>settings.message.commission-contract-accepted.sms</item>
			<item>settings.message.commission-contract-cancelled.sms</item>
			<item>settings.message.commission-contract-denied.sms</item>
			<item>settings.message.expired-certification.sms</item>
			<item>settings.message.expired-guarantee.body</item>
			<item>settings.message.expired-guarantee.sms</item>
			<item>settings.message.expired-guarantee.subject</item>
			<item>settings.message.external-channel-payment-performed.body</item>
			<item>settings.message.external-channel-payment-performed.sms</item>
			<item>settings.message.external-channel-payment-performed.subject</item>
			<item>settings.message.external-channel-payment-request-expired-payer.body</item>
			<item>settings.message.external-channel-payment-request-expired-payer.sms</item>
			<item>settings.message.external-channel-payment-request-expired-payer.subject</item>
			<item>settings.message.external-channel-payment-request-expired-receiver.body</item>
			<item>settings.message.external-channel-payment-request-expired-receiver.sms</item>
			<item>settings.message.external-channel-payment-request-expired-receiver.subject</item>
			<item>settings.message.guarantee-status-changed.body</item>
			<item>settings.message.guarantee-status-changed.sms</item>
			<item>settings.message.guarantee-status-changed.subject</item>
			<item>settings.message.message-mail-subject-prefix</item>
			<item>settings.message.message-mail-suffix-html</item>
			<item>settings.message.message-mail-suffix-plain</item>
			<item>settings.message.new-commission-contract.sms</item>
			<item>settings.message.payment-obligation-registered.body</item>
			<item>settings.message.payment-obligation-registered.sms</item>
			<item>settings.message.payment-obligation-registered.subject</item>
			<item>settings.message.payment-obligation-rejected.body</item>
			<item>settings.message.payment-obligation-rejected.sms</item>
			<item>settings.message.payment-obligation-rejected.subject</item>
			<item>settings.message.pending-buyer-only-guarantee-issuer.body</item>
			<item>settings.message.pending-buyer-only-guarantee-issuer.sms</item>
			<item>settings.message.pending-buyer-only-guarantee-issuer.subject</item>
			<item>settings.message.pending-guarantee-issuer.body</item>
			<item>settings.message.pending-guarantee-issuer.sms</item>
			<item>settings.message.pending-guarantee-issuer.subject</item>
			<item>settings.message.reference-received.sms</item>
			<item>settings.message.removed-from-broker-group.sms</item>
			<item>settings.message.scheduled-payment-failed-to-payee.body</item>
			<item>settings.message.scheduled-payment-failed-to-payee.sms</item>
			<item>settings.message.scheduled-payment-failed-to-payee.subject</item>
			<item>settings.message.scheduled-payment-failed-to-payer.body</item>
			<item>settings.message.scheduled-payment-failed-to-payer.sms</item>
			<item>settings.message.scheduled-payment-failed-to-payer.subject</item>
			<item>settings.message.sms-message-prefix</item>
			<item>settings.message.transaction-feedback-admin-comments.sms</item>
			<item>settings.message.transaction-feedback-received.sms</item>
			<item>settings.message.transaction-feedback-reply.sms</item>
			<item>settings.message.transaction-feedback-request.sms</item>
		</new-setup-keys>

		<removed-setup-keys>
			<item>settings.message.admin-payment-member-to-system.body</item>
			<item>settings.message.admin-payment-member-to-system.subject</item>
			<item>settings.message.admin-payment-system-to-member.body</item>
			<item>settings.message.admin-payment-system-to-member.subject</item>
			<item>settings.message.admin-payment-system-to-system.body</item>
			<item>settings.message.admin-payment-system-to-system.subject</item>
			<item>settings.message.broker-removed-remark</item>
			<item>settings.message.buyer_only_guarantee_status_changed.body</item>
			<item>settings.message.buyer_only_guarantee_status_changed.subject</item>
			<item>settings.message.expired_guarantee.body</item>
			<item>settings.message.expired_guarantee.subject</item>
			<item>settings.message.external_channel_payment_performed.body</item>
			<item>settings.message.external_channel_payment_performed.sms</item>
			<item>settings.message.external_channel_payment_performed.subject</item>
			<item>settings.message.external_channel_payment_request_expired_payer.body</item>
			<item>settings.message.external_channel_payment_request_expired_payer.sms</item>
			<item>settings.message.external_channel_payment_request_expired_payer.subject</item>
			<item>settings.message.external_channel_payment_request_expired_receiver.body</item>
			<item>settings.message.external_channel_payment_request_expired_receiver.sms</item>
			<item>settings.message.external_channel_payment_request_expired_receiver.subject</item>
			<item>settings.message.guarantee_status_changed.body</item>
			<item>settings.message.guarantee_status_changed.subject</item>
			<item>settings.message.mail-body.suffix.html</item>
			<item>settings.message.mail-body.suffix.plain</item>
			<item>settings.message.mail-subject.prefix</item>
			<item>settings.message.payment_obligation_registered.body</item>
			<item>settings.message.payment_obligation_registered.subject</item>
			<item>settings.message.payment_obligation_rejected.body</item>
			<item>settings.message.payment_obligation_rejected.subject</item>
			<item>settings.message.pending_buyer_only_guarantee_admin.body</item>
			<item>settings.message.pending_buyer_only_guarantee_admin.subject</item>
			<item>settings.message.pending_buyer_only_guarantee_issuer.body</item>
			<item>settings.message.pending_buyer_only_guarantee_issuer.subject</item>
			<item>settings.message.pending_guarantee_admin.body</item>
			<item>settings.message.pending_guarantee_admin.subject</item>
			<item>settings.message.pending_guarantee_issuer.body</item>
			<item>settings.message.pending_guarantee_issuer.subject</item>
			<item>settings.message.scheduled-payment-failed-payee.body</item>
			<item>settings.message.scheduled-payment-failed-payee.sms</item>
			<item>settings.message.scheduled-payment-failed-payee.subject</item>
			<item>settings.message.scheduled-payment-failed-payer.body</item>
			<item>settings.message.scheduled-payment-failed-payer.sms</item>
			<item>settings.message.scheduled-payment-failed-payer.subject</item>
			<item>settings.message.sms-message.prefix</item>
		</removed-setup-keys>

        <statements database="mysql">
            <item>alter table transfers add constraint unique trace_number (trace_number, client_id)</item>
            <item>alter table external_transfers add column description text</item>
            <item>alter table service_clients add column credentials_required bit not null</item>
            <item>create table channels_principals (id integer not null auto_increment, channel_id integer not null, principal varchar(1) not null, custom_field_id integer, is_default bit not null default 0, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table channels_principals add index FKDABC45D47514938B (custom_field_id), add constraint FKDABC45D47514938B foreign key (custom_field_id) references custom_fields (id)</item>
            <item>alter table channels_principals add index FKDABC45D49B71D578 (channel_id), add constraint FKDABC45D49B71D578 foreign key (channel_id) references channels (id)</item>
            <item>insert into channels_principals (channel_id, principal) select id, principal from channels</item>
            <item>alter table channels drop column principal</item>
            <item>create table service_clients_manage_groups (service_client_id integer not null, group_id integer not null, primary key (service_client_id, group_id)) ENGINE=InnoDB</item>
            <item>alter table service_clients_manage_groups add index FK5A4E59EDB45926EE (group_id), add constraint FK5A4E59EDB45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table service_clients_manage_groups add index FK5A4E59EDBC65B77D (service_client_id), add constraint FK5A4E59EDBC65B77D foreign key (service_client_id) references service_clients (id)</item>
            <item>alter table groups 
                  add column sms_free_count integer default 0 not null, 
                  add column sms_additional_charged_count integer default 1 not null, 
                  add column sms_additional_charged_period_number integer, 
                  add column sms_additional_charged_period_field integer, 
                  add column sms_context_class_name varchar(255)
              </item> 
              <item>alter table pending_members add column pin varchar(64)</item>
              <item>alter table sms_logs
                  drop foreign key FKF9D930D5EAE0AB57, 
                  change member_id target_member_id integer not null,
                  add column charged_member_id integer,
                  change type message_type varchar(3),
                  add column sms_type varchar(3),
                  add column error_type varchar(3),
                  add column sms_mailing bit not null, 
                  add column free_base_used bit not null                  
              </item>
              <item>alter table sms_logs
                  add index FKF9D930D5311F5E08 (charged_member_id), 
                  add constraint FKF9D930D5311F5E08 foreign key (charged_member_id) references members (id),
                  add index FKF9D930D5E0901629 (target_member_id), 
                  add constraint FKF9D930D5E0901629 foreign key (target_member_id) references members (id)
              </item>
              <item>update sms_logs set charged_member_id = target_member_id
                    where status in ('SC', 'IM', 'SO', 'UE', 'NC', 'CF')
  			  </item>
              <item>update sms_logs set error_type = 
                case status 
                    when 'NC' then 'NEF'
                    when 'CF' then 'ACD'
                    when 'SC' then null
                    else 'SE'
                end where status in ('SC', 'IM', 'SO', 'UE', 'NC', 'CF')
              </item>
              <item>alter table sms_logs drop column status</item>
              <item>create table member_sms_status (id integer not null auto_increment, member_id integer not null unique, free_sms_sent integer not null, free_sms_expiration datetime, paid_sms_left integer not null, paid_sms_expiration datetime, allow_charging_sms bit not null, accept_free_mailing bit not null, accept_paid_mailing bit not null, primary key (id)) ENGINE=InnoDB</item>
              <item>alter table member_sms_status add index FKCC65105DEAE0AB57 (member_id), add constraint FKCC65105DEAE0AB57 foreign key (member_id) references members (id)</item>
              <item>create table sms_mailings (id integer not null auto_increment, by_id integer not null, date datetime not null, text varchar(255) not null, free bit not null, finished bit not null, sent_sms integer not null, primary key (id)) ENGINE=InnoDB</item>
              <item>create table sms_mailings_groups (sms_mailing_id integer not null, group_id integer not null) ENGINE=InnoDB</item>
              <item>create table sms_mailings_pending_to_send (sms_mailing_id integer not null, member_id integer not null) ENGINE=InnoDB</item>
              <item>alter table sms_mailings add index FK9BFD1F2E2B1214C2 (by_id), add constraint FK9BFD1F2E2B1214C2 foreign key (by_id) references members (id)</item>
              <item>alter table sms_mailings_groups add index FKA3F5E80552CC4E04 (sms_mailing_id), add constraint FKA3F5E80552CC4E04 foreign key (sms_mailing_id) references sms_mailings (id)</item>
              <item>alter table sms_mailings_groups add index FKA3F5E805B45926EE (group_id), add constraint FKA3F5E805B45926EE foreign key (group_id) references groups (id)</item>
              <item>alter table sms_mailings_pending_to_send add index FKAA585113EAE0AB57 (member_id), add constraint FKAA585113EAE0AB57 foreign key (member_id) references members (id)</item>
              <item>alter table sms_mailings_pending_to_send add index FKAA58511352CC4E04 (sms_mailing_id), add constraint FKAA58511352CC4E04 foreign key (sms_mailing_id) references sms_mailings (id)</item>
              <item>alter table sms_logs drop column sms_mailing, add column sms_mailing_id integer</item>
              <item>alter table sms_logs add index FKF9D930D552CC4E04 (sms_mailing_id), add constraint FKF9D930D552CC4E04 foreign key (sms_mailing_id) references sms_mailings (id)</item>
              <item>create table reverses (id bigint not null auto_increment, date datetime not null, trace_number varchar(100), client_id bigint, primary key (id)) ENGINE=InnoDB</item>
			  <item>alter table reverses add constraint unique trace_number (trace_number, client_id)</item>
			  <item>create table member_account_fee_logs (id bigint not null auto_increment, date datetime not null, member_id integer not null, account_fee_log_id integer, transfer_id bigint, invoice_id integer, primary key (id)) ENGINE=InnoDB</item>
			  <item>alter table member_account_fee_logs add index FK74581F9F2F78F3B3 (transfer_id), add constraint FK74581F9F2F78F3B3 foreign key (transfer_id) references transfers (id)</item>
			  <item>alter table member_account_fee_logs add index FK74581F9FEAE0AB57 (member_id), add constraint FK74581F9FEAE0AB57 foreign key (member_id) references members (id)</item>
			  <item>alter table member_account_fee_logs add index FK74581F9FE9B959A1 (invoice_id), add constraint FK74581F9FE9B959A1 foreign key (invoice_id) references invoices (id)</item>
			  <item>alter table member_account_fee_logs add index FK74581F9F6957A5AA (account_fee_log_id), add constraint FK74581F9F6957A5AA foreign key (account_fee_log_id) references account_fee_logs (id)</item>
			  <item>create table username_change_logs (id integer not null auto_increment, date datetime not null, by_id integer not null, user_id integer not null, previous_username varchar(64) not null, new_username varchar(64) not null, primary key (id)) ENGINE=InnoDB</item>
			  <item>alter table username_change_logs add index FK6FF08EF52B1214C2 (by_id), add constraint FK6FF08EF52B1214C2 foreign key (by_id) references members (id)</item>
			  <item>alter table username_change_logs add index FK6FF08EF5A19267FC (user_id), add constraint FK6FF08EF5A19267FC foreign key (user_id) references users (id)</item>
			  <item>create table account_locks (id bigint not null, primary key (id)) ENGINE=InnoDB</item>
			  <item>insert into account_locks (id) select id from accounts</item>
			  <item>alter table sms_mailings add column member_id integer</item>
			  <item>alter table sms_mailings add index FK9BFD1F2EEAE0AB57 (member_id), add constraint FK9BFD1F2EEAE0AB57 foreign key (member_id) references members (id)</item>			  
			  <item>create table info_text_aliases (info_text_id integer not null, alias varchar(255)) ENGINE=InnoDB</item>
			  <item>create table info_texts (id integer not null auto_increment, subject varchar(160) not null, body longtext, enabled bit not null, begin_date date, end_date date, primary key (id)) ENGINE=InnoDB</item>
			  <item>alter table info_text_aliases add index FK83C54DDDB4F0D375 (info_text_id), add constraint FK83C54DDDB4F0D375 foreign key (info_text_id) references info_texts (id)</item>
			  <item>update settings set name = 
                case name 
                    when 'pendingGuaranteeAdminMessage' then 'adminPendingGuaranteeMessage'
                    when 'pendingGuaranteeAdminSubject' then 'adminPendingGuaranteeSubject'
                    when 'pendingBuyerOnlyGuaranteeAdminMessage' then 'adminPendingBuyerOnlyGuaranteeMessage'
                    else 'adminPendingBuyerOnlyGuaranteeSubject'
                end where name in ('pendingGuaranteeAdminMessage', 'pendingGuaranteeAdminSubject', 'pendingBuyerOnlyGuaranteeAdminSubject', 'pendingBuyerOnlyGuaranteeAdminMessage')</item>
              <item>create index ix_email on members (email)</item>
              <item>create index ix_username on users (username)</item>
			  <item>alter table channels drop index ix_internal_name</item>            
              <item>create index ix_string_value on custom_field_values (string_value(50))</item>
              <item>alter table account_status drop column pending_credits_count, drop column pending_credits_amount</item>
              <item>alter table groups add column sms_show_free_threshold integer not null default 50</item>
              <item>create index ix_account_status_adi on account_status (account_id, date, id)</item>			  
              <item>alter table users add column salt varchar(32)</item>
              <item>alter table imported_members add column salt varchar(32)</item>
              <item>alter table pending_members add column salt varchar(32)</item>
              <!-- Assign true to existing card types, but the new default should be false -->
              <item>alter table card_types add column show_card_security_code bit(1) not null default true</item>
              <item>alter table card_types modify show_card_security_code bit(1) not null default false</item>
              <item>create index ix_ticket on tickets (ticket)</item>
              <item>alter table messages add messages_sent integer default 0 not null, add emails_sent integer default 0 not null, add finished bit(1) not null default false</item>
              <item>create table messages_pending_to_send (message_id integer not null, member_id integer not null) ENGINE=InnoDB</item>
              <item>alter table messages_pending_to_send add index FK8EB43731EAE0AB57 (member_id), add constraint FK8EB43731EAE0AB57 foreign key (member_id) references members (id)</item>
              <item>alter table messages_pending_to_send add index FK8EB437312FA70115 (message_id), add constraint FK8EB437312FA70115 foreign key (message_id) references messages (id)</item>
              <item>update messages set finished = true where type='a2g' and not exists (select 1 from messages_pending_to_send where message_id = messages.id)</item>
              <item>create table messages_to_groups (message_id integer not null, group_id integer not null) ENGINE=InnoDB</item>
              <item>alter table messages_to_groups add index FKE76064E5B45926EE (group_id), add constraint FKE76064E5B45926EE foreign key (group_id) references groups (id)</item>
              <item>alter table messages_to_groups add index FKE76064E52FA70115 (message_id), add constraint FKE76064E52FA70115 foreign key (message_id) references messages (id)</item>
              <item>insert into messages_to_groups (message_id, group_id) select id, to_group_id from messages where to_group_id is not null</item>
              <item>alter table messages drop foreign key FKE475014C1D376432</item>
              <item>alter table messages drop column to_group_id</item>
              <item>insert into settings (type, name, value)
					select type, 'messageFormat', case when value like '%PLAIN%' then 'PLAIN' else 'RICH' end
					from settings where name = 'simpleMessageFormat'</item>
			  <item>delete from settings where name in ('simpleMessageFormat', 'toGroupMessageFormat', 'toBrokeredMembersMessageFormat')</item>
			  <item>update settings set value='PLAIN' where name='adDescriptionFormat' and value in ('PLAIN_TEXT_ONLY')</item>
			  <item>update settings set value='RICH' where name='adDescriptionFormat' and value in ('BOTH_DEFAULT_PLAIN_TEXT', 'BOTH_DEFAULT_RICH_TEXT', 'RICH_TEXT_ONLY')</item>
			  <item>alter table transfer_types add column allow_sms_notification bit(1) not null default true</item>
			  <item>create index ix_np_member_type on notification_preferences (member, type)</item>
			  <item>alter table pending_account_status add column transfer_status char(1)</item>
			  <item>update pending_account_status set transfer_status = (select t.status from transfers t where t.id = pending_account_status.transfer_id)</item>
			  <item>alter table card_logs modify column by_id integer</item>
        </statements>
        
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.RemoveMaskFromCustomFieldsMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.ForceReindexMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.ChangeImagesColumnsMigration" />
     </version>

    <version label="3.6_beta3">
        <enhancements>
            <item>Added the transaction number in transactions export</item>
            <item>Now there is an enforcement that an user cannot have 2 equal passwords (for example, pin can't be equals to login password)</item>
            <item>Trace logs to the web services access, invoked operations and generated errors were added</item>
            <item>In the searchTransferTypes operation (account web service) if the fromMember and toMember are not set (and the client is restricted to member) then the toMember is taken from the restricted member</item>
            <item>The members transactions reports speed have been greatly improved. The invoices options were removed, as they were misleading within the report.</item>
            <item>New operation in the Payment Web Service to reverse a transfer</item>
            <item>Now a pending transfer can be charged back / reversed by receiver (if he/she has the charge back permission for the transfer type)</item>
            <item>On the member import, added the option to send the activation e-mail for imported members. Previoulsy, it was never sent</item>
        </enhancements>
        
        <bug-fixes>
            <item>It was possible that, on advertisements results, HTML entities, like &amp;nbsp; were partially truncated, showing a part of it on the list</item>
            <item>Newly created currencies couldn't be removed</item>
            <item>Search indexes, when being rebuilt, could keep records which no longer exists</item>
            <item>Having multiple rich text editors in the same page (example: several custom fields with rich text editor) made them being shown with distinc sizes</item>
            <item>If sms messages are disabled in group, but an user had preferences to receive them, he would still keep receiving those</item>
            <item>For scheduled payments generated by invoices, the user which receives the payment could see the pay now button. He wouldn't be able to perform the payment anyway, but the button was being displayed</item>
            <item>Administrator viewing messages sent to the administration were seeing, on the inbox, the application username as from, and not the member who sent the message</item>
            <item>It was not possible to manually process an scheduled payment with a single installment</item>
            <item>Fixed an internal error when creating a broker commission</item>
            <item>The searchTransferTypes operation (account web service) didn't take into account the payer's permissions</item>
            <item>On flat member records, if the broker / admin didn't have the permission to create records, the form was visible. There was a permission error on submit, anyway</item>
            <item>A broker was not being able to view member records from his users even with permissions</item>
            <item>Immediately after creating a new group cloning another one, no custom fields were available, until the next application restart or after saving a custom field, which would reload the cached data</item>
            <item>On members lists / reports, the groups list could be unsorted or have duplicate groups</item>
        </bug-fixes>
        
        <new-translation-keys>
            <item>transfer.fromOrTo</item>
            <item>memberImport.sendActivationMail</item>
            <item>group.settings.pinBlockTimeAfterMaxTries.number</item>
            <item>group.settings.pinBlockTimeAfterMaxTries.field</item>            
        </new-translation-keys>
        
        <removed-translation-keys>
            <item>transfer.relatedName</item>
            <item>guarantee.enabledGuaranteeType</item>
        </removed-translation-keys>
        
        <statements database="mysql">            
            <item>alter table transfers 
                add column trace_number varchar(100),
                add column client_id integer,
                add column chargedback_by_id bigint,
                add index FK3EBE45E8E846CE9F (chargedback_by_id), 
                add constraint FK3EBE45E8E846CE9F foreign key (chargedback_by_id) references transfers (id)</item>
        </statements>
        
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.SetChargebacksMigration" />
    </version>

    <version label="3.6_beta2">
        <enhancements>
            <item>Right aligned amounts in account history</item>
            <item>The export account history no longer has a from, to and always positive amount. Instead, it's displayed as the page: a related account / user and the amount may be either positive or negative</item>
        </enhancements>
        
        <bug-fixes>
            <item>It was not possible to permanently remove a member</item>
            <item>The AccountFeeLog-Invoice relationship was fixed (it was pointing to a Transfer entity)</item>
            <item>Account fees which charge over volumes shouldn't allow manual run mode</item>
            <item>Balance account fees were not being charged correctly</item>
            <item>When logging in through externalLogin, and there were a registration agreement which should be accepted, the page to accept it was not being displayed</item>
            <item>Sometimes, disabled administrators were being notified about events he choose to monitor while active</item>
            <item>Many alerts were not being notified by e-mail to registered admins</item>
        </bug-fixes>
    </version>

    <version label="3.6_beta1">
    
        <enhancements>
            <item>Refactored the full-text indexing, which is now much faster and less intrusive, creating the index on background. Also, Lucene has been updated to 2.9.0</item>
            <item>Now channels support specifying how to identify users (login / card) and how to authenticate them (which password / card security code)</item>
            <item>Added an option to group account setting which may hide accounts from users when credit limit is zero, making it easier to have credit accounts</item>
            <item>Added the possibility to customize the date separator in local settings</item>
            <item>It's now possible to filter transfers awaiting authorization using the transaction number</item>
            <item>Added the option to force change password on first login on administrators registration also</item>
            <item>Improved scheduled payments configuration in transfer type</item>
            <item>Made it possible to receive scheduled payments in posweb</item>
            <item>Improved the captcha image (on public registration)</item>
        </enhancements>

        <bug-fixes>
            <item>When a member group had a permission removed, but had already granted it to his operators, if the admin remove the member group permission the operators still had that permission</item>
            <item>The password policy is not applied when creating an administrator</item>
            <item>When removing an accessible channel from a group, remove it from members too</item>
            <item>When editing a loan group and clicking to add a member and the member was empty, there was an invalid form submission error instead of a validation error</item>
            <item>Improved the validation for amounts and dates in loans with multiple installments</item>
            <item>Ensured that for access WebService's searchTransferTypes() method only usable transfer types are returned</item>
            <item>When the 'payment every' field is invalid in a payment, the error is shown but the payment is performed without installments</item>
            <item>Custom field values were not being displayed in posweb payment confirmation</item>
            <item>The main web channel shoudln't be shown as option in group details for accessible / default channels, as access to it rely on permission to login</item>
            <item>Some improvements in the loan / loan payment searches</item>
            <item>The user reports for transactions was displaying wrong data when there were chargebacks (both summary and details)</item>
            <item>The print dynamic document feature was not working well in Chrome browser</item>
            <item>Sometimes, after importing members or ads, the results wouldn't be available on keywords searches until the next application restart</item>
        </bug-fixes>

        <new-css-classes>
            <item>.alertNotification</item>
        </new-css-classes>
        <statements database="mysql">
            <item>alter table account_status add column d_rate decimal(15,6), add column last_d_rate_update datetime, add column emission_date datetime, add column rate_balance_correction decimal(15,6), add column reserved_scheduled_payments_count int(11) not null default 0, add column reserved_scheduled_payments_amount decimal(21,6) not null default 0, add column scheduled_payment_id int(11), add index FK33CFE644B3A79238 (scheduled_payment_id), add constraint FK33CFE644B3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
            <item>alter table transaction_fees add column h decimal(15,6)</item>
            <item>alter table transaction_fees add column a_f_is_zero decimal(15,6)</item>
            <item>alter table transaction_fees add column f1 decimal(15,6)</item>
            <item>alter table transaction_fees add column f_infinite decimal(15,6)</item>
            <item>alter table transaction_fees add column f_minimal decimal(15,6)</item>
            <item>alter table transaction_fees add column g_f_is_zero decimal(15,6)</item>
            <item>alter table members add column is_indexed bit default false not null</item>
            <item>alter table ads add column is_indexed bit default false not null</item>
            <item>alter table member_records add column is_indexed bit default false not null</item>
            <item>create table card_logs (id integer not null auto_increment, date datetime, status varchar(1) not null, card_id integer not null, by_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table card_types (id integer not null auto_increment, name varchar(100) not null, card_format_number varchar(56), default_expiration_number integer, default_expiration_field integer, card_security_code varchar(1), ignore_day_in_expiration_date bit default false not null, min_card_security_code_length integer, max_card_security_code_length integer, security_code_block_time_number integer, security_code_block_time_field integer, max_security_code_tries integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table cards (id integer not null auto_increment, card_type_id integer not null, card_number decimal(19,0) unique, card_security_code varchar(64), creation_date datetime, activation_date datetime, expiration_date datetime, owner_id integer not null, status varchar(1) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table card_logs add index FKF1616D7E2B1214C2 (by_id), add constraint FKF1616D7E2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table card_logs add index FKF1616D7E293F7A45 (card_id), add constraint FKF1616D7E293F7A45 foreign key (card_id) references cards (id)</item>
            <item>alter table cards add index FK5A0E763FE01A09E (owner_id), add constraint FK5A0E763FE01A09E foreign key (owner_id) references members (id)</item>
            <item>alter table cards add index FK5A0E7638595CD86 (card_type_id), add constraint FK5A0E7638595CD86 foreign key (card_type_id) references card_types (id)</item>
            <item>alter table groups add column card_type_id integer</item>
            <item>alter table groups add index FKB63DD9D48595CD86 (card_type_id), add constraint FKB63DD9D48595CD86 foreign key (card_type_id) references card_types (id)</item>                 
            <item>alter table transfers add column d_rate decimal(15,6), add column emission_date datetime</item>
            <item>create table groups_conversion_simulation_transfer_types (group_id integer not null, transfer_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table groups_conversion_simulation_transfer_types add index FK88FC75FFA4766B0A (transfer_type_id), add constraint FK88FC75FFA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table groups_conversion_simulation_transfer_types add index FK88FC75FF25A5B3E8 (group_id), add constraint FK88FC75FF25A5B3E8 foreign key (group_id) references groups (id)</item>
            <item>create table broker_conversion_simulation_transfer_types (group_id integer not null, transfer_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_conversion_simulation_transfer_types add index FKA32CA71AA4766B0A (transfer_type_id), add constraint FKA32CA71AA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table broker_conversion_simulation_transfer_types add index FKA32CA71A85B3A90F (group_id), add constraint FKA32CA71A85B3A90F foreign key (group_id) references groups (id)</item>
            <item>create table member_pos (id integer not null auto_increment, pos_name varchar(64), pos_pin varchar(64), date datetime not null, allow_make_payment bit not null, max_scheduling_payments integer not null, number_of_copies integer not null, result_page_size integer not null, status varchar(1) not null, pos_id integer not null, owner_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table pos (id integer not null auto_increment, pos_id varchar(64) not null unique, description varchar(100), status varchar(1) not null, member_pos_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table pos_logs (id integer not null auto_increment, date datetime not null, pos_status varchar(1) not null, member_pos_status varchar(1), by_id integer, pos_id integer, assigned_to integer, primary key (id)) ENGINE=InnoDB</item>                        
            <item>alter table member_pos add index FKB0148F2FF3ECFBC0 (pos_id), add constraint FKB0148F2FF3ECFBC0 foreign key (pos_id) references pos (id)</item>
            <item>alter table member_pos add index FKB0148F2FFE01A09E (owner_id), add constraint FKB0148F2FFE01A09E foreign key (owner_id) references members (id)</item>
            <item>alter table pos add index FK1B25413A66F8B (member_pos_id), add constraint FK1B25413A66F8B foreign key (member_pos_id) references member_pos (id)</item>
            <item>alter table pos_logs add index FK2C0220BA2B1214C2 (by_id), add constraint FK2C0220BA2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table pos_logs add index FK2C0220BA2B3ED03 (assigned_to), add constraint FK2C0220BA2B3ED03 foreign key (assigned_to) references members (id)</item>
            <item>alter table pos_logs add index FK2C0220BAF3ECFBC0 (pos_id), add constraint FK2C0220BAF3ECFBC0 foreign key (pos_id) references pos (id)</item>
            <item>alter table groups add column member_max_pos_scheduling_payments integer not null default 0</item>
            <item>alter table groups add column member_number_of_copies integer not null default 0</item>
            <item>alter table groups add column member_result_page_size integer not null default 0</item>
            <item>alter table groups add column member_allow_make_payment bit not null default false</item>
            <item>alter table channels add column principal char(1), add column credentials char(1)</item>
            <item>update channels set principal='U', credentials = case use_pin when true then 'P' else 'D' end</item>
            <item>alter table channels modify column principal char(1) not null, modify column credentials char(1) not null</item>
            <item>alter table channels drop column use_pin</item>
            <item>insert into channels (internal_name, display_name, principal, credentials) values ('pos', 'POS', 'U', 'D')</item>
            <item>alter table member_group_account_settings add column hide_when_no_credit_limit bit not null default false</item>
            <item>update settings set value = case value when 'DD_MM_YYYY' then 'DD_MM_YYYY_SLASH' when 'MM_DD_YYYY' then 'MM_DD_YYYY_SLASH' when 'YYYY_MM_DD' then 'YYYY_MM_DD_SLASH' else value end where name = 'datePattern'</item>
            <item>create table service_clients_chargeback_payment_types (service_client_id integer not null, transfer_type_id integer not null, primary key (service_client_id, transfer_type_id)) ENGINE=InnoDB</item>
            <item>alter table service_clients_chargeback_payment_types add index FKD8ECB3FDA4766B0A (transfer_type_id), add constraint FKD8ECB3FDA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table service_clients_chargeback_payment_types add index FKD8ECB3FDBC65B77D (service_client_id), add constraint FKD8ECB3FDBC65B77D foreign key (service_client_id) references service_clients (id)</item>
            <item>alter table currencies add column a_rate_params_id integer, add column d_rate_params_id integer</item>
            <item>create table rate_parameters (id integer not null auto_increment, subclass varchar(1) not null, currency_id integer not null, date datetime not null, enabled_since datetime not null, init_value decimal(15,6) not null, init_date datetime not null, creation_value decimal(15,6) not null, interest decimal(15,6), base_malus decimal(15,6), minimal_d decimal(15,6), primary key (id)) engine=InnoDB </item>
            <item>create index ix_date on rate_parameters (date) </item>
            <item>alter table rate_parameters add index FK1169FEA9C0E7F6FA (currency_id), add constraint FK1169FEA9C0E7F6FA foreign key (currency_id) references currencies (id) </item>
            <item>alter table currencies add index FKBF10006FD5E3649E (d_rate_params_id), add constraint FKBF10006FD5E3649E foreign key (d_rate_params_id) references rate_parameters (id) </item>
            <item>alter table currencies add index FKBF10006F239B8C3E (a_rate_params_id), add constraint FKBF10006F239B8C3E foreign key (a_rate_params_id) references rate_parameters (id) </item>
            <item>alter table transfer_types add column reserve_total_on_sched bit(0) not null default 0, add column allow_cancel_sched bit(0) not null default 0, add column allow_block_sched bit(0) not null default 0, add column show_sched_to_dest bit(0) not null default 0</item>
            <item>update transfer_types set allow_cancel_sched=1, allow_block_sched=1 where allows_scheduled_payments = 1</item>
            <item>alter table pending_account_status add column scheduled_payment_id int(11), add index FK47B289ECB3A79238 (scheduled_payment_id), add constraint FK47B289ECB3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
            <item>alter table scheduled_payments add column reserve_amount bit(0) not null default 0</item>
            <item>delete from members_channels where channel_id = (select id from channels where internal_name='web')</item>
        </statements>

        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_6.ForceReindexMigration" />
        
    </version>

    <version label="3.5.6">
        <bug-fixes>
            <item>E-mails with a single character before @ were being handled as invalid</item>
            <item>In some rare cases, combined with payments in past, the account balance could show up the wrong value</item>
            <item>There was an application error when navigating to another result page in search Loan Payments</item>
            <item>The export / import translation messages was redirecting to the wrong path</item>
            <item>Fixed some cases where reloading the page caused the member autocomplete to misbehave</item>
            <item>The authorized payments had a bug which prevented the same user to perform such a payment a second time</item>
            <item>Advertisements with description in rich text format didn't recognize accented characters for keywords search. The fix is only for ads saved from now on, or to all, if a full reindexing is done (removing WEB-INF/indexes directory)</item>
            <item>When exporting transactions to CSV, the date shown was always the submission date. In cases like payment in past, this was showing the wrong date</item>
        </bug-fixes>

        <statements database="mysql">
            <item>delete from account_status</item>
            <item>delete from account_fee_charges</item>
            <item>update application set account_status_enabled_since = current_date()</item>
        </statements>

		<!-- No need to create the account status, as it was removed  
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.FixedAccountStatusRecreationMigration" />
		 -->
    </version>

    <version label="3.5.5">
        <bug-fixes>
            <item>The PIN blocked notification was always in english</item>
            <item>After confirming an scheduled payent as admin or operator, there was an invalid form submission, but the payment was performed anyway</item>
            <item>After confirming a scheduled payment as member members, the user was being redirected to the search scheduled payments page, not that specific payment details</item>            
            <item>Only the first page was printed when select print all the manual</item>
            <item>On the edit group permissions, it could happen that, when changing visible system accounts / groups, the payment types options were missing a few items</item>
            <item>Fixed several problems with formatting / parsing dates when a timezone is set in local settings</item>
            <item>The scheduled payment search and details was not showing the currency pattern in amounts</item>
            <item>Negative balance account fees were never being charged</item>
            <item>Importing members when there was an unique custom field was always resulting in error</item>
        </bug-fixes>

        <statements database="mysql">
            <item>alter table login_history modify date datetime not null</item>
            <item>alter table loan_payments modify expiration_date date not null</item>
            <item>alter table payment_obligations modify expiration_date date not null, modify max_publish_date date not null</item>
        </statements>
    </version>
    
    <version label="3.5.4">
        <enhancements>
            <item>Added support for french, japanese and simplified chinese languages</item>
        </enhancements>
        
        <bug-fixes>
            <item>When a volume account fee was active, there was an error while viewing a member's account history</item>
            <item>Updating the e-mail for pending members was failing, saying the e-mail was not unique</item>
            <item>Chargebacks were not retaining the same custom field values as original payments</item>
            <item>The webshop payments were considering the access setting for login password virtual keyboard on transaction passwords</item>
            <item>Now the account status is updated in the background, which improves both performance and reliability</item>
            <item>Fixed a problem handling dates when time zone is enabled in local settings</item>
            <item>In the edit ad page, root categories which have no child categories are show before others. Before, they were blending with other parent categories</item>
            <item>When searching member records wasn't displaying pagination tag</item>
            <item>When changing the category of an advertisement, the old / new category counters were not instantly updated</item>
            <item>Ads set as plain text were not being HTML escaped in search results, making it possible to use unwanted images or break layout</item>
            <item>Export to csv empty result when filtering by keyword</item>
            <item>Disable periods instead of hiding in edit ad to avoid problems with image options</item>
            <item>When clicking on back button on payment confirmation, it should clean payment form fields</item>
            <item>Validate ad image name - name too long causes application error</item>
            <item>Member lists report without h-scrollbar</item>
            <item>It was possible to remove an account from a group when members had non-zero balance</item>
            <item>When a member had credit limit and was changed to a disabled group, the limit was lost</item>
            <item>When a lot of data was being sent to client in Ajax requests, there was a server error</item>
            <item>Charging back a payment could make the receiving account go negative</item>
            <item>The permissions to authorized a payment as receiver was not being checked (a member which was a payment receiver for an authorized payment in receiver level could always authorize, no matter the permission)</item>
            <item>The max advertisement description size for HTML contents was counting markup also. Now, only text is counted.</item>
            <item>The initial balance on print account history (when a period is specified) was not considering the typed date, but the next day</item>
        </bug-fixes>
        
        <statements database="mysql">
            <item>create table pending_account_status (id bigint not null auto_increment, type varchar(3) not null, date datetime, account_id integer, transfer_id bigint, invoice_id integer, by_id integer, transfer_authorization_id bigint, lower_limit decimal(15,6), upper_limit decimal(15,6), subtracted_amount decimal(15,6), primary key (id)) ENGINE=InnoDB</item>
            <item>alter table pending_account_status add index FK47B289EC2B1214C2 (by_id), add constraint FK47B289EC2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table pending_account_status add index FK47B289EC2F78F3B3 (transfer_id), add constraint FK47B289EC2F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>alter table pending_account_status add index FK47B289ECE9B959A1 (invoice_id), add constraint FK47B289ECE9B959A1 foreign key (invoice_id) references invoices (id)</item>
            <item>alter table pending_account_status add index FK47B289EC108D798A (transfer_authorization_id), add constraint FK47B289EC108D798A foreign key (transfer_authorization_id) references transfer_authorizations (id)</item>
            <item>alter table pending_account_status add index FK47B289EC3317FFBA (account_id), add constraint FK47B289EC3317FFBA foreign key (account_id) references accounts (id)</item>
        </statements>
    </version>
        
    <version label="3.5.3">
        <enhancements>
            <item>Now the rich text editor is preloaded in pages where the form is initially disabled. So, when the user clicks the Change button, the editor will be already loaded, or at least already loading</item>
            <item>Now a query string could be passed to the mobile login page to specify a group/group filter allowing to load his customized files</item>
            <item>Now pending members emails must be unique, which helps preventing people from registering multiple times</item>
            <item>The style classes .adTitle, .adDescription, .adOwner were replaced by .productTitle, .productDescription, .productOwner, as they were being removed by the AdBlock FireFox extension. Customized CSS files are automatically updated for the new classes</item>
            <item>Now the print members page hides custom fields without value, making it take less space for printing</item>
            <item>Now the export members to CSV includes the broker name also (previously it was only the broker login)</item>
            <item>Implemented both search and export to csv function for pending members</item>
            <item>Now in account history, payments and their generated transfers appear in the expected order. Previously, generated transfers were appearing before the original transfer</item>
            <item>The webshop payment cancellation confirmation has been removed, as it was confusing to have ok/cancel for a cancellation</item>
            <item>Now the print pages do not set the focus on the print button, which might cause a confusing scroll on some pages</item>            
        </enhancements>

        <bug-fixes>
            <item>When inserting a new advertisement, the description format was always plain text, despite the settings</item>
            <item>Under some circumstances, a theme should be applied twice to have effect</item>
            <item>Member groups without accounts but in active groups were not having the activation date set</item>
            <item>Pending e-mail registrations were not being removed after the elapsed days in settings</item>
            <item>Now the edit profile pages shows rich text custom fields using the entire available width</item>
            <item>There was a javascript error in the edit group permissions which prevented payment types from being correctly updated</item>
            <item>When customize the login.css/style.css for a group/group filter these files were not loaded</item>
            <item>Customized application pages were always being marked as conflict and having the original contents stored as the current contents. As a result, if stop customizing, the file was not being returned to it's original state</item>
            <item>Fixed an error while generating an error log</item>
            <item>On print account history when there was an ending date, the final balance shown was not taking into account payments in the ending date, which could lead to incorrect data being shown. Using other filters could change the balance as well</item>
            <item>In the pending member profile, when clicking change then cancel, the resend e-mail button was being disabled too</item>
            <item>Pending payments to authorize were not being shown to members as payer, only as receiver</item>
            <item>When using a customized static file inside a customized login page for a specific group / group filter, and that static page was also customized for the group / group filter, the globally customized page was being shown</item>
            <item>File customization for group / group filter didn't work in Internet Explorer</item>
            <item>Operators that could see at least one of his member's accounts could actually see them all</item>
            <item>Password policy for a member group was not being enforced on his operators</item>
            <item>When printing or exporting to csv members or ads with a keywords search, there was an application error</item>
            <item>Disabled advertisement categories were still being shown in the category browser in the advertisements search</item>
            <item>Removing an advertisement interest would lead to a blank page</item>
            <item>The password was not mandatory when register a new user (by admin/broker) and the (generated) password was not sent by email</item>
            <item>Inactive members which had accepted a registration agreement couldn't be permanently removed</item>
            <item>Some account fees were being handled incorrectly</item>
            <item>The message for members receiving account fees was not being sent</item>
        </bug-fixes>
        
        <statements database="mysql">
            <item>update members set member_activation_date = creation_date where member_activation_date is null and group_id in (select id from groups where member_active = true)</item>
            <item>update files set contents = replace(replace(replace(contents, '.adTitle', '.productTitle'), '.adDescription', '.productDescription'), '.adOwner', '.productOwner') where type = 'C'</item>
            <item>delete from account_fee_charges where account_fee_log_id in (select l.id from account_fee_logs l inner join account_fees af on l.account_fee_id = af.id where af.charge_mode not in ('VP', 'NV'))</item>
            <item>delete from account_status where account_fee_log_id in (select id from account_fee_logs where status='S' and account_fee_id in (select id from account_fees where charge_mode not in ('VP', 'NV')))</item>
            <item>delete from account_fee_logs where status='S' and account_fee_id in (select id from account_fees where charge_mode not in ('VP', 'NV'))</item>
            <item>update settings set value = replace(value, '#units#', '#amount#') where type='message'</item>
        </statements>
        
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.AccountFeeLogPeriodMigration" />
    </version>

    <version label="3.5.2">
        <enhancements>
            <item>Added 2 more settings in member group: max pin wrong tries and deactivation time after pin tries</item>
            <item>Added another visibility type for member custom field in the editable by property: Member not at registration</item>
            <item>Now in account fees, the free base parameter is also used for fixed amount fees. In such cases, the fee is charged only when the balance is greater than the free base</item>
            <item>Now the account fee charge waits 10ms instead of 500ms after charging each member, making it faster while not so cpu intensive</item>
            <item>It's now possible to specify the creation date for imported members, which should be done in the column named creationdate</item>
            <item>The webshop payment page has been changed a bit to make it easier to fit in layout with the customized files (webshop_header.jps and webshop_footer.jsp)</item>
        </enhancements>

        <bug-fixes>
            <item>Setting the pin for a member which had none was not saving the new value</item>
            <item>Modifying an existing registration agreement was showing a normal, not a rich text editor for the contents</item>
            <item>The e-mail validation option in member groups was only being displayed when the group was set as initial group</item>
            <item>Admins / brokers without permission to manage pending member, when registering members with e-mail validation enabled would see the pending member profile with the change / submit buttons. Trying to save would result in permission error anyway, but the buttons are now hidden</item>
            <item>Disconnecting an user from the connected users list would disconnect all sessions for that user, not just the specified one</item>
            <item>An admin or broker registering a member, when setting to manually assign password, password was not being validated as required</item>
            <item>When performing a payment or sending an invoice, after selecting a member, when there are no possible payment types, there was a loop of the alert box saying there were no payment types</item>
            <item>Transfer types from systems were being created without the web channel enabled, rendering them unusable</item>
            <item>There was a bug in the URL validation, making it, for example, impossible to generate webshop tickets</item>
            <item>Hidden member custom field values were being indexed, and possibly allowing searching over those values</item>
            <item>Under some circumstances, importing advertisements was resulting in application exception</item>
            <item>There was a wrong translation key in the current state reports</item>
            <item>The upper credit limit, when used, was not being shown in the account history</item>
            <item>Webshop payments were allowed even when the client member was not related to the channel</item>
            <item>In webshop payments when fees are applied, they were not being shown</item>
            <item>There was no information whether the payment is awaiting authorization through TicketVO in web services. Now the 'awaitingAuthorization' flag was added</item>
            <item>When importing members, when there is not enough credits to create them, there was an application error. Now it shows the correct message</item>
            <item>Currency patterns were not being applied in the personal member reports page</item>
            <item>When a contact is being added and was already in the contact list, a new message is shown</item>
            <item>In the popup which displays thumbnails / images, when the displayed image was too small, window was being resized smaller than it should, and the thumbnails were not visible</item>
            <item>Using webshop payments with transaction password enabled was not validating the transaction password</item>
        </bug-fixes>
        
        <new-translation-keys>
            <item>contact.error.alreadyExists</item>
            <item>customField.member.access.MEMBER_NOT_REGISTRATION</item>
            <item>group.settings.maxPinWrongTries</item>
            <item>group.settings.pinBlockTimeAfterMaxTries</item>
            <item>memberImport.status.INVALID_CREATION_DATE</item>
            <item>webshop.error.paymentDisabled</item>
        </new-translation-keys>

        <removed-translation-keys>
            <item>mobile.transactionPassword.error.blocked</item>
            <item>mobile.transactionPassword.error.pending</item>
            <item>posweb.title.quickpayment.login</item>
            <item>reports.stats.activity.comparePeriods.loginTimes.row1.short</item>
            <item>reports.stats.activity.comparePeriods.percentageNoTrade.row1.short</item>
            <item>reports.stats.activity.singlePeriod.loginTimes.row1.short</item>
            <item>webshop.title.confirm</item>
            <item>webshop.title.confirmation</item>
            <item>webshop.title.payment</item>
        </removed-translation-keys>
        
        <statements database="mysql">
            <item>insert into transfer_types_channels (transfer_type_id, channel_id) select tt.id, c.id from transfer_types tt, channels c where c.internal_name = 'web' and tt.allowed_payment = true and not exists (select 1 from transfer_types_channels ttc where ttc.transfer_type_id = tt.id)</item>
            <item>alter table imported_members add column creation_date date</item>
        </statements>
        
    </version>

    <version label="3.5.1">
        <enhancements>
            <item>Added a property in the advertisement model retrieved via web services indicating whether the description is html or plain text</item>
            <item>Now in posweb, when a payment is performed, instead of showing a button above the form, the payment data is displayed with a print link and a close button. Only after closing a new payment can be performed. The old behavior was confusing for some people.</item>
            <item>In member notifications in, for example, payments and invoices from system, instead of seeing "from the administration (the administration)", now it is "from the administration (Cyclos)". Those variables are the system settings application name and application username</item>
        </enhancements>

        <bug-fixes>
            <item>When a text input format in local settings (such as ad description) and the default was plain text, another text area was being displayed</item>
            <item>When transaction password is not used, the manage external password page has javascript errors</item>
            <item>The container page was not being honored when validating a registration e-mail</item>
            <item>Layout on login page was left-aligned</item>
            <item>A last time commit broke both member and ad imports</item>
            <item>The password policy was not used for pin to enforce simple pins or prevent previous pins to be reused</item>
            <item>Having more than one custom field with rich text editor would make only a the first one to be displayed</item>
            <item>After the e-mail validation, when the initial group is inactive, a message was shown as if the member could login immediately, not the one he should wait for administration to activate him</item>
            <item>Under some circumstances, a member accepting a system invoice would result in application error</item>
            <item>In firefox, if there was a password remembered, the transaction password, when requested, defaulted to that remembered password</item>
            <item>Sending a message was always plain text, despite the settings</item>
        </bug-fixes>
        
        <new-translation-keys>
            <item>changePin.error.tooSimple</item>
        </new-translation-keys>
        
    </version>

    <version label="3.5">
        <enhancements>
            <item>Enumerated custom fields which are required now have a "Please select..." label when the value is empty</item>
            <item>Added a new local setting for decimal numbers input method: right to left (the classical mode, only numbers are typed) or left to right (should type the whole numbers, the decimal separator and then decimal numbers)</item>
            <item>Now in the web service clients it's possible to set as client address an IP range in form A.B.C.D-E</item>
            <item>Now an operator group cannot have individual payment type permissions, as this could bypass system-wide payment types configurations. It also made the operator group permissions page simpler, as the member doesn't need to know which transfer types he should grant to operators</item>
            <item>Added support to use a loan payment type (only if single payment) as initial credit</item>
            <item>In the public user registration, when registration agreement is used, instead of a large button with the "I agree..." message, there's a checkbox with that message and a regular submit button</item>
            <item>The posweb url is now more meaninful: root/posweb (member, both make and receive payments), /root/posweb/pay (member, make payment), /root/posweb/receive (member, receive payment) and /posweb/operator (operator, using permissions to check make and receive payments)</item>
            <item>Now the static file login.jsp is simpler, and doesn't have the form code inside, which was refactored to an included jsp. This also avoids messing up with the form when customizing the file, which could lead to not being able to login anymore</item>
            <item>Implemented temporary pin block on max invalid tries, as well as admin / broker / member permissions to immediately unblock it</item>
            <item>Added support for TLS security for sending e-mails. There's an option under mail settings</item>
            <item>The PaymentWebService and TicketWebService were handling currencies in different ways. Now the currency parameter is always a string, which may be either the symbol or the identifier</item>
            <item>It's now possible to determine whether members or ads custom fields are indexed for member and / or ad keywords searches</item>
            <item>It's now possible to set an enumerated custom field's possible value as default for new values</item>
            <item>The WS clients are improved, allowing to set a fixed channel and payment types for do payment and receive payment</item>
            <item>The advertisement interest notifications on new ads are much faster now</item>
            <item>Now images of members and advertisements handle browser's cache request, avoiding unnecessary downloads</item>
            <item>In autocomplete fields for login name, when generated, there's an appropriate numeric mask now</item>
            <item>Now there is a currency column in the account types list, and in account overview, the balances are shown with the respective currency symbol</item>
            <item>There is a new static file: posweb_login.jsp</item>
            <item>The PosWeb static files (posweb_header.jsp and posweb_footer.jsp) are no longer centered in a small table, allowing full control of the layout</item>
            <item>It is now possible to set a visibility level on advertisement custom fields: admin / broker / member</item>
            <item>Allowed the 'hide' column in member registration, allowing to hide e-mail and custom fields since registration</item>
            <item>The e-mail validation setting in member group can now be set to specific registration types: none / public / broker / admin</item>
            <item>The new pending member alert was removed, as it's now possible for admins to choose which groups they want to be notified when new members are created</item>
            <item>When a password policy is used for an user group, then previously used passwords cannot be used again. When no policy is used, then they can be used again</item>
            <item>Added another access settings: posweb session timeout</item>
        </enhancements>

        <bug-fixes>
            <item>The member search by custom field was broken in 3.5_RC2</item>
            <item>The external accounts overview was giving error in HSQLDB (i.e. standalone server)</item>
            <item>When performing payments with custom fields, the focus was jumping to the first custom field, instead of staying on the amount</item>
            <item>When saving a payment or member record custom field, the next page displayed was the transfer type or record type, not the field itself</item>
            <item>It was possible to select a currency while sending invoice from member to member where there were transfer types for the payment, but the invoice destination member had no permission to perform them</item>
            <item>URL custom fields which were not editable were generating an invalid page</item>
            <item>The transaction password for accepting invoices were being requested when it shoudln't</item>
            <item>When a payment would generate fees from other accounts in other currencies, in the fees preview, amounts were shown as if they were of the same currency as the original payment</item>
            <item>The loading message displayed when the user types in the system url is now displayed more to the top, making it friendlier in cases where cyclos is used inside another web site</item>
            <item>When a group didn't have the permission to see other members of that group, a member couldn't also modify his own profile</item>
            <item>When a member received invoices / payments from members he didn't have permission to see, there was an error</item>
            <item>When updating a custom field with child fields, some child field properties which should be the same as the parent's ones were not copied</item>
            <item>In the public member registration, custom fields dependent of a parent value didn't have it's values populated when changing the parent value</item>
            <item>In the make payment / send invoice pages, when a member was not selected and the currency was changed, there was an error message</item>
            <item>In posweb/quickpayment, when an operator was not generated his transaction password there was a NPE</item>
            <item>In posweb/quickpayment, only the group settings were considered to request the transaction password, now the group-account settings is taken into account too</item>
            <item>In posweb/quickpayment, if the operator/member submit the form withour any data there was a NPE</item>
            <item>Member custom fields with 'editable by' set to member registration were not having their values saved on the public registration</item>
            <item>The SERVER_ROOT/wap shortcut was redirecting to SERVER_ROOT/do/mobile/login, not SERVER_ROOT/do/wap/login</item>
            <item>There was a javascript error in the edit payment type page under Internet Explorer</item>
            <item>There was an error sending invoice via admin or broker as member to another member</item>
            <item>The value textarea for custom field possible values was too narrow</item>
            <item>Validation error on operator home when clicking on the 'Update profile' action</item>
            <item>In the account fee details, now the 'First charged period starts at' is only shown when the run mode is 'scheduled'. It is also positioned more logically</item>
            <item>Payment errors (such as not enough funds) in mobile access was displaying an internal error message instead of a regular error message</item>
            <item>In the advertisement edit, the rich text editor now uses all available space</item>
            <item>Some layout fixes for webkit (Chrome / Safari)</item>
            <item>Lifecycle initializations for guarantees, payment obligations and certifications were added</item>
            <item>The logged user information was improved: if it's a member then "username - name" is showed, if it's an operator then "memberusername / username - name" is showed</item>
            <item>Bulk change members to removed groups was not allowed, but removed groups were appearing in the select box</item>
            <item>Error accepting invoice in Internet Explorer</item>
            <item>The registration agreement was not being copied when inserting a new group based on an existing one</item>
            <item>On the login form, when clicking operator login, the member was not being validated as required</item>
            <item>A logged member in the mobile service, when disconnected, was seeing an error page, and the ok link lead back to the same error page, making it impossible to login again until the session expired</item>
            <item>The channel setting for wap 1 / 2 to use pin as password was not being used</item>
            <item>Mobile payment throws a NPE if the transaction password was not generated</item>
            <item>Change my PIN throws a NPE if the transaction password was not generated</item>
            <item>In 'My given references' when clicking a reference and then back, the displayed page was the other member's references, not mine</item>
            <item>The transaction password was not being requested on chargeback payment</item>
            <item>Custom field values for scheduled payments were not being copied to each installment</item>
            <item>Rich text editors in read-only mode were taking variable horizontal space. Now it's the same space as the editor</item>
            <item>When an admin / broker (with permissions) set a member pin which was already used in past, there was an application error</item>
            <item>An operator viewing member messages was actually viewing all system messages</item>
            <item>The pin entry was being handled as pure numbers, where 01 is the same as 1, making it impossible to start the pin with zeros</item>
            <item>Member custom fields marked as editable only by admin were being displayed in the registration by broker</item>
            <item>There was an application error when inserting a translation key which already existed</item>
            <item>Added a new method in AccountWebService: loadTransfer(memberId, transferId)</item>
            <item>Added new parameters in AccountWebService.search(): relatedMemberId and relatedMemberUsername</item>
            <item>The member group setting 'enable permanent advertisements' was not being used</item>
            <item>Some layout improvements on Internet Explorer</item>
            <item>The create administrator select box (group) was different than the member</item>
            <item>There were log errors under some circumstances for ImageByIdServlet</item>
            <item>Depending on the configuration, for multi-currency systems, it was possible that a payment member to member from profile would result in error for no transfer type</item>
            <item>Some fixes on background tasks, like ad interest notifications</item>
            <item>Member custom fields set editable on public registration were not appearing on registration by broker</item>
            <item>When the server date was set to a past date, there could be problems with account balances</item>
            <item>The sizes for ad and member image thumbnails were not being correctly reported to the browser when the disk cache was disabled</item>
            <item>There was an error if the channel's internal name was modified</item> 
            <item>When saving an advertisement or member with an image of invalid format, the ad / member was being saved anyway</item>
            <item>The virtual keyboard was not being used when typing the transaction password on change pin</item>
            <item>Members or admins whose username were the same as an operator's username were unable to login</item>
            <item>Now general barcode readers are better supported, specially for account number fields (login name when it's a generated number)</item>
            <item>Custom fields marked as unique now allows repeating values which were previously used by removed members or ads</item>
            <item>Messages from broker to his registered members were being shown as from System, not the from the broker</item>
            <item>On the create group, the copy settings from couldn't be left empty</item>
            <item>Import / export settings was always using a hardcoded /cyclos/... path, which was broke on other urls</item>
            <item>In change pin, when transaction password is used but is blocked or haven't been generated, there is a friendly message now</item>
            <item>Custom field values for removed members were not being shown in profile</item>
            <item>Rich text fields in display only mode having wide contents could break the page layout</item>
            <item>Canceling an already finished execution of an account fee was resulting in application exception</item>
            <item>Uploading a new member or ad image was making the new image appear before existing images, after</item>
            <item>Error after removing a possible value in an enumerated payment custom field</item>
            <item>Broker commissions paid from system were not being paid</item>
        </bug-fixes>
        
        <new-static-files>
            <item>posweb_login.jsp</item>
        </new-static-files>

        <new-translation-keys>
            <item>accountFee.action.alreadyFinished</item>
            <item>alert.member.PIN_BLOCKED_BY_TRIES</item>
            <item>alert.member.pinBlockedByTries</item>
            <item>changePin.error.transactionPasswordBlocked</item>
            <item>changePin.error.transactionPasswordPending</item>
            <item>createMember.assignPassword</item>
            <item>createMember.error.mailSending</item>
            <item>createMember.error.registrationAgreementCheck</item>
            <item>createMember.forceChangePassword</item>
            <item>createMember.public.awaitingActivation</item>
            <item>createMember.public.awaitingPassword</item>
            <item>createMember.public.validated</item>
            <item>customField.ad.indexed</item>
            <item>customField.ad.visibility</item>
            <item>customField.ad.visibility.ADMIN</item>
            <item>customField.ad.visibility.BROKER</item>
            <item>customField.ad.visibility.MEMBER</item>
            <item>customField.member.indexing</item>
            <item>customField.member.indexing.MEMBERS_AND_ADS</item>
            <item>customField.member.indexing.MEMBERS_ONLY</item>
            <item>customField.member.indexing.NONE</item>
            <item>customField.possibleValue.default</item>
            <item>error.image</item>
            <item>group.registrationAgreement.explanation</item>
            <item>group.registrationAgreement.forceAccept</item>
            <item>group.registrationAgreement.none</item>
            <item>group.settings.emailValidation</item>
            <item>group.settings.emailValidation.ALL</item>
            <item>group.settings.emailValidation.NEVER</item>
            <item>group.settings.emailValidation.PUBLIC</item>
            <item>group.settings.emailValidation.PUBLIC_BROKER</item>
            <item>invoice.title.print</item>
            <item>login.operator.form.text</item>
            <item>mailPreferences.newMembers</item>
            <item>menu.admin.usersGroups.pendingMembers</item>
            <item>menu.admin.usersGroups.registrationAgreements</item>
            <item>menu.member.broker.pendingMembers</item>
            <item>mobile.login.pin</item>
            <item>mobile.transactionPassword.error.blocked</item>
            <item>mobile.transactionPassword.error.pending</item>
            <item>payment.chargeback.transactionPassword</item>
            <item>payment.recipient</item>
            <item>pendingMember.emailResent</item>
            <item>pendingMember.removeConfirmation</item>
            <item>pendingMember.removed</item>
            <item>pendingMember.resendEmail</item>
            <item>pendingMember.search.date</item>
            <item>pendingMember.title.profile</item>
            <item>pendingMember.title.search</item>
            <item>pendingMember.updated</item>
            <item>pendingMember.validationKey</item>
            <item>permission.adminMemberAccess.unblockPin</item>
            <item>permission.adminMembers.managePending</item>
            <item>permission.brokerMemberAccess.unblockPin</item>
            <item>permission.brokerMembers.managePending</item>
            <item>permission.memberAccess</item>
            <item>permission.memberAccess.unblockPin</item>
            <item>permission.systemRegistrationAgreements</item>
            <item>permission.systemRegistrationAgreements.manage</item>
            <item>permission.systemRegistrationAgreements.view</item>
            <item>pin.error.blocked</item>
            <item>pin.unblock.button</item>
            <item>pin.unblock.message</item>
            <item>pin.unblocked</item>
            <item>posweb.client.pin</item>
            <item>posweb.target.name</item>
            <item>posweb.target.username</item>
            <item>posweb.title.quickpayment.login</item>
            <item>registrationAgreement.contents</item>
            <item>registrationAgreement.error.removing</item>
            <item>registrationAgreement.inserted</item>
            <item>registrationAgreement.modified</item>
            <item>registrationAgreement.name</item>
            <item>registrationAgreement.new</item>
            <item>registrationAgreement.removeConfirmation</item>
            <item>registrationAgreement.removed</item>
            <item>registrationAgreement.title.accept</item>
            <item>registrationAgreement.title.insert</item>
            <item>registrationAgreement.title.list</item>
            <item>registrationAgreement.title.modify</item>
            <item>scheduledPayments.title.print</item>
            <item>scheduledPayments.totalAmount</item>
            <item>scheduledPayments.totalPaid</item>
            <item>scheduledPayments.totalRemaining</item>
            <item>serviceClient.channel</item>
            <item>serviceOperation.ACCESS</item>
            <item>serviceOperation.DO_PAYMENT</item>
            <item>serviceOperation.RECEIVE_PAYMENT</item>
            <item>settings.access.poswebTimeout</item>
            <item>settings.mail.activationMessageWithPassword</item>
            <item>settings.mail.activationMessageWithoutPassword</item>
            <item>settings.mail.smtp.useTLS</item>
            <item>settings.message.adminNewMember</item>
            <item>settings.message.pinBlocked</item>
        </new-translation-keys>

        <removed-translation-keys>
            <item>alert.member.NEW_PENDING</item>
            <item>alert.member.newPending</item>
            <item>changePin.reset</item>
            <item>createMember.public.created</item>
            <item>createMember.public.validationKey</item>
            <item>group.settings.mailValidation</item>
            <item>serviceOperation.PAYMENTS</item>
            <item>settings.mail.blindCarbonCopy</item>
        </removed-translation-keys>

        <new-setup-keys>
            <item>group.inactive-members.description</item>
            <item>group.inactive-members.name</item>
            <item>settings.mail.activationWithPassword.message</item>
            <item>settings.mail.activationWithoutPassword.message</item>
            <item>settings.message.admin-new-member.body</item>
            <item>settings.message.admin-new-member.subject</item>
            <item>settings.message.pin-blocked.body</item>
            <item>settings.message.pin-blocked.sms</item>
            <item>settings.message.pin-blocked.subject</item>
        </new-setup-keys>

        <removed-setup-keys>
            <item>group.pending-members.description</item>
            <item>group.pending-members.name</item>
            <item>settings.mail.activation.account-details</item>
            <item>settings.mail.activation.message</item>
        </removed-setup-keys>

        <statements database="mysql">
            <item>alter table service_clients change address address_begin varchar(100)</item>
            <item>alter table service_clients add column address_end varchar(100)</item>
            <item>update service_clients set address_end = address_begin</item>
            <item>delete from groups_transfer_types where group_id in (select id from groups where subclass='O')</item>
            <item>update settings set value=replace(value, '#units#', '#amount#')</item>
            <item>alter table groups add column member_max_pin_tries integer not null default 3</item>
            <item>alter table groups add column member_pin_block_number integer</item>
            <item>alter table groups add column member_pin_block_field integer</item>
            <item>update groups set member_pin_block_number = 1, member_pin_block_field = 5 where subclass='M'</item>
            <item>alter table custom_fields add column member_indexing char(1)</item>
            <item>update custom_fields set member_indexing = 'A' where subclass='member' and type in ('string', 'enum', 'url')</item>
            <item>update custom_fields set member_indexing = 'N' where subclass='member' and type not in ('string', 'enum', 'url')</item>
            <item>alter table custom_field_possible_values add column is_default bit default false not null</item>
            <item>create table service_clients_do_payment_types (service_client_id integer not null, transfer_type_id integer not null) ENGINE=InnoDB</item>
            <item>create table service_clients_receive_payment_types (service_client_id integer not null, transfer_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table service_clients_do_payment_types add index FKA83C5FEDA4766B0A (transfer_type_id), add constraint FKA83C5FEDA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table service_clients_do_payment_types add index FKA83C5FEDBC65B77D (service_client_id), add constraint FKA83C5FEDBC65B77D foreign key (service_client_id) references service_clients (id)</item>
            <item>alter table service_clients_receive_payment_types add index FK51FA69A3A4766B0A (transfer_type_id), add constraint FK51FA69A3A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table service_clients_receive_payment_types add index FK51FA69A3BC65B77D (service_client_id), add constraint FK51FA69A3BC65B77D foreign key (service_client_id) references service_clients (id)</item>
            <item>alter table service_clients add column channel_id integer</item>
            <item>alter table service_clients add index FK55B6E7E9B71D578 (channel_id), add constraint FK55B6E7E9B71D578 foreign key (channel_id) references channels (id)</item>
            <item>delete from transfer_types_channels where transfer_type_id in (select id from transfer_types where from_account_type_id in (select id from account_types where subclass='S'))</item>
            <item>insert into transfer_types_channels (transfer_type_id, channel_id) select tt.id, c.id from transfer_types tt, channels c where c.internal_name='web' and tt.from_account_type_id in (select id from account_types where subclass='S')</item>
            <item>create table registration_agreements (id integer not null auto_increment, name varchar(50) not null, contents longtext not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table groups drop column registration_agreement</item>
            <item>alter table groups add column registration_agreement_id integer</item>
            <item>alter table groups add index FKB63DD9D433E01D0A (registration_agreement_id), add constraint FKB63DD9D433E01D0A foreign key (registration_agreement_id) references registration_agreements (id)</item>
            <item>update images set image_size = length(image), thumbnail_size = length(thumbnail)</item>           
            <item>alter table custom_fields add column ad_indexed bit default 0 not null</item>
            <item>alter table custom_fields add column ad_visibility char(1)</item>
            <item>update custom_fields set ad_visibility = 'M' where subclass='ad'</item>
            <item>create table pending_members (id integer not null auto_increment, creation_date datetime not null, group_id integer not null, name varchar(100) not null, username varchar(64), email varchar(100) not null, validation_key varchar(64) not null, hide_email bit default false not null, last_email_date datetime, broker_id integer, registration_agreement_id integer, member_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table pending_members add index FK60337271EAE0AB57 (member_id), add constraint FK60337271EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table pending_members add index FK603372714B8741B8 (broker_id), add constraint FK603372714B8741B8 foreign key (broker_id) references members (id)</item>
            <item>alter table pending_members add index FK6033727133E01D0A (registration_agreement_id), add constraint FK6033727133E01D0A foreign key (registration_agreement_id) references registration_agreements (id)</item>
            <item>alter table pending_members add index FK60337271B45926EE (group_id), add constraint FK60337271B45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table custom_field_values add column pending_member_id integer</item>
            <item>alter table custom_field_values add index FK8AE18A15629CF4CC (pending_member_id), add constraint FK8AE18A15629CF4CC foreign key (pending_member_id) references pending_members (id)</item>
            <item>alter table groups add column member_mail_validation char(1)</item>
            <item>update groups set member_email_validation = 'P' where member_email_validation = true</item>
            <item>alter table groups drop column member_email_validation</item>
            <item>create table registration_agreement_logs (id integer not null auto_increment, member_id integer not null, registration_agreement_id integer not null, date datetime not null, remote_address varchar(100), primary key (id)) ENGINE=InnoDB</item>
            <item>alter table registration_agreement_logs modify remote_address varchar(100)</item>
            <item>alter table registration_agreement_logs add index FK415CBF0AEAE0AB57 (member_id), add constraint FK415CBF0AEAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table registration_agreement_logs add index FK415CBF0A33E01D0A (registration_agreement_id), add constraint FK415CBF0A33E01D0A foreign key (registration_agreement_id) references registration_agreements (id)</item>
            <item>alter table pending_members add column registration_agreement_date datetime</item>
            <item>delete from alerts where msg_key = 'alert.member.newPending'</item>
            <item>delete from admin_alert_notification_preferences where type='alert.member.newPending'</item>
            <item>create table admin_preferences_new_members (preference_id integer not null, group_id integer not null, primary key (preference_id, group_id)) ENGINE=InnoDB</item>
            <item>alter table admin_preferences_new_members add index FK292DCDC3FB43CB21 (preference_id), add constraint FK292DCDC3FB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <item>alter table admin_preferences_new_members add index FK292DCDC3B45926EE (group_id), add constraint FK292DCDC3B45926EE foreign key (group_id) references groups (id)</item>
            <item>delete from settings where name in ('invitationBCC', 'activationBCC', 'activationMessage', 'accountDetails')</item>
            <item>alter table pending_members add column password varchar(64)</item>
            <item>alter table pending_members add column remote_address varchar(100)</item>
            <item>alter table pending_members add column force_change_password bit not null default 0</item>            
        </statements>
        
    </version>

    <version label="3.5_RC2">
    
        <description>
            If you are migrating from previous versions, please, check http://project.cyclos.org/wiki/index.php?title=Migration_3.0_-_3.5
        </description>
    
        <enhancements>
            <item>It's now possible to assign custom fields to payments through payment types. This has replaced the loan custom fields, which are now custom fields in loan types</item>
            <item>The payment types which are to a member account now supports setting a fixed destination member: only payments to that member may use that payment type. Also useful in conjunction with the 'priority' setting for the payment type, making payments to special members to be of a specific type</item>
            <item>Improved default theme and new system logo</item>
            <item>Added the support to run Cyclos inside an iframe in another site</item>
            <item>Now it's possible to specify a customized class to validate a custom field value</item>
            <item>Now the 'member result display' setting is honored in the account history results</item>
            <item>The member autocomplete fields (normally a login name and full name) are improved</item>
            <item>The setting for virtual keyboard can now be set independently for login and transaction passwords</item>
            <item>Added the possibility to a transaction fee be charged from / paid to a fixed member, which is often needed in systems where partner organizations play an important role (for example, receiving fees)</item>
            <item>Now the e-mail notifications are queued in a separate thread, which makes general actions that perform notifications more responsive</item>
            <item>Added the doBulkPayment() to PaymentWebService</item>
            <item>Now a just registered pending by administrator guarantee can be removed from the system</item>
            <item>Now the generated loan is showed in the guarantee details</item>
            <item>On the initial database, now the loan repayment is a payment type from member account to debit account, no longer to community account</item>
            <item>Now the amount shown in the loan search (and loan payments) is formatted using the currency pattern</item>
            <item>Added a setting to show / hide the counters in advertisement categories, in ad search</item>
            <item>Now a custom field possible value (for enumerated fields) can be enabled / disabled</item>
            <item>Added the possibility to replace all occurrences of a given custom field possible value by another one</item>
            <item>Now, members can both perform and receive payments in the &lt;server url&gt;/quickpayment access</item>
        </enhancements>
        
        <bug-fixes>
            <item>Fixed a problem when read from Linux a windows-saved customized file (the Windows' carriage-return character causes the file to be considered different)</item>
            <item>When authorizing payments with transaction fees, the account statuses were not being updated for those fees, which led to incorrect balance and reserved amount being shown on accounts</item>
            <item>It was not possible to have only the permission to discard loans without the permission to repay</item>
            <item>When an user logged out, on the next login he would see the same page before logout, not the home page</item>
            <item>The conciliation status was being shown to member on transaction details</item>
            <item>When issuing guarantees which have loans which require authorization, fees were generated without the loan being totally accepted</item>
            <item>When viewing the account history with permission to view authorized payments, the canceled status was missing in the filter</item>
            <item>Fixed some wrong calculations with nested authorized fees, with multiple authorization levels</item>
            <item>It was possible to cancel generated transactions while awaiting authorization, which makes no sense. Only main transactions may be canceled</item>
            <item>When authorizing a payment with multiple authorization levels, the member was being notified that the payment was rejected when it was actually authorized to a next level. In this case, the member shouldn't be notified at all.</item>
            <item>Accessing a page when the session has expired redirects the user to the login page. However, when entering and invalid password, after a successful login, the previous page was no longer displayed, but the home instead</item>
            <item>The print transaction was not showing the currency in the amount field</item>
            <item>When logging in as member and then changing the url to the cyclos/mobile interface, there was an error. Now the user is logged out</item>
            <item>The view error log details page layout was broken due to large error details</item>
            <item>The currency pattern was not being shown in the transaction details</item>
            <item>When sending invoices from member to member through the menu, some unusual configuration could lead to not enabling a currency where it should be enabled</item>
            <item>The print receipt for posweb was yielding a permission error when the connected operator didn't have the permission to view account history as well</item>
            <item>Changing the order for custom fields in a member record type was returning to the wrong page</item>
            <item>The summary in the print loans and print loan payments was not taking into account the currency (the summary is showed only if a transfer type is selected)</item>
            <item>In the external payment processing, the date parameter was being ignored</item> 
            <item>An admin without transaction password (when it's enabled) viewing a transaction would see the actions to authorize / deny (when still pending authorization), but would never be able to auth / deby since he had no transaction password</item>
            <item>Fixed some cases where a group couldn't be removed</item>
            <item>Creating a new permission group based on another one now also copies the relationship to group filters</item>
            <item>Stop customizing the last file in a group or group filter was resulting in application error</item>
            <item>After clicking Modify and then Cancel in customize new file for group or group filter, the contents was being cleaned</item>
            <item>Repeated field mappings for file imports in external account are no longer allowed</item>
            <item>When adding a member to a loan group, and that member already belonged to the group, there was an application error</item>
            <item>When a static file was customized for a group filter, customizing it globally could actually update the former, not the latter</item>
        </bug-fixes>

        <new-translation-keys>
            <item>about.message</item>
            <item>about.version</item>
            <item>contactUs.message</item>
            <item>customField.error.invalidValidatorClass</item>
            <item>customField.moveValue</item>
            <item>customField.moveValue.confirmation</item>
            <item>customField.payment.access.BOTH_ACCOUNTS</item>
            <item>customField.payment.access.DESTINATION_MEMBER</item>
            <item>customField.payment.access.FROM_ACCOUNT</item>
            <item>customField.payment.access.NONE</item>
            <item>customField.payment.access.TO_ACCOUNT</item>
            <item>customField.payment.listAccess</item>
            <item>customField.payment.searchAccess</item>
            <item>customField.payment.type</item>
            <item>customField.payment.type.LINKED</item>
            <item>customField.payment.type.OWNED</item>
            <item>customField.possibleValue.enabled</item>
            <item>customField.title.insert.payment</item>
            <item>customField.title.modify.payment</item>
            <item>customField.title.order.payment</item>
            <item>customField.validation.validatorClass</item>
            <item>customField.valuesMoved</item>
            <item>global.search.all.male</item>
            <item>group.containerUrl</item>
            <item>groupFilter.containerUrl</item>
            <item>guarantee.action.delete</item>
            <item>guarantee.error.noIssuer</item>
            <item>guarantee.generatedLoan</item>
            <item>guarantee.loan</item>
            <item>guarantee.removeConfirmation</item>
            <item>guarantee.removed</item>
            <item>guarantee.status.WITHOUT_ACTION</item>
            <item>invoice.error.sendingWithMultipleTransferTypesWithCustomFields</item>
            <item>loan.queryStatus.ANY_CLOSED</item>
            <item>loan.queryStatus.ANY_OPEN</item>
            <item>loan.repayment.amountToRepaid</item>
            <item>loan.repayment.transactionPassword.canPerformExpiredAction</item>
            <item>loan.search.status</item>
            <item>loan.status.DISCARDED</item>
            <item>loan.status.EXPIRED</item>
            <item>loan.status.IN_PROCESS</item>
            <item>loan.status.RECOVERED</item>
            <item>loan.status.REPAID</item>
            <item>loan.status.UNRECOVERABLE</item>
            <item>loan.title.canPerformExpiredAction</item>
            <item>loanGroup.error.memberAlreadyInList</item>
            <item>loanPayment.summary.inProcessPayments</item>
            <item>loanPayment.summary.recoveredPayments</item>
            <item>loanPayment.summary.unrecoverablePayments</item>
            <item>login.bottomText</item>
            <item>login.form.text</item>
            <item>login.form.title</item>
            <item>login.registration.text</item>
            <item>login.registration.title</item>
            <item>payment.error.transferMinimum</item>
            <item>settings.access.virtualKeyboardLogin</item>
            <item>settings.access.virtualKeyboardTransactionPassword</item>
            <item>settings.local.containerUrl</item>
            <item>settings.local.showCountersInAdCategories</item>
            <item>top.message</item>
            <item>transactionFee.fromFixedMember.name</item>
            <item>transactionFee.fromFixedMember.username</item>
            <item>transactionFee.subject.FIXED_MEMBER</item>
            <item>transactionFee.toFixedMember.name</item>
            <item>transactionFee.toFixedMember.username</item>
            <item>transfer.relatedName</item>
            <item>transfer.schedulingDetails</item>
            <item>transferType.fields.action.link</item>
            <item>transferType.fields.action.new</item>
            <item>transferType.fields.title.list</item>
            <item>transferType.fixedDestinationMember.name</item>
            <item>transferType.fixedDestinationMember.username</item>
            <item>webshop.payment.descriptionText</item>
            <item>serviceOperation.DO_PAYMENT</item>
            <item>serviceOperation.RECEIVE_PAYMENT</item>
        </new-translation-keys>

        <removed-translation-keys>
            <item>certification.qualification</item>
            <item>certification.qualification.GOOD</item>
            <item>certification.qualification.INSUFFICIENT</item>
            <item>certification.qualification.NOT_APPLICABLE</item>
            <item>certification.qualification.VERY_GOOD</item>
            <item>changeGroup.operator.changed=El</item>
            <item>customField.loan.showInSearch</item>
            <item>customField.title.order.loan</item>
            <item>guarantee.identifier</item>
            <item>guarantee.status.EXPIRED</item>
            <item>permission.adminMemberGuarantees.cancelPaymentObligationsAsMember</item>
            <item>permission.adminMemberGuarantees.processGuaranteeLoans</item>
            <item>permission.adminMemberGuarantees.requestGuarantees</item>
            <item>settings.access.virtualKeyboard</item>
            <item>serviceOperation.PAYMENT</item>
        </removed-translation-keys>

        <statements database="mysql">
            <item>alter table transaction_fees add column from_member_id integer</item>
            <item>alter table transaction_fees add column to_member_id integer</item>
            <item>alter table transaction_fees add index FK1E50E66E823FB102 (from_member_id), add constraint FK1E50E66E823FB102 foreign key (from_member_id) references members (id)</item>
            <item>alter table transaction_fees add index FK1E50E66E9DCA1693 (to_member_id), add constraint FK1E50E66E9DCA1693 foreign key (to_member_id) references members (id)</item>
            <item>alter table groups add column container_url varchar(100)</item>
            <item>alter table group_filters add column container_url varchar(100)</item>
            <item>alter table custom_fields add column val_class varchar(256)</item>
            <item>alter table transfer_types add column fixed_destination_member_id integer</item>
            <item>alter table transfer_types add index FK76C39725C41609DB (fixed_destination_member_id), add constraint FK76C39725C41609DB foreign key (fixed_destination_member_id) references members (id)</item>
            <item>alter table custom_fields add column payment_search_access char(1)</item>
            <item>alter table custom_fields add column payment_list_access char(1)</item>
            <item>alter table custom_fields add column transfer_type_id integer</item>
            <item>alter table custom_fields add index FK2EE15F47A4766B0A (transfer_type_id), add constraint FK2EE15F47A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table custom_field_values add column scheduled_payment_id integer</item>
            <item>alter table custom_field_values add column transfer_id bigint</item>
            <item>alter table custom_field_values add column invoice_id integer</item>
            <item>alter table custom_field_values add column guarantee_id integer</item>
            <item>alter table custom_field_values add index FK8AE18A15B3A79238 (scheduled_payment_id), add constraint FK8AE18A15B3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
            <item>alter table custom_field_values add index FK8AE18A152F78F3B3 (transfer_id), add constraint FK8AE18A152F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>alter table custom_field_values add index FK8AE18A15E9B959A1 (invoice_id), add constraint FK8AE18A15E9B959A1 foreign key (invoice_id) references invoices (id)</item>
            <item>alter table custom_field_values add index FK8AE18A1529C0E817 (guarantee_id), add constraint FK8AE18A1529C0E817 foreign key (guarantee_id) references guarantees (id)</item>
            <item>create table transfer_types_linked_custom_fields (transfer_type_id integer not null, field_id integer not null) ENGINE=InnoDB</item>
            <item>alter table transfer_types_linked_custom_fields add index FKC990947BA4766B0A (transfer_type_id), add constraint FKC990947BA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table transfer_types_linked_custom_fields add index FKC990947B9C156375 (field_id), add constraint FKC990947B9C156375 foreign key (field_id) references custom_fields (id)</item>
            <item>alter table guarantees drop column identifier</item>
            <item>insert into settings (type, name, value) select type, 'virtualKeyboardTransactionPassword', value from settings where name = 'virtualKeyboard' and not exists (select 1 from settings where name='virtualKeyboardTransactionPassword')</item>
            <item>alter table custom_field_possible_values add column is_enabled bit default true not null</item>
            <item>alter table certifications drop qualification</item>
            <item>delete from files where type='H'</item>
        </statements>
        
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.LoanCustomFieldMigration" />
    
    </version>

    <version label="3.5_RC1a">
        <enhancements>
            <item>Now, the src directory under the main distribution file contains all source artifacts, including xml and property files, including the CyclosSetup_??.properties translation files</item>
        </enhancements>
        
        <bug-fixes>
            <item>A build problem made the software unusable for browsers other than firefox</item>
            <item>The link on the mail for confirming the public registration was poiting to the server root url, not the validation url</item>
            <item>The login from external web sites was having a javscript problem when nested within multiple iframes</item>
        </bug-fixes>
    </version>

    <version label="3.5_RC1">
        <enhancements>
            <item>Now, it is possible to add a form to login in cyclos on external web sites. For more details, http://project.cyclos.org/wiki/index.php?title=Login_from_web_sites</item>
            <item>Added the #link# variable to password reset and activation mails as well</item>
            <item>Now member record types accessible to brokers which are also checked as 'show in menu' are displayed on the menu for brokers (not only admins)</item>
            <item>When changing the application language on the local settings, mail and message translations are reloaded as well</item>
        </enhancements>

        <bug-fixes>
            <item>The WebShop WebService's get() method worked only once per session (thanks to barnaby)</item>
            <item>Fixed some special cases where unnecessary data was being generated on payments with volume account fees</item>
            <item>Now unquoted line breaks are correctly handled in CSV imports (thanks to Norbert Knapp)</item>
            <item>Under rare circumstances, an error was generated when changing a member's group</item>
            <item>Accessing the public member registration url when logged in was generating an error. Now it just redirects back to home</item>
            <item>Empty lines in external transactions imports were generating errors</item>
            <item>After logging out when the login page was customized, the login page displayed was the global page, not the one the user had seen on start</item>
            <item>On external accounts (bookkeeping), payment whose type's action is 'ignore' are processed when checked, and when manually editing them, the member is no longer required</item>
            <item>Fixed a bug related to the creation of user records whose type were not editable</item>
            <item>Users could view details of transactions of other users modifying the URL, that is not possible anymore</item>
            <item>Sorted helps alphabetically on the manual</item>
            <item>On external accounts, the transaction summary was not correct</item>
            <item>After processing payments on external account history, the select box for applying actions was not usable anymore</item>
        </bug-fixes>
    </version>

    <version label="3.5_beta4">
        <enhancements>
            <item>Upgraded to the latest versions of some used java libraries: Hibernate, Hibernate Search, Apache CXF and MySQL Connector/J</item>
            <item>Now the account fee charging uses less CPU, but takes longer to charge members. This, however, is useful to avoid the server to be over loaded</item>
            <item>Enumerated custom fields which are displayed as select boxes always have an empty option, to make the user to actually select something meaninful, even when it's required</item>
            <item>Now operators also see a both status and quick access windows in their home page</item>
            <item>Web service client address now resolves either ip or hostname</item>
            <item>Added another filter for system account history search: groups and group filters</item>
            <item>Now the account history export has a column for the payment type</item>
            <item>An user can no longer change password or pin to a password he had used in past, which is more secure</item>
            <item>Now on the external account file mapping, the negative amount field may be set to a text, not only a single character</item>
            <item>Now, when importing external transfers and the file had an ivalid value, a more detailed error message is shown</item>
        </enhancements>

        <bug-fixes>
            <item>Statistics on ads also counted deleted ads. Fixed.</item>
            <item>Fixed some memory leaks that made it practically impossible to charge an account fee when there are too much members</item>
            <item>Fixed some problems in broker commission contracts</item>
            <item>Unknown columns in import files for members / ads was giving an unknown error for each member</item>
            <item>A member record type could never be removed, even if there were no records</item>
            <item>Member record type fields were not using the broker access property, making brokers always being able to edit fields</item>
            <item>Under some circumstances, a permission denied was given to a broker trying to view the profile of a pending brokered member</item>
            <item>A broker could see payments to authorize that were not for himself on the 'to authorize' menu. However, there was an error when entering on the payment details</item>
            <item>When a system image was updated, it's cache were not, so when clicking the icon, the popup was always showing the first previewed version</item>
            <item>Member couldn't be permanently removed, even if they had no active accounts</item>
            <item>After invalid login attempt in quick payment or posweb, the user was redirected to the normal login page</item>
            <item>After saving a reference, the back button led to the logged user's references, not to the member receiving the reference</item>
            <item>Now, line breaks inside quotes are successfully imported</item>
            <item>An error was being generated when selecting to show either broker name or username on the member transaction report</item>
            <item>There was an error when a member was trying to remove a general reference he had given to someone else</item>
            <item>An admin viewing a member's references, when entering the details, the back button was going to the other member's profile</item>
            <item>Now both total and score are shown on a member's references. Also for given references.</item>
            <item>When using multiple currencies, the current state report was summing the value of loans and invoices from all currencies</item>
            <item>Error / blank page when removing system / member alerts</item>
            <item>Viewing a member's references from the last 30 days always was always showing 0 results</item>
            <item>A broker couldn't cancel invoices he had sent to his members</item>
            <item>Printing advertisements might yield an error when ads had multiple category levels</item>
            <item>When there are multiple currencies, the edit advertisement page always was always showing the first currency</item>
            <item>Error performing payments when there was a disabled volume account fee</item>
            <item>When editing an advertisement of a member whose external publication is hidden, the layout might broke when the ad had several images</item>
            <item>When saving an external account details, the existing file mapping was lost</item>
            <item>On the transaction details, after printing a transaction, the back button was resulting in error</item>
            <item>Fixed a layout issue on a payment details, where the parent payment had an extra and invalid column</item>
            <item>Under public registration and other circumstances, the notification e-mail for admins were not sent</item>
            <item>Now, e-mails are validated accepting all characters according to the RFC (http://en.wikipedia.org/wiki/E-mail_address)</item>
            <item>On activation e-mails, the #system_name# variable was not being replaced by the actual Application name setting</item>
        </bug-fixes>
        
        <statements database="mysql">
            <item>alter table service_clients add column hostname varchar(100)</item>
            <item>update service_clients set hostname = address where hostname is null</item>
            <item>create table password_history (id integer not null auto_increment, user_id integer not null, date date not null, type varchar(1) not null, password varchar(64) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table password_history add index FKF16E7AF0A19267FC (user_id), add constraint FKF16E7AF0A19267FC foreign key (user_id) references users (id)</item>
            <item>alter table file_mappings modify negative_amount_value varchar(50)</item>
        </statements> 
    </version>
    
    <version label="3.5_beta3">
        <enhancements>
            <item>Added the member and advertisement import functions</item>
            <item>The default upload limit is now 5MB (previously, it was 80KB)</item>
            <item>The previous "Suspend commission" is now "Stop commission". It was created a new "Suspend commission" with other semantic.</item>
        </enhancements>

        <bug-fixes>
            <item>Changed the web services to only return enabled members</item>
            <item>Added a hack to make some pages work under Apache Tomcat 6.0.18, which has a bug (not present until 6.0.16)</item>
            <item>Fixed the external transfer import, which was broken</item>
        </bug-fixes>

        <statements database="mysql">
            <item>create table member_imports (id integer not null auto_increment, by_id integer not null, date datetime not null, group_id integer not null, account_type_id integer, initial_credit_transfer_type_id integer, initial_debit_transfer_type_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table imported_members (id integer not null auto_increment, import_id integer not null, status varchar(50) not null, line_number integer, error_argument1 varchar(200), error_argument2 varchar(200), name varchar(100), username varchar(64), password varchar(64), email varchar(100), credit_limit decimal(15,6), upper_credit_limit decimal(15,6), initial_balance decimal(15,6), primary key (id)) ENGINE=InnoDB</item>
            <item>create table imported_member_records (id integer not null auto_increment, imported_member_id integer, member_record_type_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table ad_imports (id integer not null auto_increment, by_id integer not null, date datetime not null, currency_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table imported_ad_categories (id integer not null auto_increment, ad_import_id integer not null, existing_parent_id integer, imported_parent_id integer, name varchar(100), primary key (id)) ENGINE=InnoDB</item>
            <item>create table imported_ads (id integer not null auto_increment, import_id integer not null, line_number integer, status varchar(50) not null, error_argument1 varchar(200), error_argument2 varchar(200), existing_category_id integer, imported_category_id integer, owner_id integer, permanent bit not null, external_publication bit not null, title varchar(100), trade_type varchar(1), price decimal(15,6), publication_start date, publication_end date, description text, is_html bit not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table custom_field_values add column imported_member_id integer</item>
            <item>alter table custom_field_values add column imported_member_record_id integer</item>
            <item>alter table custom_field_values add column imported_ad_id integer</item>
            <item>alter table custom_field_values add index FK8AE18A1581B2B280 (imported_member_id), add constraint FK8AE18A1581B2B280 foreign key (imported_member_id) references imported_members (id)</item>
            <item>alter table custom_field_values add index FK8AE18A15EA75B58B (imported_member_record_id), add constraint FK8AE18A15EA75B58B foreign key (imported_member_record_id) references imported_member_records (id)</item>
            <item>alter table custom_field_values add index FK8AE18A15A71C13E9 (imported_ad_id), add constraint FK8AE18A15A71C13E9 foreign key (imported_ad_id) references imported_ads (id)</item>            
            <item>alter table imported_member_records add index FK579F7038E46288C5 (member_record_type_id), add constraint FK579F7038E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table imported_member_records add index FK579F703881B2B280 (imported_member_id), add constraint FK579F703881B2B280 foreign key (imported_member_id) references imported_members (id)</item>
            <item>alter table imported_members add index FKF8A856DE731AC71 (import_id), add constraint FKF8A856DE731AC71 foreign key (import_id) references member_imports (id)</item>
            <item>alter table member_imports add index FKF21FF8C9123F9A53 (by_id), add constraint FKF21FF8C9123F9A53 foreign key (by_id) references members (id)</item>
            <item>alter table member_imports add index FKF21FF8C9C2D40D5B (account_type_id), add constraint FKF21FF8C9C2D40D5B foreign key (account_type_id) references account_types (id)</item>
            <item>alter table member_imports add index FKF21FF8C9A824C958 (initial_debit_transfer_type_id), add constraint FKF21FF8C9A824C958 foreign key (initial_debit_transfer_type_id) references transfer_types (id)</item>
            <item>alter table member_imports add index FKF21FF8C9797D2395 (initial_credit_transfer_type_id), add constraint FKF21FF8C9797D2395 foreign key (initial_credit_transfer_type_id) references transfer_types (id)</item>
            <item>alter table member_imports add index FKF21FF8C9B45926EE (group_id), add constraint FKF21FF8C9B45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table ad_imports add index FK79EBE152C0E7F6FA (currency_id), add constraint FK79EBE152C0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <item>alter table ad_imports add index FK79EBE152123F9A53 (by_id), add constraint FK79EBE152123F9A53 foreign key (by_id) references members (id)</item>
            <item>alter table imported_ad_categories add index FKFC5711BDA69BAAC3 (existing_parent_id), add constraint FKFC5711BDA69BAAC3 foreign key (existing_parent_id) references ad_categories (id)</item>
            <item>alter table imported_ad_categories add index FKFC5711BDB79265E7 (ad_import_id), add constraint FKFC5711BDB79265E7 foreign key (ad_import_id) references ad_imports (id)</item>
            <item>alter table imported_ad_categories add index FKFC5711BDA7E88FA0 (imported_parent_id), add constraint FKFC5711BDA7E88FA0 foreign key (imported_parent_id) references imported_ad_categories (id)</item>
            <item>alter table imported_ads add index FKA3AAB0F5FCABEF03 (import_id), add constraint FKA3AAB0F5FCABEF03 foreign key (import_id) references ad_imports (id)</item>
            <item>alter table imported_ads add index FKA3AAB0F541A07D8C (imported_category_id), add constraint FKA3AAB0F541A07D8C foreign key (imported_category_id) references imported_ad_categories (id)</item>
            <item>alter table imported_ads add index FKA3AAB0F5D45742EF (existing_category_id), add constraint FKA3AAB0F5D45742EF foreign key (existing_category_id) references ad_categories (id)</item>
            <item>alter table imported_ads add index FKA3AAB0F5FE01A09E (owner_id), add constraint FKA3AAB0F5FE01A09E foreign key (owner_id) references members (id)</item>
            
            <item>alter table external_transfers add column account_id integer</item>
            <item>alter table external_transfers add index FKB8B2A274EAEDFACC (account_id), add constraint FKB8B2A274EAEDFACC foreign key (account_id) references external_accounts (id)</item>
            <item>update external_transfers set account_id = (select min(id) from external_accounts)</item>
            <item>alter table external_transfers modify column account_id integer not null</item>
            
            <item>alter table default_broker_commissions add column suspended boolean not null default 0</item>
            <item>alter table broker_commission_contracts add column status_before_suspension varchar(1)</item>
        </statements>
    </version>

    <version label="3.5_beta2">
        <enhancements>
            <item>Now, by default, the transaction feed back is enabled on both trade transfer and mobile trade transfer in default database</item>
            <item>Now, by default, the rich text format is enabled (but there's the option to use plain text) on advertisements and messages</item>
            <item>Now, when Cyclos is running on HTTPS, web services requests to regular HTTP port are being denied</item>
            <item>Now the full-text index rebuilding, which is memory and time consuming has a setting for the time between runs, instead of running every day</item>
            <item>A link to generate a new captcha image on the public member registration was added</item>
            <item>Added a separated message type for notifying members about performed payments on external channels</item>
            <item>Made the web services more 'php-friendly'</item>
            <item>Now, a payment type which was previously authorized may be set as not authorized, as long as there are no pending payments</item>
            <item>It's now possible to deactivate a category with active advertisements. However, those advertisements won't be visible through categories</item>
            <item>Joined the authorized payments and account history, adding a select field for status in account history</item>
            <item>Joined the authorized loans and search loans, adding a select field for status in account history</item>
            <item>Improved the advertisement category registry, both using a more intuitive layout, and allowing registering several categories at once</item>
        </enhancements>
        
        <bug-fixes>
            <item>An administrator viewing a regular member profile had options that only should be displayed for brokers</item>
            <item>After errors on posweb access, an invalid page was shown</item>
            <item>Preserved the pin length when saving groups without channels that use pin</item>
            <item>Under some circumstances, an application error was being generated when logging a system to member payment</item>
            <item>On the send invoice from member to member as admin, when selecting a destination member, the back button was leading to that member, not the original one</item>
            <item>In order to keep consistency with other account configuration elements, when registering a new account fee, by default, it will be disabled</item>
            <item>Neither title nor help icon were being displayed on web services client list when the list was empty</item>
            <item>When uploading images that were extremely tall and thin, or wide and short, an application error was being generated</item>
            <item>When saving a loan transfer type, some relationships with loan repayment transfer types were silently generated, which could lead into problems when trying to remove those transfer types</item>
            <item>The member group settings to view / repay loans by other loan group members were being ignored</item>
            <item>It was possible for an administrator to set a broker as his own broker</item>
            <item>Under some circumstances, it was possible that two opened menu items were being shown at the same time</item>
            <item>When creating an authorization level for a system payment type, unlogical options were being shown</item>
            <item>Under some circumstances, inactive advertisement categories were being show on the new advertisement page</item>
            <item>The 'max images per member' group setting was being used for advertisement images also, instead of using the correct setting, 'max advertisement images per member'</item>
            <item>When there was an error while sending the registration validation e-mail, an ugly error stack trace was being displayed for the user</item>
            <item>After disconnecting an user through his profile, the page displayed was not the profile again</item>
            <item>On payment types registration, the availability select (with options disabled, payment to others and payment to self) was replaced by a clearer 'enabled' checkbox, on payments where only 2 of those options make sense (like member to system)</item>
            <item>Now, when inserting a payment type from a member account, the main web channel is pre-selected</item>
            <item>After wrong username / password login attempt as operator, when going back to login page, the login as operator will be enabled again</item>
            <item>Payments from member profile were not taking payment type's "allows scheduled payments" settings in account</item>
            <item>Payments from member profile with multiple currencies was only allowing one of them</item>
            <item>On payments from external channels, the receiving member was not being notified</item>
            <item>Fixed a problem in payment request from web to external channels</item>
            <item>Admins without permission to authorize a payment were still viewing the fields, even if a permission denied were raised later</item>
            <item>Removed the reset pin button on the external access page, since it can be confusing. The member can still disable channels he don't want</item>
            <item>Images were not being displayed on member search</item>
            <item>When viewing loans of a loan group, all loans were being show, not only those for that loan group</item>
        </bug-fixes>

        <statements database="mysql">
            <item>alter table application add column last_index_rebuilding_time datetime</item>
        </statements>
    </version>
    
    <version label="3.5_beta1">
        <enhancements>
            <item>See the new features list in http://project.cyclos.org/index.php?option=com_content&amp;task=view&amp;id=228&amp;Itemid=224</item>
        </enhancements>
    
        <new-css-classes>
            <item>div.fakeField</item>
            <item>div.fakeFieldDisabled</item>
            <item>ul.categoryLevel0</item>
            <item>ul.categoryLevel1</item>
            <item>ul.categoryLevel2</item>
            <item>li.categoryLevel1</item>
            <item>li.categoryLevel2</item>
            <item>li.categoryLevel3</item>
            <item>span.categoryLevel1Text</item>
            <item>span.categoryLevel2Text</item>
            <item>span.categoryLevel3Text</item>
            <item>span.categoryLevel1TextHover</item>
            <item>span.categoryLevel2TextHover</item>
            <item>span.categoryLevel3TextHover</item>
            <item>.tdPrintDataBold</item>
            <item>span.manualTitle</item>
            <item>div.manual h1</item>
            <item>div.manual h2</item>
            <item>div.manual h3</item>
        </new-css-classes>

        <statements database="mysql">
        
            <item>update settings set value='es_ES' where name='language' and value='es_ES_TB'</item>

            <!-- previously 3.1_devX -->
            <!-- 1 -->
            <item>alter table custom_fields add member_id integer</item>
            <item>alter table custom_fields add operator_id integer</item>
            <item>alter table custom_fields add operator_visibility varchar(1)</item>
            <item>alter table custom_field_values add operator_id integer</item>
            <item>alter table groups add member_id integer</item>
            <item>alter table members add member_id integer</item>
            <item>alter table transfers add receiver_id integer</item>
            <item>create table operator_groups_max_amount (group_id integer not null, amount numeric(15,6) not null, transfer_type_id integer not null, primary key (group_id, transfer_type_id)) ENGINE=InnoDB</item>
            <item>alter table custom_field_values add index FK8AE18A1573D9F3D7 (operator_id), add constraint FK8AE18A1573D9F3D7 foreign key (operator_id) references members (id)</item>
            <item>alter table custom_fields add index FK2EE15F47EAE0AB57 (member_id), add constraint FK2EE15F47EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table groups add index FKB63DD9D4EAE0AB57 (member_id), add constraint FKB63DD9D4EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table members add index FK388EC919EAE0AB57 (member_id), add constraint FK388EC919EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table operator_groups_max_amount add index FK14F01003A4766B0A (transfer_type_id), add constraint FK14F01003A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table operator_groups_max_amount add index FK14F0100363FBF3A4 (group_id), add constraint FK14F0100363FBF3A4 foreign key (group_id) references groups (id)</item>
            <item>alter table transfers add index FK3EBE45E8A822302A (receiver_id), add constraint FK3EBE45E8A822302A foreign key (receiver_id) references members (id)</item>
            <item>alter table users drop index username</item>
            <!-- 2 -->
            <item>alter table groups add transaction_password_length integer not null default 4</item>
            <!-- 3 -->
            <item>create table external_accounts (id integer not null auto_increment, name varchar(50) not null, description text, member_account_id integer not null, system_account_id integer not null, file_mapping_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table external_transfer_imports (id integer not null auto_increment, date datetime not null, by_id integer not null, account_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table external_transfer_types (id integer not null auto_increment, account_id integer not null, code varchar(20) not null, name varchar(50) not null, action varchar(1) not null, transfer_type_id integer, description text, primary key (id), unique (account_id, code)) ENGINE=InnoDB</item>
            <item>create table external_transfers (id integer not null auto_increment, status varchar(1) not null, date date, amount numeric(15,6), type_id integer, import_id integer, member_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table field_mappings (id integer not null auto_increment, order_index integer not null, name varchar(50) not null, field varchar(2) not null, file_mapping_id integer not null, member_field_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>create table file_mappings (id integer not null auto_increment, subclass varchar(3) not null, account_id integer not null, date_format varchar(20), number_format varchar(1), decimal_places integer, decimal_separator char(1), negative_amount_value char(1), classname varchar(255), string_quote char(1), column_separator char(1), header_lines integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table external_accounts add index FKE7A59DDAF865E9E2 (file_mapping_id), add constraint FKE7A59DDAF865E9E2 foreign key (file_mapping_id) references file_mappings (id)</item>
            <item>alter table external_accounts add index FKE7A59DDA99B38EF5 (system_account_id), add constraint FKE7A59DDA99B38EF5 foreign key (system_account_id) references account_types (id)</item>
            <item>alter table external_accounts add index FKE7A59DDAE6699C5F (member_account_id), add constraint FKE7A59DDAE6699C5F foreign key (member_account_id) references account_types (id)</item>
            <item>alter table external_transfer_imports add index FK60B0F30E123F9A53 (by_id), add constraint FK60B0F30E123F9A53 foreign key (by_id) references members (id)</item>
            <item>alter table external_transfer_imports add index FK60B0F30EEAEDFACC (account_id), add constraint FK60B0F30EEAEDFACC foreign key (account_id) references external_accounts (id)</item>
            <item>alter table external_transfer_types add index FK20F3219A4766B0A (transfer_type_id), add constraint FK20F3219A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table external_transfer_types add index FK20F3219EAEDFACC (account_id), add constraint FK20F3219EAEDFACC foreign key (account_id) references external_accounts (id)</item>
            <item>alter table external_transfers add index FKB8B2A274EAE0AB57 (member_id), add constraint FKB8B2A274EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table external_transfers add index FKB8B2A2743C9C4AF3 (import_id), add constraint FKB8B2A2743C9C4AF3 foreign key (import_id) references external_transfer_imports (id)</item>
            <item>alter table external_transfers add index FKB8B2A274D64E2913 (type_id), add constraint FKB8B2A274D64E2913 foreign key (type_id) references external_transfer_types (id)</item>
            <item>alter table field_mappings add index FK295A0B0A141FB961 (file_mapping_id), add constraint FK295A0B0A141FB961 foreign key (file_mapping_id) references file_mappings (id)</item>
            <item>alter table field_mappings add index FK295A0B0AF865E9E2 (file_mapping_id), add constraint FK295A0B0AF865E9E2 foreign key (file_mapping_id) references file_mappings (id)</item>
            <item>alter table field_mappings add index FK295A0B0AACBA9282 (member_field_id), add constraint FK295A0B0AACBA9282 foreign key (member_field_id) references custom_fields (id)</item>
            <item>alter table file_mappings add index FK7282A8C8EAEDFACC (account_id), add constraint FK7282A8C8EAEDFACC foreign key (account_id) references external_accounts (id)</item>
            <!-- 4 - 8 nothing -->
            <!-- 9 -->
            <item>alter table transfers add external_transfer_id integer</item>
            <item>alter table transfers add index FK3EBE45E8617A8174 (external_transfer_id), add constraint FK3EBE45E8617A8174 foreign key (external_transfer_id) references external_transfers (id)</item>
            <item>alter table loan_payments add external_transfer_id integer</item>
            <item>alter table loan_payments add index FKAF53099C617A8174 (external_transfer_id), add constraint FKAF53099C617A8174 foreign key (external_transfer_id) references external_transfers (id)</item>
            <!-- 10 nothing -->
            <!-- 11 -->
            <item>alter table transfer_types add conciliable bit(1) not null default false</item>
            <!-- 12 -->
            <item>alter table groups add initial_group_show varchar(100) </item>
            <item>alter table groups add initial_group bit(1) not null default false</item>
            <!-- 13 -->
            <item>update groups set initial_group = true where id = (select value from settings where name = 'initialMemberGroup')</item>
            <item>delete from settings where name = 'initialMemberGroup'</item>
            <!-- 14 -->
            <item>delete from images where subclass = 'sys' and name in ('checked.gif', 'conciliated.gif', 'delete.gif',
            'dropdown.gif', 'edit_gray.gif', 'edit.gif', 'help.gif', 'import.gif', 'incomplete.gif', 'message_read.gif',
            'message_removed.gif', 'message_replied.gif', 'message_unread.gif', 'next.gif', 'pending.gif',
            'permissions_gray.gif', 'permissions.gif', 'preview.gif', 'previous.gif', 'print.gif', 'save.gif', 'view.gif')</item>
            <item>alter table ads add is_html bit(1) not null default false</item>
            <!-- 15 - nothing -->
            <!-- 16 -->
            <item>alter table ad_categories add order_index integer not null default 0</item>
            <item>alter table ad_categories add count_offer integer not null default 0</item>
            <item>alter table ad_categories add count_search integer not null default 0</item>
            <!-- 17 -->
            <item>alter table custom_fields add ad_show_in_search bit(1) not null default false</item>
            <item>update custom_fields set ad_show_in_search = 1 where subclass = 'ad' and ad_search_visibility in ('B', 'A')</item>
            <item>alter table custom_fields drop ad_search_visibility</item>
            <!-- 18 - 19 - nothing -->
            <!-- 20 -->
            <item>create table group_history_logs (id integer not null auto_increment, element_id integer not null, group_id integer not null, start_date datetime not null, end_date datetime, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table group_history_logs add index FKC08E903A47C8C3FD (element_id), add constraint FKC08E903A47C8C3FD foreign key (element_id) references members (id)</item>
            <item>alter table group_history_logs add index FKC08E903A25A5B3E8 (group_id), add constraint FKC08E903A25A5B3E8 foreign key (group_id) references groups (id)</item>
            <!-- 21 -->
            <item>create table admin_alert_notification_preferences (id integer not null auto_increment, subclass varchar(1) not null, preference_id integer, type varchar(70) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table admin_notification_preferences (id integer not null auto_increment, admin_id integer, application_errors bit not null, system_invoices bit not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table admin_preferences_message_categories (preference_id integer not null, message_category_id integer not null, primary key (preference_id, message_category_id)) ENGINE=InnoDB</item>
            <item>create table admin_preferences_transfer_types (preference_id integer not null, transfer_type_id integer not null, primary key (preference_id, transfer_type_id)) ENGINE=InnoDB</item>
            <item>alter table admin_alert_notification_preferences add index FKDB956A17FB43CB21 (preference_id), add constraint FKDB956A17FB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <item>alter table admin_notification_preferences add index FKE4ED5494D2DEA05B (admin_id), add constraint FKE4ED5494D2DEA05B foreign key (admin_id) references members (id)</item>
            <item>alter table admin_preferences_message_categories add index FK4C0418EBFB43CB21 (preference_id), add constraint FK4C0418EBFB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <item>alter table admin_preferences_message_categories add index FK4C0418EBD05BD7A4 (message_category_id), add constraint FK4C0418EBD05BD7A4 foreign key (message_category_id) references message_categories (id)</item>
            <item>alter table admin_preferences_transfer_types add index FKD472F23CA4766B0A (transfer_type_id), add constraint FKD472F23CA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table admin_preferences_transfer_types add index FKD472F23CFB43CB21 (preference_id), add constraint FKD472F23CFB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <!-- 22 - nothing -->
            <!-- 23 -->
            <item>alter table ads add members_notified bit not null default 0</item>
            <item>update ads set members_notified = true where publication_start &lt; current_date()</item>
            <!-- 24 -->
            <item>create table authorization_levels (id integer not null auto_increment, level integer not null, amount numeric(15,6) not null, authorizer varchar(1) not null, type_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>create table admin_group_authorization_level (authorization_id integer not null, group_id integer not null) ENGINE=InnoDB</item>
            <item>create table transfer_authorizations (id bigint not null auto_increment, by_id integer, date datetime not null, action varchar(1) not null, transfer_id bigint not null, level_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table transfer_types add requires_authorization bit not null</item>
            <item>alter table transfers add status varchar(1) not null</item>
            <item>alter table admin_group_authorization_level add index FKBB2E758E3794D57D (group_id), add constraint FKBB2E758E3794D57D foreign key (group_id) references groups (id)</item>
            <item>alter table admin_group_authorization_level add index FKBB2E758EFB6913C5 (authorization_id), add constraint FKBB2E758EFB6913C5 foreign key (authorization_id) references authorization_levels (id)</item>
            <item>alter table authorization_levels add index FK9AAA27F59D63275E (type_id), add constraint FK9AAA27F59D63275E foreign key (type_id) references transfer_types (id)</item>
            <item>alter table transfer_authorizations add index FK2767B1EE2F78F3B3 (transfer_id), add constraint FK2767B1EE2F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>alter table transfer_authorizations add index FK2767B1EE2B1214C2 (by_id), add constraint FK2767B1EE2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table transfer_authorizations add index FK2767B1EE285878DA (level_id), add constraint FK2767B1EE285878DA foreign key (level_id) references authorization_levels (id)</item>
            <item>update transfers set status='O'</item>
            <!-- 25 -->
            <item>alter table transfers add column process_date datetime</item>
            <item>update transfers set process_date = date</item>
            <!-- 26 -->
            <item>alter table member_group_account_settings add column transaction_password_required bit(1) not null default 0</item>
            <item>update member_group_account_settings set transaction_password_required = true where group_id in (select id from groups where subclass='M' and transaction_password in ('A', 'M'))</item>
            <!-- 27 -->
            <item>alter table transfers add column next_authorization_level_id integer</item>
            <item>alter table transfers add index FK3EBE45E84B79F4AC (next_authorization_level_id), add constraint FK3EBE45E84B79F4AC foreign key (next_authorization_level_id) references authorization_levels (id)</item>
            <!-- 28 -->
            <item>alter table transfer_authorizations add column comments text</item>
            <item>alter table transfer_authorizations add column show_to_member boolean not null default 0</item>
            <!-- 29 -->
            <item>create table scheduled_payments (id integer not null auto_increment, from_account_id integer not null, to_account_id integer not null, type_id integer not null, date datetime not null, amount numeric(15,6) not null, status varchar(1) not null, invoice_id integer, by_id integer, process_date datetime, description text, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table transfers add column scheduled_payment_id integer</item>
            <item>alter table invoices add column scheduled_payment_id integer</item>
            <item>create table invoice_payments (id integer not null auto_increment, invoice_id integer, date datetime not null, amount numeric(15,6) not null, transfer_id bigint, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table transfer_types add column allows_scheduled_payments bit(1) not null default 0</item>
            <item>alter table scheduled_payments add index FK943CF27F2B1214C2 (by_id), add constraint FK943CF27F2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table scheduled_payments add index FK943CF27FDD5BFBFE (to_account_id), add constraint FK943CF27FDD5BFBFE foreign key (to_account_id) references accounts (id)</item>
            <item>alter table scheduled_payments add index FK943CF27FE9B959A1 (invoice_id), add constraint FK943CF27FE9B959A1 foreign key (invoice_id) references invoices (id)</item>
            <item>alter table scheduled_payments add index FK943CF27F8799AF6F (from_account_id), add constraint FK943CF27F8799AF6F foreign key (from_account_id) references accounts (id)</item>
            <item>alter table scheduled_payments add index FK943CF27F9D63275E (type_id), add constraint FK943CF27F9D63275E foreign key (type_id) references transfer_types (id)</item>
            <item>alter table invoice_payments add index FK1D3D3FFF2F78F3B3 (transfer_id), add constraint FK1D3D3FFF2F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>alter table invoice_payments add index FK1D3D3FFFE9B959A1 (invoice_id), add constraint FK1D3D3FFFE9B959A1 foreign key (invoice_id) references invoices (id)</item>
            <item>alter table transfers add index FK3EBE45E8B3A79238 (scheduled_payment_id), add constraint FK3EBE45E8B3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
            <item>alter table invoices add index FK25F222E6B3A79238 (scheduled_payment_id), add constraint FK25F222E6B3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
            <!-- 30 -->
            <item>create table admin_preferences_new_pending_payments (preference_id integer not null, transfer_type_id integer not null, primary key (preference_id, transfer_type_id)) ENGINE=InnoDB</item>
            <item>alter table admin_preferences_new_pending_payments add index FKD0252B6BA4766B0A (transfer_type_id), add constraint FKD0252B6BA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table admin_preferences_new_pending_payments add index FKD0252B6BFB43CB21 (preference_id), add constraint FKD0252B6BFB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
            <!-- 31 - nothing -->
            <!-- 32 -->
            <item>alter table groups add column member_max_scheduling_payments integer not null default 0</item>
            <item>alter table groups add column member_max_scheduling_period_number integer</item>
            <item>alter table groups add column member_max_scheduling_period_field integer</item>
            <item>update groups set member_max_scheduling_payments=36, member_max_scheduling_period_number=3, member_max_scheduling_period_field=1 where subclass in ('M', 'B') and status='N'</item>
            <!-- 33 - nothing -->
            <!-- 34 -->
            <item>alter table groups add column member_max_ad_description_size integer not null default 2048</item>
            <item>delete from translation_messages where msg_key in ('errors.lessEquals', 'errors.greaterEquals')</item>
            <!-- 35 -->
            <item>alter table ad_interests add currency_id integer</item>
            <item>alter table ad_interests add index FKD8DBB56DC0E7F6FA (currency_id), add constraint FKD8DBB56DC0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <!-- 36 -->
            <item>create table group_view_account_information_permissions (owner_group_id integer not null, account_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_view_account_information_permissions add index FK25619205461D0C55 (account_type_id), add constraint FK25619205461D0C55</item>
            <item>alter table group_view_account_information_permissions add index FK256192055D14BEFA (owner_group_id), add constraint FK256192055D14BEFA</item>
            <!-- 37 -->
            <item>alter table groups add member_active bit(1) not null default false</item>
            <item>update groups set member_active = true where id in (select group_id from member_group_account_settings)</item>
            <!-- 38 -->
            <item>alter table groups add password_policy char(1) not null default 'O'</item>
            <!-- 39 -->
            <item>create table group_broker_account_information_permissions (owner_group_id integer not null, account_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_broker_account_information_permissions add index FKE9668F39461D0C55 (account_type_id), add constraint FKE9668F39461D0C55 foreign key (account_type_id) references account_types (id)</item>
            <item>alter table group_broker_account_information_permissions add index FKE9668F392E6F411B (owner_group_id), add constraint FKE9668F392E6F411B foreign key (owner_group_id) references groups (id)</item>
            <!-- 40 -->
            <item>create table group_operator_account_information_permissions (owner_group_id integer not null, account_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_operator_account_information_permissions add index FKE831E404461D0C55 (account_type_id), add constraint FKE831E404461D0C55 foreign key (account_type_id) references account_types (id)</item>
            <item>alter table group_operator_account_information_permissions add index FKE831E404CB78BB0 (owner_group_id), add constraint FKE831E404CB78BB0 foreign key (owner_group_id) references groups (id)</item>
            <!-- 41 -->
            <item>create table account_status (id bigint not null auto_increment, subclass varchar(1) not null, account_id integer not null, date datetime not null, root_credits_count integer default 0 not null, root_credits_amount numeric(21,6) default 0 not null, root_debits_count integer default 0 not null, root_debits_amount numeric(21,6) default 0 not null, nested_credits_count integer default 0 not null, nested_credits_amount numeric(21,6) default 0 not null, nested_debits_count integer default 0 not null, nested_debits_amount numeric(21,6) default 0 not null, pending_credits_count integer default 0 not null, pending_credits_amount numeric(15,6) default 0 not null, pending_debits_count integer default 0 not null, pending_debits_amount numeric(15,6) default 0 not null, credit_limit numeric(15,6), upper_credit_limit numeric(15,6), transfer_id bigint, transfer_authorization_id bigint, credit_limit_by_id integer, volume_account_fees numeric(15,6) default 0 not null, account_fee_log_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table account_status add index FK33CFE6442F78F3B3 (transfer_id), add constraint FK33CFE6442F78F3B3 foreign key (transfer_id) references transfers (id)</item>
            <item>alter table account_status add index FK33CFE644108D798A (transfer_authorization_id), add constraint FK33CFE644108D798A foreign key (transfer_authorization_id) references transfer_authorizations (id)</item>
            <item>alter table account_status add index FK33CFE6443317FFBA (account_id), add constraint FK33CFE6443317FFBA foreign key (account_id) references accounts (id)</item>
            <item>alter table account_status add index FK33CFE6441F2F26F8 (credit_limit_by_id), add constraint FK33CFE6441F2F26F8 foreign key (credit_limit_by_id) references members (id)</item>
            <item>alter table account_status add index FK33CFE6446957A5AA (account_fee_log_id), add constraint FK33CFE6446957A5AA foreign key (account_fee_log_id) references account_fee_logs (id)</item>
            <item>create table account_fee_charges (id bigint not null auto_increment, period_start datetime not null, period_end datetime not null, available_balance numeric(18,6) not null, amount numeric(15,6) not null, account_id integer not null, account_fee_log_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table account_fee_charges add index FKEA7E8D748AD473C0 (account_id), add constraint FKEA7E8D748AD473C0 foreign key (account_id) references accounts (id)</item>
            <item>alter table account_fee_charges add index FKEA7E8D746957A5AA (account_fee_log_id), add constraint FKEA7E8D746957A5AA foreign key (account_fee_log_id) references account_fee_logs (id)</item>
            <item>alter table application add column account_status_enabled_since date</item>
            <item>update application set account_status_enabled_since = current_date()</item>
            <!-- 42 -->
            <item>create table binary_files (id integer not null auto_increment, content_type varchar(100) not null, size integer not null, last_modified datetime not null, contents mediumblob not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table documents add column subclass varchar(1) not null</item>
            <item>alter table documents add column binary_file_id integer</item>
            <item>alter table documents add index FK383D52B8FF98BF58 (binary_file_id), add constraint FK383D52B8FF98BF58 foreign key (binary_file_id) references binary_files (id)</item>
            <item>update documents set subclass='D'</item>
            <!-- 43 - 45 - nothing -->
            <!-- 46 -->
            <item>alter table messages add column removed_at datetime</item>
            <item>update messages set removed_at = current_date() where is_removed = 1</item>
            <item>alter table messages drop is_removed</item>
            <!-- 47 -->
            <item>alter table transaction_fees add column initial_amount numeric(15,6)</item>
            <item>alter table transaction_fees add column final_amount numeric(15,6)</item>
            <!-- 48 -->
            <item>update settings set value=replace(value, '#units#', '#amount#')</item>
            <!-- 49 -->
            <item>alter table images drop index ix_subclass</item>
            <item>alter table account_fee_logs drop index fk_account_fee</item>
            <item>alter table account_fees drop index fk_account_type</item>
            <item>alter table account_fees drop index fk_transfer_type</item>
            <item>alter table account_types drop index fk_system_account</item>
            <item>alter table account_types drop index fk_currency</item>
            <item>alter table accounts drop index fk_type</item>
            <item>alter table accounts drop index fk_owner</item>
            <item>alter table ad_categories drop index fk_parent</item>
            <item>alter table ad_interests drop index fk_member</item>
            <item>alter table ad_interests drop index fk_category</item>
            <item>alter table ad_interests drop index fk_owner</item>
            <item>alter table ad_interests drop index fk_group_filter</item>
            <item>alter table ads drop index fk_category</item>
            <item>alter table ads drop index fk_currency</item>
            <item>alter table ads drop index fk_owner</item>
            <item>alter table alerts drop index fk_member</item>
            <item>alter table brokerings drop index fk_broker</item>
            <item>alter table brokerings drop index fk_brokered</item>
            <item>alter table contacts drop index fk_owner</item>
            <item>alter table contacts drop index fk_contact</item>
            <item>alter table custom_field_possible_values drop index fk_field</item>
            <item>alter table custom_field_values drop index fk_field</item>
            <item>alter table custom_field_values drop index fk_member</item>
            <item>alter table custom_field_values drop index fk_loan_group</item>
            <item>alter table custom_field_values drop index fk_possible_value</item>
            <item>alter table custom_field_values drop index fk_ad</item>
            <item>alter table custom_field_values drop index fk_admin</item>
            <item>alter table custom_field_values drop index fk_loan</item>
            <item>alter table documents drop index fk_document_page</item>
            <item>alter table documents drop index fk_form_page</item>
            <item>alter table error_log_entries drop index fk_logged_user</item>
            <item>alter table files drop index fk_group</item>
            <item>alter table files drop index fk_document</item>
            <item>alter table groups drop index fk_initial_group</item>
            <item>alter table images drop index fk_member</item>
            <item>alter table images drop index fk_ad</item>
            <item>alter table invoices drop index fk_performed_by</item>
            <item>alter table invoices drop index fk_to</item>
            <item>alter table invoices drop index fk_account_fee_log</item>
            <item>alter table invoices drop index fk_sent_by</item>
            <item>alter table invoices drop index fk_transfer</item>
            <item>alter table invoices drop index fk_transfer_type</item>
            <item>alter table invoices drop index fk_from</item>
            <item>alter table invoices drop index fk_dest_type</item>
            <item>alter table loan_payments drop index fk_loan</item>
            <item>alter table loans drop index fk_loan_group</item>
            <item>alter table loans drop index fk_transfer</item>
            <item>alter table login_history drop index fk_user</item>
            <item>alter table member_group_account_settings drop index fk_group</item>
            <item>alter table member_group_account_settings drop index fk_initial_transfer_type</item>
            <item>alter table member_group_account_settings drop index fk_account_type</item>
            <item>alter table members drop index fk_group</item>
            <item>alter table members drop index fk_broker</item>
            <item>alter table messages drop index fk_category</item>
            <item>alter table messages drop index fk_to</item>
            <item>alter table messages drop index fk_from</item>
            <item>alter table notification_preferences drop index fk_member</item>
            <item>alter table operations drop index fk_module</item>
            <item>alter table payment_filters drop index fk_account_type</item>
            <item>alter table reference_history drop index fk_to</item>
            <item>alter table reference_history drop index fk_from</item>
            <item>alter table refs drop index fk_to</item>
            <item>alter table refs drop index fk_from</item>
            <item>alter table remarks drop index fk_new</item>
            <item>alter table remarks drop index fk_old</item>
            <item>alter table remarks drop index fk_owner</item>
            <item>alter table tickets drop index fk_to</item>
            <item>alter table tickets drop index fk_from</item>
            <item>alter table transaction_fees drop index fk_generated</item>
            <item>alter table transaction_fees drop index fk_original</item>
            <item>alter table transfer_types drop index fk_loan_ef_rt</item>
            <item>alter table transfer_types drop index fk_loan_mi_rt</item>
            <item>alter table transfer_types drop index fk_loan_edi_rt</item>
            <item>alter table transfer_types drop index fk_to</item>
            <item>alter table transfer_types drop index fk_loan_repayment_type</item>
            <item>alter table transfer_types drop index fk_from</item>
            <item>alter table transfer_types drop index fk_loan_gf_rt</item>
            <item>alter table transfers drop index fk_to</item>
            <item>alter table transfers drop index fk_account_fee_log</item>
            <item>alter table transfers drop index fk_loan_payment</item>
            <item>alter table transfers drop index fk_type</item>
            <item>alter table transfers drop index fk_transaction_fee</item>
            <item>alter table transfers drop index fk_by</item>
            <item>alter table transfers drop index fk_parent</item>
            <item>alter table transfers drop index fk_from</item>
            <!-- 50 -->
            <item>alter table groups add column registration_agreement text</item>
            <!-- 51 -->
            <item>alter table custom_field_values add column general_remark_id integer</item>
            <item>alter table custom_field_values add index FK8AE18A15FEF13EF3 (general_remark_id), add constraint FK8AE18A15FEF13EF3 foreign key (general_remark_id) references remarks (id)</item>
            <!-- 52 -->
            <item>create table member_groups_message_types (group_id integer not null, type varchar(3) not null) ENGINE=InnoDB</item>
            <item>alter table member_groups_message_types add index FK348B579BB45926EE (group_id), add constraint FK348B579BB45926EE foreign key (group_id) references groups (id)</item>
            <!-- 53 -->
            <item>alter table files add column group_filter_id integer</item>
            <item>alter table files add index FK5CEBA779D46A867 (group_filter_id), add constraint FK5CEBA779D46A867 foreign key (group_filter_id) references group_filters (id)</item>
            <!-- 54 -->
            <item>alter table groups add column login_page_name varchar(20)</item>
            <item>create index ix_login_page_name on groups (login_page_name)</item>
            <item>alter table group_filters add column login_page_name varchar(20)</item>
            <item>create index ix_login_page_name on group_filters (login_page_name)</item>
            <item>update settings set value='5' where name='maxUploadSize'</item>
            <item>update settings set value='MEGA_BYTES' where name='maxUploadUnits'</item>
            <!-- 55 -->
            <item>alter table groups add column member_email_validation bit(1) not null default 0</item>
            <!-- 56 -->
            <item>alter table application add column password_hash char(1) not null default 'M'</item>
            <item>alter table users modify column password char(64)</item>
            <item>alter table users modify column transaction_password char(64)</item>
            <!-- 57 -->
            <item>alter table documents add column member_id integer</item>
            <item>alter table documents add column visibility varchar(1)</item>
            <item>alter table documents add index FK383D52B8EAE0AB57 (member_id), add constraint FK383D52B8EAE0AB57 foreign key (member_id) references members (id)</item>
            <!-- 58 -->
            <item>delete from permissions where operation_id in (select op.id from operations op where op.message_key in ('permission.systemDocuments.view', 'permission.systemDocuments.manage'))</item>
            <item>delete from operations where message_key in ('permission.systemDocuments.view', 'permission.systemDocuments.manage')</item>
            <item>delete from modules where name = 'systemDocuments'</item>
            <item>delete from permissions where operation_id in (select op.id from operations op where op.message_key = 'permission.adminMemberDocuments.view')</item>
            <item>delete from operations where message_key = 'permission.adminMemberDocuments.view'</item>
            <item>delete from translation_messages where msg_key='permission.adminMemberDocuments.view'</item>
    
            <!-- 3.5_dev1 -->
      
            <!-- 3.5_dev1.5 -->
    
            <!-- 3.5_dev2 -->
        
            <!-- 3.5_dev3 -->
            <item>alter table groups add column member_enable_permanent_ads bit default false not null</item>
            <item>alter table groups add column member_external_ad_publication varchar(1)</item>
            <item>update groups set member_enable_permanent_ads=true, member_external_ad_publication='C' where subclass in ('M', 'B')</item>
      
            <!-- 3.5_dev4 -->
      
            <!-- 3.5_dev5 -->
      
            <!-- 3.5_dev6 -->
      
            <!-- 3.5_dev7 -->
            <item>update settings set value='UTF-8' where name='charset'</item>
            <item>update files set last_modified = last_modified + interval 1 second where last_modified is not null</item>
    
            <!-- 3.5_dev8 -->
            <item>create table member_record_types (id integer not null auto_increment, name varchar(100) not null, label varchar(100) not null, editable bit not null, show_menu_item bit not null, layout varchar(1) not null, description text, primary key (id)) ENGINE=InnoDB</item>
            <item>create table groups_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>create table admin_groups_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>create table broker_groups_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>create table member_records (id integer not null auto_increment, member_record_type_id integer not null, element_id integer not null, by_id integer not null, modified_by_id integer, date datetime not null, last_modified datetime, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table admin_groups_member_record_types add index FKDF862095E46288C5 (member_record_type_id), add constraint FKDF862095E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_member_record_types add index FKDF8620953794D57D (group_id), add constraint FKDF8620953794D57D foreign key (group_id) references groups (id)</item>
            <item>alter table broker_groups_member_record_types add index FK19FC25CBE46288C5 (member_record_type_id), add constraint FK19FC25CBE46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table broker_groups_member_record_types add index FK19FC25CB85B3A90F (group_id), add constraint FK19FC25CB85B3A90F foreign key (group_id) references groups (id)</item>
            <item>alter table custom_field_values add column member_record_id integer</item>
            <item>alter table custom_field_values add index FK8AE18A15726DC538 (member_record_id), add constraint FK8AE18A15726DC538 foreign key (member_record_id) references member_records (id)</item>
            <item>alter table custom_fields add column member_record_type_id integer</item>
            <item>alter table custom_fields add index FK2EE15F47E46288C5 (member_record_type_id), add constraint FK2EE15F47E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table custom_fields add column record_broker_access varchar(1)</item>
            <item>alter table custom_fields add column record_show_in_search bit default 0 not null</item>
            <item>alter table custom_fields add column record_show_in_list bit default 0 not null</item>
            <item>alter table groups_member_record_types add index FK201F85A5E46288C5 (member_record_type_id), add constraint FK201F85A5E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table groups_member_record_types add index FK201F85A525A5B3E8 (group_id), add constraint FK201F85A525A5B3E8 foreign key (group_id) references groups (id)</item>
            <item>alter table member_records add index FKBFDA159D2B1214C2 (by_id), add constraint FKBFDA159D2B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table member_records add index FKBFDA159DE46288C5 (member_record_type_id), add constraint FKBFDA159DE46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table member_records add index FKBFDA159D47C8C3FD (element_id), add constraint FKBFDA159D47C8C3FD foreign key (element_id) references members (id)</item>
            <item>alter table member_records add index FKBFDA159D41B97FCC (modified_by_id), add constraint FKBFDA159D41B97FCC foreign key (modified_by_id) references members (id)</item>
      
            <!-- 3.5_dev9 -->
      
            <!-- 3.5_dev10 -->
            <item>create table admin_groups_admin_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_admin_record_types add index FKC4790156E46288C5 (member_record_type_id), add constraint FKC4790156E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_admin_record_types add index FKC47901563794D57D (group_id), add constraint FKC47901563794D57D foreign key (group_id) references groups (id)</item>
      
            <!-- 3.5_dev11 -->
      
            <!-- 3.5_dev12 -->
            <item>alter table transaction_fees add column max_amount numeric(15,6)</item>
            <item>alter table transaction_fees add column max_amount_type char(1)</item>
      
            <!-- 3.5_dev13 -->
            <item>update transaction_fees set who_pays='S' where subclass='B'</item>
            <item>alter table transaction_fees add column all_broker_groups bit not null default 0</item>
            <item>create table broker_groups_transaction_fees (transaction_fee_id integer not null, group_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_groups_transaction_fees add index FK8E3E9313B45926EE (group_id), add constraint FK8E3E9313B45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table broker_groups_transaction_fees add index FK8E3E9313CA99FDAA (transaction_fee_id), add constraint FK8E3E9313CA99FDAA foreign key (transaction_fee_id) references transaction_fees (id)</item>
      
            <!-- 3.5_dev14 -->
            <item>alter table custom_fields add column parent_id integer</item>
            <item>alter table custom_fields add index FK2EE15F478988CA47 (parent_id), add constraint FK2EE15F478988CA47 foreign key (parent_id) references custom_fields (id)</item>
            <item>alter table custom_field_possible_values add column parent_id integer</item>
            <item>alter table custom_field_possible_values add index FK8C2BD41DB0A99719 (parent_id), add constraint FK8C2BD41DB0A99719 foreign key (parent_id) references custom_field_possible_values (id)</item>
            <item>alter table custom_field_possible_values drop key field_id</item>
            <item>alter table custom_field_possible_values add unique key field_id (field_id, parent_id, value)</item>
      
            <!-- 3.5_dev15 -->
      
            <!-- 3.5_dev16 -->
      
            <!-- 3.5_dev17 -->
            <item>create table default_broker_commissions (id integer not null auto_increment, broker_id integer, broker_commission_id integer, amount numeric(15,6) not null, amount_type char(1) not null, when_apply varchar(1) not null, when_count integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table default_broker_commissions add index FK88481840F7069BBE (broker_commission_id), add constraint FK88481840F7069BBE foreign key (broker_commission_id) references transaction_fees (id)</item>
            <item>alter table default_broker_commissions add index FK884818404B8741B8 (broker_id), add constraint FK884818404B8741B8 foreign key (broker_id) references members (id)</item>
      
            <!-- 3.5_dev18 -->
            <item>create table broker_commission_contracts (id integer not null auto_increment, brokering_id integer, broker_commission_id integer, amount_value numeric(15,6) not null, amount_type char(1) not null, start_date date not null, end_date date, status varchar(1) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table broker_commission_contracts add index FK1AEDD3F3F7069BBE (broker_commission_id), add constraint FK1AEDD3F3F7069BBE foreign key (broker_commission_id) references transaction_fees (id)</item>
            <item>alter table broker_commission_contracts add index FK1AEDD3F3F096D933 (brokering_id), add constraint FK1AEDD3F3F096D933 foreign key (brokering_id) references brokerings (id)</item>
            <item>create table brokering_default_commission_status (id integer not null auto_increment, brokering_id integer, broker_commission_id integer, start_date date not null, end_date date, total_count integer default 0 not null, total_amount numeric(21,6) default 0 not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table brokering_default_commission_status add index FK24B5EFF2F7069BBE (broker_commission_id), add constraint FK24B5EFF2F7069BBE foreign key (broker_commission_id) references transaction_fees (id)</item>
            <item>alter table brokering_default_commission_status add index FK24B5EFF2F096D933 (brokering_id), add constraint FK24B5EFF2F096D933 foreign key (brokering_id) references brokerings (id)</item>
      
            <!-- 3.5_dev19 -->
            <item>alter table transfers add column chargeback_of_id bigint</item>
            <item>create table groups_chargeback_transfer_types (group_id integer not null, transfer_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table groups_chargeback_transfer_types add index FK895D5F9EA4766B0A (transfer_type_id), add constraint FK895D5F9EA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table groups_chargeback_transfer_types add index FK895D5F9E3794D57D (group_id), add constraint FK895D5F9E3794D57D foreign key (group_id) references groups (id)</item>
      
            <!-- 3.5_dev20 -->
            <item>alter table transfers add column broker_commission_contract_id integer</item>
            <item>alter table transfers add index FK3EBE45E81106EAD7 (broker_commission_contract_id), add constraint FK3EBE45E81106EAD7 foreign key (broker_commission_contract_id) references broker_commission_contracts (id)</item>
      
            <!-- 3.5_dev21 -->
            <item>create table brokering_commission_status (id integer not null auto_increment, brokering_id integer, broker_commission_id integer, start_date date not null, end_date date, total_count integer default 0 not null, total_amount numeric(21,6) default 0 not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table brokering_commission_status add index FK1E5A2870F7069BBE (broker_commission_id), add constraint FK1E5A2870F7069BBE foreign key (broker_commission_id) references transaction_fees (id)</item>
            <item>alter table brokering_commission_status add index FK1E5A2870F096D933 (brokering_id), add constraint FK1E5A2870F096D933 foreign key (brokering_id) references brokerings (id)</item>
      
            <!-- 3.5_dev22 -->
            <item>alter table brokering_commission_status add column expiry_date date</item>
      
            <!-- 3.5_dev23 -->
            <item>alter table transaction_fees change all_broker_groups all_broker_groups bit(1) not null default 0</item>
            <item>update transaction_fees set who_pays = 'S' where who_pays is null</item>
            <item>update transaction_fees set all_broker_groups = true where subclass = 'B'</item>
      
            <!-- 3.5_dev24 -->
            <item>alter table refs add column subclass varchar(1) not null default 'G'</item>
            <item>alter table refs add column reply_comments text</item>
            <item>alter table refs add column reply_comments_date datetime</item>
            <item>alter table refs add column admin_comments text</item>
            <item>alter table refs add column admin_comments_date datetime</item>
            <item>alter table refs add column transfer_id bigint</item>
            <item>alter table refs drop key from_member_id</item>
            <item>alter table refs add index FK355A402F78F3B3 (transfer_id), add constraint FK355A402F78F3B3 foreign key (transfer_id) references transfers (id)</item>
      
            <!-- 3.5_dev25 -->
            <item>insert into notification_preferences (type, member, is_message, is_email) select 'tfb', np.member, np.is_message, np.is_email from notification_preferences np where np.type='ref'</item>
      
            <!-- 3.5_dev26 -->
      
            <!-- 3.5_dev27 -->
            <item>alter table transfer_types add column requires_feedback bit not null</item>
            <item>alter table transfer_types add column feedback_expiration_time_number integer</item>
            <item>alter table transfer_types add column feedback_expiration_time_field integer</item>
            <item>alter table transfer_types add column feedback_reply_expiration_time_number integer</item>
            <item>alter table transfer_types add column feedback_reply_expiration_time_field integer</item>
            <item>alter table transfer_types add column default_feedback_comments text</item>
            <item>alter table transfer_types add column default_feedback_level tinyint</item>
      
            <!-- 3.5_dev28 -->
      
            <!-- 3.5_dev29 -->
            <item>alter table transfer_types add column feedback_enabled_since date</item>
      
            <!-- 3.5_dev30 -->
            <item>alter table transaction_fees add column max_fixed_value numeric(15,6)</item>
            <item>alter table transaction_fees add column max_percentage_value numeric(15,6)</item>
      
            <!-- 3.5_dev31 -->
            <item>create table admin_groups_create_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_create_member_record_types add index FK25883928E46288C5 (member_record_type_id), add constraint FK25883928E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_create_member_record_types add index FK258839283794D57D (group_id), add constraint FK258839283794D57D foreign key (group_id) references groups (id)</item>
            <item>create table admin_groups_modify_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_modify_member_record_types add index FKA1A2C5E6E46288C5 (member_record_type_id), add constraint FKA1A2C5E6E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_modify_member_record_types add index FKA1A2C5E63794D57D (group_id), add constraint FKA1A2C5E63794D57D foreign key (group_id) references groups (id)</item>
            <item>create table admin_groups_delete_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_delete_member_record_types add index FK7DBEF057E46288C5 (member_record_type_id), add constraint FK7DBEF057E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_delete_member_record_types add index FK7DBEF0573794D57D (group_id), add constraint FK7DBEF0573794D57D foreign key (group_id) references groups (id)</item>
            <item>create table admin_groups_create_admin_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_create_admin_record_types add index FK3A580A63E46288C5 (member_record_type_id), add constraint FK3A580A63E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_create_admin_record_types add index FK3A580A633794D57D (group_id), add constraint FK3A580A633794D57D foreign key (group_id) references groups (id)</item>
            <item>create table admin_groups_modify_admin_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_modify_admin_record_types add index FKC279EDE5E46288C5 (member_record_type_id), add constraint FKC279EDE5E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_modify_admin_record_types add index FKC279EDE53794D57D (group_id), add constraint FKC279EDE53794D57D foreign key (group_id) references groups (id)</item>
            <item>create table admin_groups_delete_admin_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table admin_groups_delete_admin_record_types add index FK13E63154E46288C5 (member_record_type_id), add constraint FK13E63154E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table admin_groups_delete_admin_record_types add index FK13E631543794D57D (group_id), add constraint FK13E631543794D57D foreign key (group_id) references groups (id)</item>
      
            <!-- 3.5_dev32 -->
      
            <!-- 3.5_dev33 -->
            <item>create table broker_groups_create_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_groups_create_member_record_types add index FKA9B20B32E46288C5 (member_record_type_id), add constraint FKA9B20B32E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table broker_groups_create_member_record_types add index FKA9B20B3285B3A90F (group_id), add constraint FKA9B20B3285B3A90F foreign key (group_id) references groups (id)</item>
            <item>create table broker_groups_modify_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_groups_modify_member_record_types add index FK25CC97F0E46288C5 (member_record_type_id), add constraint FK25CC97F0E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table broker_groups_modify_member_record_types add index FK25CC97F085B3A90F (group_id), add constraint FK25CC97F085B3A90F foreign key (group_id) references groups (id)</item>
            <item>create table broker_groups_delete_member_record_types (group_id integer not null, member_record_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_groups_delete_member_record_types add index FK1E8C261E46288C5 (member_record_type_id), add constraint FK1E8C261E46288C5 foreign key (member_record_type_id) references member_record_types (id)</item>
            <item>alter table broker_groups_delete_member_record_types add index FK1E8C26185B3A90F (group_id), add constraint FK1E8C26185B3A90F foreign key (group_id) references groups (id)</item>
      
            <!-- 3.5_dev34 -->
      
            <!-- 3.5_dev35 -->
            <item>alter table brokering_commission_status add column max_count integer</item>
            <item>alter table brokering_commission_status add column amount numeric(15,6) not null</item>
            <item>alter table brokering_commission_status add column amount_type char(1) not null</item>
            <item>alter table brokering_commission_status add column creation_date datetime not null</item>
      
            <!-- 3.5_dev36 -->
            <item>update settings set type='mailTranslation' where type='mail' and name in ('invitationBCC', 'invitationSubject', 'invitationMessage', 'activationBCC', 'activationSubject', 'activationMessage', 'accountDetails', 'resetPasswordSubject', 'resetPasswordMessage', 'mailValidationSubject', 'mailValidationMessage')</item>
      
            <!-- 3.5_dev37 -->
            <item>alter table groups add column member_expire_number integer</item>
            <item>alter table groups add column member_expire_field integer</item>
            <item>alter table groups add column member_expire_group_id integer</item>
            <item>alter table groups add index FKB63DD9D46061A69 (member_expire_group_id), add constraint FKB63DD9D46061A69 foreign key (member_expire_group_id) references groups (id)</item>
            <item>alter table remarks modify writer_id integer</item>
      
            <!-- 3.5_dev38 -->
            <item>alter table tickets add column currency_id integer</item>
            <item>alter table tickets add index FKB124F6E7C0E7F6FA (currency_id), add constraint FKB124F6E7C0E7F6FA foreign key (currency_id) references currencies (id)</item>
      
            <!-- 3.5_dev39 -->
            <item>alter table brokering_commission_status add column when_apply varchar(1) not null</item>
      
            <!-- 3.5_dev40 -->
            <item>alter table refs add column scheduled_payment_id integer</item>
            <item>alter table refs add index FK355A40B3A79238 (scheduled_payment_id), add constraint FK355A40B3A79238 foreign key (scheduled_payment_id) references scheduled_payments (id)</item>
      
            <!-- 3.5_dev41 -->
            <item>update modules set name='memberCommissions', message_key='permission.memberCommissions' where name='memberCommissionContracts'</item>
            <item>update operations set message_key='permission.memberCommissions.view' where message_key='permission.memberCommissionContracts.view'</item>
      
            <!-- 3.5_dev42 -->
      
            <!-- 3.5_dev43 -->
            <item>create table service_client_permissions (service_client_id integer not null, operation varchar(50) not null, primary key (service_client_id, operation)) ENGINE=InnoDB</item>
            <item>create table service_clients (id integer not null auto_increment, name varchar(100) not null, address varchar(100) not null, username varchar(100), password varchar(100), primary key (id)) ENGINE=InnoDB</item>
            <item>alter table service_client_permissions add index FK6BF53FDABC65B77D (service_client_id), add constraint FK6BF53FDABC65B77D foreign key (service_client_id) references service_clients (id)</item>
      
            <!-- 3.5_dev44 -->
            <item>alter table broker_commission_contracts add column cancelled_by_id integer</item>
            <item>alter table broker_commission_contracts add index FK1AEDD3F397ECA054 (cancelled_by_id), add constraint FK1AEDD3F397ECA054 foreign key (cancelled_by_id) references members (id)</item>
      
            <!-- 3.5_dev45 -->
            <item>alter table members drop foreign key FK388EC9194B8741B8</item>
            <item>alter table members drop column broker_id</item>
      
            <!-- 3.5_dev46 -->
            <item>alter table default_broker_commissions add column set_by_broker bit</item>
      
            <!-- 3.5_dev47 -->
            <item>update default_broker_commissions set set_by_broker=false</item>
      
            <!-- 3.5_dev48 -->
      
            <!-- 3.5_dev49 -->
            <item>create table channels (id integer not null auto_increment, internal_name varchar(50) not null, display_name varchar(100) not null, use_pin bit not null, pmt_req_ws_url varchar(200), primary key (id), unique (internal_name)) ENGINE=InnoDB</item>
            <item>create table groups_channels (channel_id integer not null, group_id integer not null) ENGINE=InnoDB</item>
            <item>alter table groups_channels add index FKE6E149DBB45926EE (group_id), add constraint FKE6E149DBB45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table groups_channels add index FKE6E149DB9B71D578 (channel_id), add constraint FKE6E149DB9B71D578 foreign key (channel_id) references channels (id)</item>
            <item>create table groups_default_channels (group_id integer not null, channel_id integer not null) ENGINE=InnoDB</item>
            <item>alter table groups_default_channels add index FK9B33E319B45926EE (group_id), add constraint FK9B33E319B45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table groups_default_channels add index FK9B33E3199B71D578 (channel_id), add constraint FK9B33E3199B71D578 foreign key (channel_id) references channels (id)</item>
      
            <!-- 3.5_dev50 -->
            <item>create table transfer_types_channels (transfer_type_id integer not null, channel_id integer not null) ENGINE=InnoDB</item>
            <item>alter table transfer_types_channels add index FK6FBCF7AAA4766B0A (transfer_type_id), add constraint FK6FBCF7AAA4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
            <item>alter table transfer_types_channels add index FK6FBCF7AA9B71D578 (channel_id), add constraint FK6FBCF7AA9B71D578 foreign key (channel_id) references channels (id)</item>
      
            <!-- 3.5_dev51 -->
        
            <!-- 3.5_dev52 -->
            <item>alter table users add column pin varchar(64)</item>
            <item>alter table groups add column min_pin_length integer</item>
            <item>alter table groups add column max_pin_length integer</item>
            <item>create table members_channels (member_id integer not null, channel_id integer not null) ENGINE=InnoDB</item>
            <item>alter table members_channels add index FK66F8B836EAE0AB57 (member_id), add constraint FK66F8B836EAE0AB57 foreign key (member_id) references members (id)</item>
            <item>alter table members_channels add index FK66F8B8369B71D578 (channel_id), add constraint FK66F8B8369B71D578 foreign key (channel_id) references channels (id)</item>
            <item>update groups set min_pin_length=4, max_pin_length=4 where subclass in ('B', 'M')</item>
      
            <!-- 3.5_dev53 -->
            <item>update custom_fields set type='url' where internal_name='url'</item>
      
            <!-- 3.5_dev54 -->
            <item>alter table tickets add column subclass char(1) not null default 'W'</item>
            <item>alter table tickets modify column return_url varchar(150)</item>
            <item>alter table tickets modify column client_address varchar(40)</item>
            <item>alter table tickets modify column member_address varchar(40)</item>
            <item>alter table tickets add column from_channel_id integer</item>
            <item>alter table tickets add column to_channel_id integer</item>
            <item>alter table tickets add index FKB124F6E7EFF3852D (from_channel_id), add constraint FKB124F6E7EFF3852D foreign key (from_channel_id) references channels (id)</item>
            <item>alter table tickets add index FKB124F6E745B5D1BC (to_channel_id), add constraint FKB124F6E745B5D1BC foreign key (to_channel_id) references channels (id)</item>
      
            <!-- 3.5_dev55 -->
      
            <!-- 3.5_dev56 -->
            <item>update operations set message_key='permission.systemTranslation.manageMailTranslation' where name='manageMailTranslation'</item>
            <item>update operations set module_id=(select id from modules where name = 'systemTranslation') where name='manageMailTranslation'</item>
      
            <!-- 3.5_dev57 -->
      
            <!-- 3.5_dev58 -->
            <item>delete from settings where type='local' and name in ('enableExternalPayment', 'defaultExternalPaymentDescription', 'externalPaymentWhitelist', 'externalSearchWhitelist')</item>
    
            <!-- 3.5_dev59 -->
            <item>create table member_groups_sms_message_types (group_id integer not null, type varchar(3) not null) ENGINE=InnoDB</item>
            <item>alter table member_groups_sms_message_types add index FKCF01DA35B45926EE (group_id), add constraint FKCF01DA35B45926EE foreign key (group_id) references groups (id)</item>
            <item>create table member_groups_default_sms_message_types (group_id integer not null, type varchar(3) not null) ENGINE=InnoDB</item>
            <item>alter table member_groups_default_sms_message_types add index FKCDC0F1B7B45926EE (group_id), add constraint FKCDC0F1B7B45926EE foreign key (group_id) references groups (id)</item>
    
            <!-- 3.5_dev60 -->
            <item>alter table notification_preferences add column is_sms bit not null</item>
    
            <!-- 3.5_dev61 -->
            <item>alter table tickets add column transfer_type_id integer</item>
            <item>alter table tickets add index FKB124F6E7A4766B0A (transfer_type_id), add constraint FKB124F6E7A4766B0A foreign key (transfer_type_id) references transfer_types (id)</item>
    
            <!-- 3.5_dev62 -->
            <item>create table groups_request_payment_channels (group_id integer not null, channel_id integer not null) ENGINE=InnoDB</item>
            <item>alter table groups_request_payment_channels add index FK2975B9A4B45926EE (group_id), add constraint FK2975B9A4B45926EE foreign key (group_id) references groups (id)</item>
            <item>alter table groups_request_payment_channels add index FK2975B9A49B71D578 (channel_id), add constraint FK2975B9A49B71D578 foreign key (channel_id) references channels (id)</item>
    
            <!-- 3.5_dev63 -->
            <item>create table sms_logs (id integer not null auto_increment, member_id integer not null, date datetime not null, type varchar(3) not null, status varchar(1) not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table sms_logs add index FKF9D930D5EAE0AB57 (member_id), add constraint FKF9D930D5EAE0AB57 foreign key (member_id) references members (id)</item>
    
            <!-- 3.5_dev64 -->
    
            <!-- 3.5_dev65 -->
            <item>alter table groups add column sms_charge_transfer_type_id integer</item>
            <item>alter table groups add index FKB63DD9D4935D704F (sms_charge_transfer_type_id), add constraint FKB63DD9D4935D704F foreign key (sms_charge_transfer_type_id) references transfer_types (id)</item>
            <item>alter table groups add column sms_charge_amount decimal(15,6)</item>
    
            <!-- 3.5_dev66 -->
            <item>alter table sms_logs modify status varchar(2) not null</item>
    
            <!-- 3.5_dev67 -->
            <item>alter table transaction_fees add column payer varchar(3) not null</item>
            <item>alter table transaction_fees add column receiver varchar(3)</item>
            <item>alter table transaction_fees add column which_broker char(1)</item>
    
            <!-- 3.5_dev68 -->
            <item>delete from permissions where operation_id in (select id from operations where message_key='permission.adminMemberDocuments.view')</item>
            <item>delete from operations where message_key='permission.adminMemberDocuments.view'</item>
    
            <!-- 3.5_dev69 -->
            <item>create table broker_groups_possible_initial_groups (group_id integer not null, possible_initial_group_id integer not null) ENGINE=InnoDB</item>
            <item>alter table broker_groups_possible_initial_groups add index FK3DAD1F7885B3A90F (group_id), add constraint FK3DAD1F7885B3A90F foreign key (group_id) references groups (id)</item>
            <item>alter table broker_groups_possible_initial_groups add index FK3DAD1F782703D697 (possible_initial_group_id), add constraint FK3DAD1F782703D697 foreign key (possible_initial_group_id) references groups (id)</item>
            <item>insert into broker_groups_possible_initial_groups (group_id, possible_initial_group_id) select id, broker_initial_group_id from groups where subclass='B' and broker_initial_group_id is not null</item>
            <item>alter table groups drop foreign key FKB63DD9D4656A652F</item>
            <item>alter table groups drop column broker_initial_group_id</item>
    
            <!-- 3.5_dev70 -->
            <item>delete from files where type='H'</item>
    
            <!-- 3.5_g1 -->
            <item>create table guarantee_types (id integer not null auto_increment, name varchar(100) not null, description text, model varchar(2) not null, authorized_by varchar(1) not null, seller_owner bit not null, enabled bit not null, pending_guarantee_expiration_number integer, pending_guarantee_expiration_field integer, payment_obligation_period_number integer, payment_obligation_period_field integer, currency_id integer not null, loan_transfer_type_id integer not null, credit_fee_transfer_type_id integer not null, emission_fee_transfer_type_id integer not null, forward_transfer_type_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table guarantee_types add index FK43027402C0E7F6FA (currency_id), add constraint FK43027402C0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <item>alter table guarantee_types add index FK4302740234403429 (credit_fee_transfer_type_id), add constraint FK4302740234403429 foreign key (credit_fee_transfer_type_id) references transfer_types (id)</item>
            <item>alter table guarantee_types add index FK4302740220386E5B (emission_fee_transfer_type_id), add constraint FK4302740220386E5B foreign key (emission_fee_transfer_type_id) references transfer_types (id)</item>
            <item>alter table guarantee_types add index FK43027402D757D44 (forward_transfer_type_id), add constraint FK43027402D757D44 foreign key (forward_transfer_type_id) references transfer_types (id)</item>
            <item>alter table guarantee_types add index FK43027402B7718679 (loan_transfer_type_id), add constraint FK43027402B7718679 foreign key (loan_transfer_type_id) references transfer_types (id)</item>
            <item>create table group_guarantee_types (group_id integer not null, guarantee_type_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_guarantee_types add index FK7D9DE2429383E848 (guarantee_type_id), add constraint FK7D9DE2429383E848 foreign key (guarantee_type_id) references guarantee_types (id)</item>
            <item>alter table group_guarantee_types add index FK7D9DE242B45926EE (group_id), add constraint FK7D9DE242B45926EE foreign key (group_id) references groups (id)</item>
            <item>create table group_issue_certification_to (owner_group_id integer not null, related_group_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_issue_certification_to add index FK32219C86F0E43C82 (related_group_id), add constraint FK32219C86F0E43C82 foreign key (related_group_id) references groups (id)</item>
            <item>alter table group_issue_certification_to add index FK32219C865D14BEFA (owner_group_id), add constraint FK32219C865D14BEFA foreign key (owner_group_id) references groups (id)</item>
            <item>create table group_buy_with_payment_obligations_from (owner_group_id integer not null, related_group_id integer not null) ENGINE=InnoDB</item>
            <item>alter table group_buy_with_payment_obligations_from add index FKD0447BADF0E43C82 (related_group_id), add constraint FKD0447BADF0E43C82 foreign key (related_group_id) references groups (id)</item>
            <item>alter table group_buy_with_payment_obligations_from add index FKD0447BAD5D14BEFA (owner_group_id), add constraint FKD0447BAD5D14BEFA foreign key (owner_group_id) references groups (id)</item>
    
            <!-- 3.5_g2 -->
            <item>create table certifications (id integer not null auto_increment, amount numeric(15,6) not null, begin_date date, end_date date, status varchar(2) not null, emission_fee numeric(15,6), emission_fee_type char(1), credit_fee numeric(15,6) not null, credit_fee_type varchar(1) not null, qualification varchar(1) not null, guarantee_type_id integer not null, buyer_id integer not null, issuer_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table certifications add index FK591542F9608B319E (buyer_id), add constraint FK591542F9608B319E foreign key (buyer_id) references members (id)</item>
            <item>alter table certifications add index FK591542F99383E848 (guarantee_type_id), add constraint FK591542F99383E848 foreign key (guarantee_type_id) references guarantee_types (id)</item>
            <item>alter table certifications add index FK591542F9A5F0DAD8 (issuer_id), add constraint FK591542F9A5F0DAD8 foreign key (issuer_id) references members (id)</item>
            <item>create table certification_logs (id integer not null auto_increment, date datetime not null, status varchar(2) not null, certification_id integer not null, by_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table certification_logs add index FK75720E142B1214C2 (by_id), add constraint FK75720E142B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table certification_logs add index FK75720E14205CEC57 (certification_id), add constraint FK75720E14205CEC57 foreign key (certification_id) references certifications (id)</item>
            <item>create table guarantees (id integer not null auto_increment, identifier varchar(100), status varchar(2) not null, amount numeric(15,6) not null, credit_fee numeric(15,6), emission_fee numeric(15,6), begin_date date, end_date date, registration_date datetime not null, loan_id integer unique, guarantee_type_id integer not null, certification_id integer, buyer_id integer not null, seller_id integer, issuer_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table guarantees add index FKA37612EB608B319E (buyer_id), add constraint FKA37612EB608B319E foreign key (buyer_id) references members (id)</item>
            <item>alter table guarantees add index FKA37612EB9383E848 (guarantee_type_id), add constraint FKA37612EB9383E848 foreign key (guarantee_type_id) references guarantee_types (id)</item>
            <item>alter table guarantees add index FKA37612EB40A58052 (seller_id), add constraint FKA37612EB40A58052 foreign key (seller_id) references members (id)</item>
            <item>alter table guarantees add index FKA37612EBA5F0DAD8 (issuer_id), add constraint FKA37612EBA5F0DAD8 foreign key (issuer_id) references members (id)</item>
            <item>alter table guarantees add index FKA37612EB205CEC57 (certification_id), add constraint FKA37612EB205CEC57 foreign key (certification_id) references certifications (id)</item>
            <item>alter table guarantees add index FKA37612EBF9B21025 (loan_id), add constraint FKA37612EBF9B21025 foreign key (loan_id) references loans (id)</item>
            <item>create table guarantee_logs (id integer not null auto_increment, date datetime not null, status varchar(2) not null, guarantee_id integer not null, by_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table guarantee_logs add index FK22595062B1214C2 (by_id), add constraint FK22595062B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table guarantee_logs add index FK225950629C0E817 (guarantee_id), add constraint FK225950629C0E817 foreign key (guarantee_id) references guarantees (id)</item>
            <item>create table payment_obligations (id integer not null auto_increment, status varchar(2) not null, amount numeric(15,6) not null, expiration_date datetime not null, max_publish_date datetime not null, registration_date datetime not null, description text, guarantee_id integer, currency_id integer not null, buyer_id integer not null, seller_id integer not null, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table payment_obligations add index FK409CBDFCC0E7F6FA (currency_id), add constraint FK409CBDFCC0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <item>alter table payment_obligations add index FK409CBDFC29C0E817 (guarantee_id), add constraint FK409CBDFC29C0E817 foreign key (guarantee_id) references guarantees (id)</item>
            <item>alter table payment_obligations add index FK409CBDFC608B319E (buyer_id), add constraint FK409CBDFC608B319E foreign key (buyer_id) references members (id)</item>
            <item>alter table payment_obligations add index FK409CBDFC40A58052 (seller_id), add constraint FK409CBDFC40A58052 foreign key (seller_id) references members (id)</item>
            <item>create table payment_obligation_logs (id integer not null auto_increment, date datetime not null, status varchar(2) not null, payment_obligation_id integer not null, by_id integer, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table payment_obligation_logs add index FK6EE4F972B1214C2 (by_id), add constraint FK6EE4F972B1214C2 foreign key (by_id) references members (id)</item>
            <item>alter table payment_obligation_logs add index FK6EE4F973AEC8F84 (payment_obligation_id), add constraint FK6EE4F973AEC8F84 foreign key (payment_obligation_id) references payment_obligations (id)</item>
    
               <!-- 3.5_g3 -->
            <item>alter table transfer_types add column (grace_period_number integer)</item>
            <item>alter table transfer_types add column (grace_period_field integer)</item>
    
            <!-- 3.5_g4 -->
            <item>alter table certifications drop emission_fee</item>
            <item>alter table certifications drop emission_fee_type</item>
            <item>alter table certifications drop credit_fee</item>
            <item>alter table certifications drop credit_fee_type</item>
            <item>alter table guarantee_types drop seller_owner</item>
            <item>alter table guarantee_types add credit_fee numeric(15,6) default 0 not null</item>
            <item>alter table guarantee_types add credit_fee_type varchar(1) not null</item>
            <item>alter table guarantee_types add credit_fee_readonly bit not null</item>
            <item>alter table guarantee_types add issue_fee numeric(15,6) default 0 not null</item>
            <item>alter table guarantee_types add issue_fee_type varchar(1) not null</item>
            <item>alter table guarantee_types add issue_fee_readonly bit not null</item>
            <item>alter table guarantee_types drop foreign key FK4302740220386E5B</item>
            <item>alter table guarantee_types change emission_fee_transfer_type_id issue_fee_transfer_type_id integer</item>
            <item>alter table guarantee_types add constraint FK4302740220386E5B foreign key (issue_fee_transfer_type_id) references transfer_types (id)</item>
            <item>alter table guarantees change emission_fee issue_fee numeric(15,6)</item>
            <item>alter table guarantee_types modify credit_fee_transfer_type_id integer</item>
            <item>alter table guarantees add credit_fee_type varchar(1)</item>
            <item>alter table guarantees add issue_fee_type varchar(1)</item>
    
            <!-- 3.5_dev71 -->
            <item>create table admin_preferences_guarantee_types (preference_id integer not null, guarantee_type_id integer not null, primary key (preference_id, guarantee_type_id)) ENGINE=InnoDB</item>
            <item>alter table admin_preferences_guarantee_types add index FK9B3E7BCB9383E848 (guarantee_type_id), add constraint FK9B3E7BCB9383E848 foreign key (guarantee_type_id) references guarantee_types (id)</item>
            <item>alter table admin_preferences_guarantee_types add index FK9B3E7BCBFB43CB21 (preference_id), add constraint FK9B3E7BCBFB43CB21 foreign key (preference_id) references admin_notification_preferences (id)</item>
    
            <!-- 3.5_dev72 -->
            <item>update operations set name="acceptGuaranteesAsMember", message_key="permission.adminMemberGuarantees.acceptGuaranteesAsMember" where name="acceptGuarantees"</item>
    
            <!-- 3.5_dev73 -->
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.memberInvoices.acceptFromMember')</item>
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.memberInvoices.acceptFromSystem')</item>
            <item>delete from operations where message_key='permission.memberInvoices.acceptFromMember'</item>
            <item>delete from operations where message_key='permission.memberInvoices.acceptFromSystem'</item>
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.operatorInvoices.acceptFromMember')</item>
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.operatorInvoices.acceptFromSystem')</item>
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.operatorInvoices.deny')</item>
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.operatorInvoices.cancel')</item>
            <item>delete from operations where message_key='permission.operatorInvoices.acceptFromMember'</item>
            <item>delete from operations where message_key='permission.operatorInvoices.acceptFromSystem'</item>
            <item>delete from operations where message_key='permission.operatorInvoices.deny'</item>
            <item>delete from operations where message_key='permission.operatorInvoices.cancel'</item>
    
            <!-- 3.5_dev74 -->
            <item>update operations set module_id=(select id from modules where name='systemTranslation'), name='manageNotification', message_key='permission.systemTranslation.manageNotification' where message_key='permission.systemSettings.manageMessage'</item>
    
            <!-- 3.5_dev75 -->
            <item>alter table binary_files add column name varchar(255)</item>
    
            <!-- 3.5_dev76 -->
            <item>update operations set module_id=(select id from modules where name='brokerMembers'), message_key='permission.brokerMembers.manageDefaults' where message_key='permission.brokerCommissions.manageDefaults'</item>
            <item>update operations set module_id=(select id from modules where name='brokerMembers'), message_key='permission.brokerMembers.manageContracts' where message_key='permission.brokerCommissions.manageContracts'</item>
            <item>delete from modules where name='brokerCommissions'</item>
      
            <!-- 3.5_dev77 -->
            <item>alter table service_clients add column member_id integer</item>
            <item>alter table service_clients add index FK55B6E7EEAE0AB57 (member_id), add constraint FK55B6E7EEAE0AB57 foreign key (member_id) references members (id)</item>
    
            <!-- 3.5_dev78 -->
            <item>alter table guarantee_types add column credit_fee_payer varchar(1) not null</item>
            <item>alter table guarantee_types add column issue_fee_payer varchar(1) not null</item>
            
        </statements>
        
        <!-- No need to create the account status, as it was removed  
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.AccountStatusMigration" />
         -->
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.PasswordHashMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.GroupHistoryLogMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.DataBaseEncodingMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.GeneralRemarksMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.BrokeringCommissionStatusMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.ChannelsMigration" />
        <migration database="mysql" class="nl.strohalm.cyclos.setup.migrations.version3_5.TransactionFeesMigration" />
        
    </version>

    <version label="3.0.12">
        <bug-fixes>
            <item>Account fees charging negative balances were never being charged</item>
        </bug-fixes>
    </version>
    
    <version label="3.0.11">
        <enhancements>
            <item>Improved outgoing e-mails, by adding a reply-to when the message was sent from other member and using names, not just raw e-mail addresses</item>
        </enhancements>
        
        <bug-fixes>
            <item>Admins with permission to view a member's profile but not modify were always seeing the member as logged in</item>
            <item>There were problems with masked custom fields with no separator between inputs, like AAA### (did not happen with AAA-###)</item>
        </bug-fixes>
    </version>
    
    <version label="3.0.10">
        <enhancements>
            <item>Now other artifacts are placed together with the source files, such as translation files and hibernate mappings</item>
        </enhancements>
        
        <bug-fixes>
            <item>The maximum images per member setting was being used for advertisement images also, and not the correct 'max ad images per member'</item>
            <item>An admin could set a broker to be his own broker, making it impossible to assign him as broker of other members</item>
            <item>Now, e-mails are validated accepting all characters according to the RFC (http://en.wikipedia.org/wiki/E-mail_address)</item>
            <item>Fixed a problem when typing currency values with Opera</item>
        </bug-fixes>
    </version>
    
    <version label="3.0.9">
        <enhancements>
            <item>The WebService for searching members now has additional options: withImagesOnly, randomOrder</item>
            <item>The WebService for searching advertisements now has additional option: memberId</item>
            <item>Added the Japanese translation (thanks to Masahiro Mikami)</item>
        </enhancements>

        <bug-fixes>
            <item>An application error was being generated from the mobile payment when the member had insufficient funds</item>
            <item>Member reports with a specified period were displaying members that were activated after that period</item>
        </bug-fixes>
    </version>

    <version label="3.0.8">
        <bug-fixes>
            <item>On the administrator group permissions, system to system payments were being shown as available, even when not enabled</item>
            <item>Now the number of alerts displayed on the list is 200. For older alerts, the admin should use the alert history page</item>
            <item>The member filter on account history was not being used on Internet Explorer</item>
            <item>A member could see other member's profile without permissions through the advertisement link</item>
            <item>When associating an account type with a member group, no payment types for initial credit were shown, only when modifying those settings</item>
            <item>When a member custom field's name contained commas, only a comma would be displayed on the view profile page</item>
            <item>Invoices sent from system to member were not being alerted after the idle time specified on the alert settings</item>
            <item>The member reports as CSV had a wrong header</item>
            <item>The advertisement details page was not displaying the value of enumerated custom fields</item>
            <item>Advertisements not checked as external publication were being returned on searches through web services</item>
            <item>When customized the general_news.jsp page, a conflict alert was being generated on each server startup</item>            
            <item>Now on the member transactions report, payment filters' columns that don't have incoming / outgoing transfer types are not shown</item>
            <item>Brokers viewing a pending member's profile was viewing buttons for actions like payments and invoices</item>
            <item>Now allows member searches by group and group filters on web services</item>
            <item>Now customized files and documents may contain larger contents</item>
        </bug-fixes>
        
        <statements database="mysql">
            <item>alter table files modify original_contents mediumtext</item>
            <item>alter table files modify new_contents mediumtext</item>
            <item>alter table files modify contents mediumtext</item>
        </statements> 
    </version>

    <version label="3.0.7">
        <enhancements>
            <item>Now it is possible to apply the free base over account fees over positive or negative balance</item>
            <item>Now the advertisement currency is shown on both print and export</item>
            <item>Now required custom fields not visible to member (only to admin) are not validated on the public registration or on the member profile, only when an admin is editing the profile</item>
            <item>Now mails are sent on a separate thread, which avoids a delay when multiple mails should be sent</item>
            <item>Now both member lists and transactions reports may include the member's broker</item>
            <item>Now the date pattern shown besides date input fields is internationalized through translation keys</item>
        </enhancements>
        
        <bug-fixes>
            <item>Now numbers can be typed with a maximum length only, avoiding application errors</item>
            <item>Removed an unused administrator permission with a missing resource bundle key</item>
            <item>Fixed rounding issues with transaction fees</item>
            <item>Fixed a missing message key on print advertisements</item>
            <item>The notification preferences were not being created for members registered via the public registration (thanks to Norbert Kapp)</item>
            <item>Better support for additional character encodings</item>
            <item>The custom fields were not editable by broker</item>
            <item>Asynchronous requests (like member autocomplete) were using incorrect character encoding, which made special characters to not be recognized</item>
            <item>When a member was sending an invoice or performing self payments, sometimes additional destination accounts were being shown</item>
            <item>When removing permanently a member or admin with related data, an application error was generated instead of showing a message</item>
            <item>When performing payments in past date, generated transfers had the current date, not the past date</item>
            <item>The invoice list page had no pagination</item>
            <item>Messages generated by paying an account fee with direction 'to member' didn't handle variables well</item>
            <item>Messages sent from admin to group were being typed as they were sent directly to the member</item>
            <item>On both edit group settings and permissions, when cancelling the edition, the button used to navigate to each other is no longer disabled</item>
            <item>Since loans are not allowed on initial credit, now the loan transfer types are not shown on the edit group account settings page</item>
        </bug-fixes>

        <new-translation-keys>
            <item>global.datePattern.day</item>
            <item>global.datePattern.hour</item>
            <item>global.datePattern.minute</item>
            <item>global.datePattern.month</item>
            <item>global.datePattern.second</item>
            <item>global.datePattern.year</item>
        </new-translation-keys>
        
        <statements database="mysql">
            <item>delete from permissions where operation_id in (select id from operations where message_key = 'permission.systemReports.developments')</item> 
            <item>delete from operations where message_key = 'permission.systemReports.developments'</item>
            <item>insert into notification_preferences (type, member, is_message, is_email) select t.type, m.id, 1, 0 from (select 'mbr' as type union select 'a2m' union select 'a2g' union select 'acs' union select 'act' union select 'brk' union select 'pmt' union select 'loa' union select 'ade' union select 'adi' union select 'inv' union select 'ref') t, members m inner join groups g on m.group_id = g.id where m.subclass='M' and g.status='N' and not exists (select 1 from notification_preferences where member=m.id)</item>
            <item>update settings set value=replace(value, '#name#', '#account_fee#') where name in ('accountFeeReceivedMessage', 'accountFeeReceivedSubject')</item>
        </statements>
    </version>
    
    <version label="3.0.6">
        <enhancements>
            <item>Now the print transaction page shows the parent and child transactions</item>
            <item>Now there is a specific control to avoid double form submission</item>
        </enhancements>

        <bug-fixes>
            <item>Ad search was returning incorrect number of ads that expired today</item> 
            <item>After reaching the max number of ads, and removing one, only after a logout or server restart a member could publish more ads</item>
            <item>Web services advertisements search was not enforcing status to active, which made scheduled or expired ads to show up</item>
            <item>Custom fields for members editable only at registration were loosing their values when registering members</item>
            <item>The default database were being created with member custom fields visible only by the field owner, not other members</item>
            <item>Ad creation date was being reset on ad update</item>
            <item>Account fees having a recurrence of more than 1 days, weeks or months were being charged every day, week or month</item>
            <item>The reports menus were being shown to administrators, no matter who had permissions</item> 
        </bug-fixes>
        
        <new-translation-keys>
            <item>permission.systemReports.memberList</item>
        </new-translation-keys>
        
        <removed-translation-keys>
            <item>permission.systemReports.developments</item>
        </removed-translation-keys>
        
        <statements database="mysql">
            <item>update ads set creation_date=publication_start where creation_date is null</item>
            <item>delete from custom_field_values where member_id in (select id from members where subclass='A')</item>
            <item>update operations set name='memberList', message_key = 'permission.systemReports.memberList' where message_key = 'permission.systemReports.developments'</item>
            <item>delete from translation_messages where msg_key='permission.systemReports.developments'</item>
        </statements>
    </version>

    <version label="3.0.5">
        <bug-fixes>
            <item>A last time bug prevented all custom values to be saved on public registration</item>
        </bug-fixes>
    </version>

    <version label="3.0.4">
        <enhancements>
            <item>Added a new level to visibility access of a member custom field: other members, allowing a field to be visible by it's owner and not other members</item>
        </enhancements>
        
        <bug-fixes>
            <item>Only monthly account fees were being charged</item>
            <item>A member couldn't save his profile if a given custom field was not visible by him and it was required</item>
            <item>Removing an account fee that had already been charged resulted on an application error, not a message indicating it</item>
            <item>When uploading an invalid image, no more application error is generated, but a specific error message instead</item>
            <item>When saving a member group, he was removed from the list of account fees, which could lead to a group stop being charged</item>
            <item>After reenabling an administrator login, an application error was being generated</item>
            <item>When editing an admin group permissions, after adding or removing a member group from his management, the transfer types as member to system / member disappeared</item>
        </bug-fixes>

        <new-translation-keys>
            <item>customField.member.access.OTHER</item>
        </new-translation-keys>

        <statements database="mysql">
            <item>update custom_fields set member_visibility_access='O' where member_visibility_access='M'</item>
        </statements>
    </version>

    <version label="3.0.3">
        <enhancements>
            <item>Improved JavaScript performance, specially on Internet Explorer 6, making Cyclos a lot faster</item>
            <item>New icons, based on crystal svg</item>
            <item>Now members can add others to contacts directly on the his contact list</item>
            <item>Now the member search order is the same as the local settings' member result display (username or name), not only the username</item>
            <item>The member permissions to view messages are no longer related to categories. Categories are now related to sending message to the administration</item>
            <item>The advertisement web service now can query ads by publisher's group</item>
            <item>New advertisements for members with multiple currencies defaults to the default account's currency</item>
            <item>It's now possible to search advertisements by currency, when there are multiple options</item>
            <item>Now the system images are sorted according to the translation message</item>
            <item>Now, for sake of clarity, a broker viewing a member's invoice will only see the specific action buttons depending on incoming or outgoing invoice, not all</item>
            <item>Improved the search loan payments page, allowing filtering by multiple status</item>
            <item>Now on the print members page the broker is shown</item>
        </enhancements>
        
        <bug-fixes>
            <item>After validating fields, the focus was not being correctly set on the corresponding form control</item>
            <item>An application error was being generated when validating custom fields on the member profile</item>
            <item>The print loan payments operation was generating an error</item>
            <item>Expired loan payments couldn't be paid or discarded anymore</item>
            <item>Fixed some layout issues on the search messages page</item>
            <item>On the member group permissions, some unnecessary transaction types were being shown on the payment permission</item>
            <item>The 'published since' filter on advertisement search was not being applied</item>
            <item>When searching members by enumerated custom fields, when selecting more than one item there were no results</item>
            <item>When adding a new account to a member group, the form now comes initially writable</item>
            <item>When paying as member (by admin or broker), or sending an invoice, the member himself does not appear among the possible options</item>
            <item>The payment as member to member permission for administrator groups no longer includes payments for mobile or external</item>
            <item>The member export to csv now includes the e-mail</item>
            <item>The advertisement export to csv now includes the description</item>
            <item>Fixed the CSV export according to the standard format (see http://en.wikipedia.org/wiki/Comma-separated_values)</item>
            <item>When accepting invoices, the payment type list was being filled with payments the member didn't have permissions</item>
            <item>On the account history, amounts between 0 and 1 didn't show the signal</item>
            <item>Mails were sent without using the defined charset on local settings</item>
            <item>When creating an empty database, the cancelled invoice subject, under message settings, was not being read from the resource bundle</item>
            <item>When resetting and sending the password by mail, two confirmation dialogs were shown</item>
            <item>Now links to the application root are generated with a trailing forward slash, avoiding problems with apache httpd and mod_jk</item>
            <item>A member could not remove his ad's images</item>
            <item>On search and print loan payments, the discarded amount was wrong</item>
            <item>The print member list for brokers was showing only the members of the first page, not all</item>
            <item>The print members (both on member search and brokerings) were showing all custom fields enabled for print, not only those related to each member</item>
            <item>When confirming a payment with fees that deducts the total amount, the amount displayed on the pop-up was the original, not the deducted one</item>
            <item>When saving an adminstration group settings, the relationship with system account types were lost, causing some weird problems, like not being able to grant loans</item>
            <item>The header data on print account history was not taking in account all query parameters</item>
            <item>On firefox, the print page was always being print on a single page, despite the actual number of pages. That was a problem with the style sheet. You may need to re-apply the theme if there were no customizations to the style sheet (even the login) or re-merge the style.css</item>
            <item>A pending member couldn't be permanently removed</item>
            <item>The maximum ads per member group setting was not being used, allowing members to publish more ads</item>
            <item>After disconnecting a member, the filter for natures (admins, members, brokers) on the page was always reset to all</item>
        </bug-fixes>

        <new-helps>
            <item>add_contact.jsp</item>
        </new-helps>

        <new-translation-keys>
            <item>contact.title.add</item>
        </new-translation-keys>

        <statements database="mysql">
            <item>delete from images where subclass = 'sys' and name in ('delete.gif', 'dropdown.gif', 'edit_gray.gif', 'edit.gif', 
                'help.gif', 'message_read.gif', 'message_removed.gif', 'message_replied.gif', 'message_unread.gif', 'next.gif', 
                'permissions_gray.gif', 'permissions.gif', 'preview.gif', 'previous.gif', 'print.gif', 'save.gif', 'view.gif')</item>
        </statements>
    </version>
    
    <version label="3.0.2">
        <bug-fixes>
            <item>The removed group permissions were accidentally accessible via the group settings</item>
            <item>Only permanent ads were being returned when members were searching</item>
            <item>The whitelist settings for external search was not being applied for members search</item>
            <item>The administrator could remove a member - broker relationship</item>
            <item>When creating a transaction fee, system to member transfer types were not showing up</item>
        </bug-fixes>
    </version>

    <version label="3.0.1">
        <bug-fixes>
            <item>Due to an error in the build process the English help files where accidentally substituted by the Portuguese translation</item>
            <item>When an admin sent a message to multiple groups, only the first one actually received the message</item>
            <item>When adding an account to an inactive group with members, the members received the account, but the activation date was kept null</item>
            <item>On the administration profile page, when he had already logged, the last login field was showing 'false'</item>
            <item>When a member has multiple accounts, on the account information page, after selecting an specific account, the back button sent the user to the profile page, instead of the account list page</item>
        </bug-fixes>
    </version>

    <version label="3.0">
    
        <enhancements>
            <item>Minor layout improvements</item>
        </enhancements>
        
        <bug-fixes>
            <item>The default database was giving by default permissions to the System Administrator group that should be only manually, like making a payment with a specified date</item>
            <item>A member could not be changed to a removed group if he had transactions, even if his balance was zero</item>
            <item>The low credits message was not replacing the #creditLimit# variable</item>
            <item>The print brokered members was resulting in an application error</item>
            <item>The help page on the public member registration was being redirected to the login page</item>
            <item>After adding or removing a member from a loan group, the loan group was no longer editable</item>
            <item>The loan printing was sometimes giving an application error</item>
            <item>On Internet Explorer, the edit currency page had an error on clicking the Change button</item>
            <item>On a transaction details, a member was able to navigate through transactions not from or to his accounts when generated by transaction fees</item>
            <item>Generated payments for transaction fees were marked as performed by the member, what is not desireable for transaction fees of type destination</item>
        </bug-fixes>
        
        <new-helps>
            <item>actions_for_admin_query.jsp</item>
            <item>customized_static_files- missing text.jsp</item>
            <item>reportsStatsKeydevelopmentsThroughTheYears.jsp</item>
            <item>reportsStatsKeydevelopmentsTransactionAmount.jsp</item>
        </new-helps>

        <removed-helps>
            <item>Copy of reportsStatsKeydevelopmentsGrossProduct.jsp</item>
            <item>actions_for_admin_query..jsp</item>
            <item>customized_static_files- missing text..jsp</item>
        </removed-helps>

        <new-translation-keys>
            <item>customImage.choose</item>
            <item>customImage.error.wrongType</item>
            <item>reports.stats.activity.comparePeriods.grossProduct.row2</item>
            <item>reports.stats.activity.comparePeriods.grossProduct.row2.short</item>
            <item>reports.stats.activity.comparePeriods.numberTransactions.row2</item>
            <item>reports.stats.activity.comparePeriods.numberTransactions.row2.short</item>
            <item>reports.stats.activity.throughTime.grossProduct.col2</item>
            <item>reports.stats.activity.throughTime.grossProduct.col3</item>
            <item>reports.stats.activity.throughTime.grossProduct.col4</item>
            <item>reports.stats.activity.throughTime.nAll</item>
            <item>reports.stats.activity.throughTime.nTraders</item>
            <item>reports.stats.activity.throughTime.numberTransactions.col2</item>
            <item>reports.stats.activity.throughTime.numberTransactions.col3</item>
            <item>reports.stats.activity.throughTime.numberTransactions.col4</item>
            <item>reports.stats.activity.whatToShow.COMPARE_PERIODS</item>
            <item>reports.stats.activity.whatToShow.DISTRIBUTION</item>
            <item>reports.stats.activity.whatToShow.THROUGH_TIME</item>
        </new-translation-keys>

    </version>
    
    <version label="3.0_RC1">
        <enhancements>
            <item>Consistent currency management</item>
            <item>Possibility for an administrator or broker to perform invoice actions as a given member</item>
            <item>
                Refactoring changing Float values to BigDecimal values. These changes aim to previne
                loose of data caused by precision problems in calculations
            </item>
            <item>New error log page for administrators, allowing easy track of application errors</item>
            <item>
                Now account fees based on transactioned volume may have a tolerance period, 
                where balances kept for a time smaller than the tolerance period won't be charged
            </item>
            <item>Now the mobile service may be enabled per group</item>
            <item>Improved statistics section</item>
        </enhancements>
        
        <bug-fixes>
            <item>All known bugs were resolved</item>
        </bug-fixes>

        <new-libraries>
            <item>c3p0-0.9.1.1.jar</item>
            <item>hibernate-3.2.3.jar</item>
            <item>mysql-connector-java-5.1.0-bin.jar</item>
            <item>oscache-2.4.jar</item>
            <item>spring_2.0.4.jar</item>
            <item>xfire-all-1.2.6.jar</item>
        </new-libraries>

        <removed-libraries>
            <item>c3p0-0.9.0.jar</item>
            <item>ehcache-1.2.jar</item>
            <item>hibernate-3.2.2.jar</item>
            <item>mail.jar</item>
            <item>mysql-connector-java-3.1.12-bin.jar</item>
            <item>spring_2.0.3.jar</item>
            <item>xfire-all-1.2.4.jar</item>
        </removed-libraries>

        <new-helps>
            <item>currency_list.jsp</item>
            <item>edit_currency.jsp</item>
            <item>error_log_details.jsp</item>
            <item>error_log_result.jsp</item>
            <item>error_log_result_history.jsp</item>
            <item>reportsStatsActivityToptenGrossProduct.jsp</item>
            <item>reportsStatsActivityToptenLogin.jsp</item>
            <item>reportsStatsActivityToptenNumberTransactions.jsp</item>
            <item>reportsStatsKeydevelopmentsAverageAmountPerTransaction.jsp</item>
            <item>reportsStatsKeydevelopmentsHighestAmountPerTransaction.jsp</item>
            <item>reportsStatsKeydevelopmentsThroughTimeMonths.jsp</item>
            <item>reportsStatsKeydevelopmentsThroughTimeQuarters.jsp</item>
            <item>reportsStatsKeydevelopmentsThroughTimeYears.jsp</item>
            <item>search_error_log.jsp</item>
            <item>statsThroughTime.jsp</item>
        </new-helps>

        <removed-helps>
            <item>reportsStatsKeydevelopmentsThroughTheYears.jsp</item>
            <item>reportsStatsKeydevelopmentsTransactionAmount.jsp</item>
        </removed-helps>

        <new-static-files>
            <item>statistics_manual.jsp</item>
        </new-static-files>

        <new-translation-keys>
            <item>accountFee.tolerance</item>
            <item>accountHistory.finalBalance</item>
            <item>accountHistory.initialBalance</item>
            <item>accountType.currency</item>
            <item>adCategory.active</item>
            <item>adCategory.error.deactivating</item>
            <item>adCategory.error.removing</item>
            <item>currency.action.new</item>
            <item>currency.description</item>
            <item>currency.error.pattern</item>
            <item>currency.error.removing</item>
            <item>currency.inserted</item>
            <item>currency.modified</item>
            <item>currency.name</item>
            <item>currency.pattern</item>
            <item>currency.removeConfirmation</item>
            <item>currency.removed</item>
            <item>currency.symbol</item>
            <item>currency.title.insert</item>
            <item>currency.title.list</item>
            <item>currency.title.modify</item>
            <item>customField.member.access.REGISTRATION</item>
            <item>errorLog.date</item>
            <item>errorLog.loggedUser</item>
            <item>errorLog.loggedUser.none</item>
            <item>errorLog.parameters</item>
            <item>errorLog.path</item>
            <item>errorLog.removeOne.confirm</item>
            <item>errorLog.removeSelected.confirm</item>
            <item>errorLog.removed</item>
            <item>errorLog.search.date.begin</item>
            <item>errorLog.search.date.end</item>
            <item>errorLog.search.noResults</item>
            <item>errorLog.stackTrace</item>
            <item>errorLog.title.details</item>
            <item>errorLog.title.search</item>
            <item>errorLog.title.view</item>
            <item>global.month.APRIL</item>
            <item>global.month.AUGUST</item>
            <item>global.month.DECEMBER</item>
            <item>global.month.FEBRUARY</item>
            <item>global.month.JANUARY</item>
            <item>global.month.JULY</item>
            <item>global.month.JUNE</item>
            <item>global.month.MARCH</item>
            <item>global.month.MAY</item>
            <item>global.month.NOVEMBER</item>
            <item>global.month.OCTOBER</item>
            <item>global.month.SEPTEMBER</item>
            <item>global.quarter.FIRST</item>
            <item>global.quarter.FOURTH</item>
            <item>global.quarter.SECOND</item>
            <item>global.quarter.THIRD</item>
            <item>group.permissions</item>
            <item>group.settings</item>
            <item>home.admin.status.errors</item>
            <item>invoice.performedBy</item>
            <item>invoice.sentBy</item>
            <item>manual.title.stats</item>
            <item>menu.admin.accounts.currencies</item>
            <item>menu.admin.alerts.alertHistory</item>
            <item>menu.admin.alerts.errorLog</item>
            <item>menu.admin.alerts.errorLogHistory</item>
            <item>menu.admin.help.manual.stats</item>
            <item>messageCategory.noMessageCategories</item>
            <item>permission.adminMemberInvoices.acceptAsMemberFromMember</item>
            <item>permission.adminMemberInvoices.acceptAsMemberFromSystem</item>
            <item>permission.adminMemberInvoices.sendAsMemberToMember</item>
            <item>permission.adminMemberInvoices.sendAsMemberToSystem</item>
            <item>permission.brokerInvoices.acceptAsMemberFromMember</item>
            <item>permission.brokerInvoices.acceptAsMemberFromSystem</item>
            <item>permission.brokerInvoices.cancelAsMember</item>
            <item>permission.brokerInvoices.denyAsMember</item>
            <item>permission.brokerInvoices.sendAsMemberToMember</item>
            <item>permission.brokerInvoices.sendAsMemberToSystem</item>
            <item>permission.systemCurrencies</item>
            <item>permission.systemCurrencies.manage</item>
            <item>permission.systemCurrencies.view</item>
            <item>permission.systemErrorLog</item>
            <item>permission.systemErrorLog.manage</item>
            <item>permission.systemErrorLog.view</item>
            <item>profile.action.invoiceAsMemberToMember</item>
            <item>profile.action.invoiceAsMemberToSystem</item>
            <item>reports.members.date.current</item>
            <item>reports.members.date.empty</item>
            <item>reports.members.date.history</item>
            <item>reports.stats.activity.throughTime.grossProduct</item>
            <item>reports.stats.activity.throughTime.grossProduct.col1</item>
            <item>reports.stats.activity.throughTime.grossProduct.title</item>
            <item>reports.stats.activity.throughTime.grossProduct.yAxis</item>
            <item>reports.stats.activity.throughTime.loginTimes</item>
            <item>reports.stats.activity.throughTime.loginTimes.col1</item>
            <item>reports.stats.activity.throughTime.loginTimes.title</item>
            <item>reports.stats.activity.throughTime.loginTimes.yAxis</item>
            <item>reports.stats.activity.throughTime.numberTransactions</item>
            <item>reports.stats.activity.throughTime.numberTransactions.col1</item>
            <item>reports.stats.activity.throughTime.numberTransactions.title</item>
            <item>reports.stats.activity.throughTime.numberTransactions.yAxis</item>
            <item>reports.stats.activity.throughTime.percentageNoTrade</item>
            <item>reports.stats.activity.throughTime.percentageNoTrade.col1</item>
            <item>reports.stats.activity.throughTime.percentageNoTrade.title</item>
            <item>reports.stats.activity.throughTime.percentageNoTrade.yAxis</item>
            <item>reports.stats.activity.topten.grossProduct</item>
            <item>reports.stats.activity.topten.grossProduct.col1</item>
            <item>reports.stats.activity.topten.grossProduct.title</item>
            <item>reports.stats.activity.topten.login</item>
            <item>reports.stats.activity.topten.login.col1</item>
            <item>reports.stats.activity.topten.login.title</item>
            <item>reports.stats.activity.topten.member</item>
            <item>reports.stats.activity.topten.numberTransactions</item>
            <item>reports.stats.activity.topten.numberTransactions.col1</item>
            <item>reports.stats.activity.topten.numberTransactions.title</item>
            <item>reports.stats.comparedPeriods</item>
            <item>reports.stats.general.topten</item>
            <item>reports.stats.keydevelopments.error.finalDateLesserThanInitialDate</item>
            <item>reports.stats.keydevelopments.error.initialAndFinalYearsRequired</item>
            <item>reports.stats.keydevelopments.numberOfAds.created</item>
            <item>reports.stats.keydevelopments.numberOfAds.created.short</item>
            <item>reports.stats.keydevelopments.periodType.COMPARED_PERIODS</item>
            <item>reports.stats.keydevelopments.periodType.THROUGH_TIME</item>
            <item>reports.stats.keydevelopments.throughTime</item>
            <item>reports.stats.keydevelopments.throughTime.MONTH</item>
            <item>reports.stats.keydevelopments.throughTime.QUARTER</item>
            <item>reports.stats.keydevelopments.throughTime.YEAR</item>
            <item>reports.stats.keydevelopments.throughTime.alert</item>
            <item>reports.stats.keydevelopments.throughTime.months</item>
            <item>reports.stats.keydevelopments.throughTime.months.title</item>
            <item>reports.stats.keydevelopments.throughTime.months.xAxis</item>
            <item>reports.stats.keydevelopments.throughTime.quarters</item>
            <item>reports.stats.keydevelopments.throughTime.quarters.title</item>
            <item>reports.stats.keydevelopments.throughTime.quarters.xAxis</item>
            <item>reports.stats.keydevelopments.throughTime.selectMonths</item>
            <item>reports.stats.keydevelopments.throughTime.selectQuarters</item>
            <item>reports.stats.keydevelopments.throughTime.selectYears</item>
            <item>reports.stats.keydevelopments.throughTime.show</item>
            <item>reports.stats.keydevelopments.throughTime.throughTime</item>
            <item>reports.stats.keydevelopments.throughTime.title</item>
            <item>reports.stats.keydevelopments.throughTime.years</item>
            <item>reports.stats.keydevelopments.throughTime.years.title</item>
            <item>reports.stats.keydevelopments.throughTime.years.xAxis</item>
            <item>reports.stats.show</item>
            <item>reports.stats.throughTheTime</item>
            <item>settings.local.language.SPANISH_TIMEBANKS</item>
        </new-translation-keys>

        <removed-translation-keys>
            <item>reports.error.reportRetrieveError</item>
        </removed-translation-keys>

        <statements database="mysql">
            <item>alter table ads add column delete_date datetime</item>
            <item>alter table ads add column creation_date datetime</item>
            <item>update ads set creation_date = publication_start</item>
            <item>alter table ad_categories add column active bit not null</item>
            <item>update ad_categories set active=true</item>
            <item>
                create table login_history (id int(11) not null
                auto_increment, user_id int(11) not null, date date not
                null, remote_address varchar(15) not null, PRIMARY KEY
                (id), KEY fk_user (user_id), KEY FK88A801BEA19267FC
                (user_id), CONSTRAINT FK88A801BEA19267FC FOREIGN KEY
                (user_id) REFERENCES users (id)) ENGINE=InnoDB DEFAULT
                CHARSET=latin1;
            </item>
            <item>
                create table reference_history (id int(11) not null
                auto_increment, from_member_id int(11) not null,
                to_member_id int(11) not null, level tinyint(4) not
                null, start_date datetime, end_date datetime, PRIMARY
                KEY (id), KEY fk_from (from_member_id), KEY fk_to
                (to_member_id), KEY FKC9084FA09DCA1693 (to_member_id),
                KEY FKC9084FA0823FB102 (from_member_id), CONSTRAINT
                FKC9084FA0823FB102 FOREIGN KEY (from_member_id)
                REFERENCES members (id), CONSTRAINT FKC9084FA09DCA1693
                FOREIGN KEY (to_member_id) REFERENCES members (id))
                ENGINE=InnoDB DEFAULT CHARSET=latin1;
            </item>
            <item>alter table admin_view_message_categories rename can_view_message_categories</item>
            <item>create index ix_subclass_name on images (subclass, name)</item>
            <item>create index ix_subclass on images (subclass)</item>
            <item>alter table ads modify publication_start date</item>
            <item>alter table ads modify publication_end date</item>
            <item>alter table invoices add performed_by_id integer</item>
            <item>alter table invoices add sent_by_id integer</item>
            <item>create index fk_performed_by on invoices (performed_by_id)</item>
            <item>create index fk_sent_by on invoices (sent_by_id)</item>
            <item>alter table invoices add index FK25F222E6A440355B (sent_by_id), add constraint FK25F222E6A440355B foreign key (sent_by_id) references members (id)</item>
            <item>alter table invoices add index FK25F222E69F954783 (performed_by_id), add constraint FK25F222E69F954783 foreign key (performed_by_id) references members (id)</item>
            <item>update invoices set sent_by_id = from_member_id, performed_by_id = from_member_id</item>
            <item>create table currencies (id integer not null auto_increment, name varchar(100) not null, symbol varchar(20) not null, pattern varchar(30) not null, description text, primary key (id)) ENGINE=InnoDB</item>
            <item>alter table account_types add currency_id integer</item>
            <item>alter table account_types add index FKE0B42FE7C0E7F6FA (currency_id), add constraint FKE0B42FE7C0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <item>alter table account_types drop units_pattern</item>
            <item>alter table ads add currency_id integer</item>
            <item>alter table ads add index FK178B0C0E7F6FA (currency_id), add constraint FK178B0C0E7F6FA foreign key (currency_id) references currencies (id)</item>
            <item>insert into currencies (name, symbol, pattern) values ('Units', 'units', '#amount# units')</item>
            <item>update account_types set currency_id = 1</item>
            <item>update ads set currency_id = 1 where price is not null</item>
            <item>update alerts set removed = false where removed is null</item>
            <item>alter table alerts modify removed bit(1) not null</item>
            <item>create table error_log_entries (id integer not null auto_increment, date datetime not null, path varchar(200) not null, removed bit not null, logged_user_id integer, stack_trace text, primary key (id)) ENGINE=InnoDB</item>
            <item>create table error_log_entry_parameters (error_log_entry_id integer not null, value text, name varchar(100) not null, primary key (error_log_entry_id, name)) ENGINE=InnoDB</item>
            <item>create index fk_logged_user on error_log_entries (logged_user_id)</item>
            <item>alter table error_log_entries add index FKDBACAEDE2EB5623F (logged_user_id), add constraint FKDBACAEDE2EB5623F foreign key (logged_user_id) references users (id)</item>
            <item>alter table error_log_entry_parameters add index FKA47F4149820A7941 (error_log_entry_id), add constraint FKA47F4149820A7941 foreign key (error_log_entry_id) references error_log_entries (id)</item>
            <item>alter table account_fees add tolerance_number integer</item>
            <item>alter table account_fees add tolerance_field integer</item>
            <item>alter table account_fee_logs add tolerance_number integer</item>
            <item>alter table account_fee_logs add tolerance_field integer</item>
            <item>alter table account_fees modify amount numeric(15,6) not null</item>
            <item>alter table account_fees modify free_base numeric(15,6)</item>
            <item>alter table account_fee_logs modify amount numeric(15,6) not null</item>
            <item>alter table account_fee_logs modify free_base numeric(15,6)</item>
            <item>alter table account_fee_logs modify amount numeric(15,6) not null</item>
            <item>alter table loans modify total_amount numeric(15,6) not null</item>
            <item>alter table loans modify monthly_interest numeric(15,6)</item>
            <item>alter table loans modify expiration_daily_interest numeric(15,6)</item>
            <item>alter table loans modify grant_fee_value numeric(15,6)</item>
            <item>alter table loans modify expiration_fee_value numeric(15,6)</item>
            <item>alter table loan_payments modify amount numeric(15,6) not null</item>
            <item>alter table loan_payments modify repaid_amount numeric(15,6) not null</item>
            <item>alter table invoices modify amount numeric(15,6) not null</item>
            <item>alter table tickets modify amount numeric(15,6)</item>
            <item>alter table transfers modify amount numeric(15,6) not null</item>
            <item>alter table transfer_types modify max_amount_per_day numeric(15,6)</item>
            <item>alter table transfer_types modify loan_monthly_interest numeric(15,6)</item>
            <item>alter table transfer_types modify loan_expiration_daily_interest numeric(15,6)</item>
            <item>alter table transfer_types modify loan_grant_fee_value numeric(15,6)</item>
            <item>alter table transfer_types modify loan_expiration_fee_value numeric(15,6)</item>
            <item>alter table accounts modify credit_limit numeric(15,6)</item>
            <item>alter table accounts modify upper_credit_limit numeric(15,6)</item>
            <item>alter table member_group_account_settings modify default_credit_limit numeric(15,6) not null</item>
            <item>alter table member_group_account_settings modify default_upper_credit_limit numeric(15,6)</item>
            <item>alter table member_group_account_settings modify initial_credit numeric(15,6)</item>
            <item>alter table member_group_account_settings modify low_units numeric(15,6)</item>
            <item>alter table transaction_fees modify amount numeric(15,6)</item>
            <item>alter table ads modify price numeric(15,6)</item>
            <item>alter table ad_interests modify initial_price numeric(15,6)</item>
            <item>alter table ad_interests modify final_price numeric(15,6)</item>
            <item>update transfers set amount = round(amount, (select case value when 'ZERO' then 0 when 'ONE' then 1 when 'TWO' then 2 when 'THREE' then 3 when 'FOUR' then 4 when 'FIVE' then 5 when 'SIX' then 6 else 2 end from settings where name='precision'))</item>
            <item>alter table groups add column mobile_service char(1)</item>
            <item>update groups set mobile_service='B' where subclass in ('M', 'B')</item>
            <item>alter table tickets modify client_address varchar(40) not null</item>
            <item>alter table tickets modify member_address varchar(40) not null</item>
            <item>alter table login_history modify remote_address varchar(40) not null</item>
        </statements>
    </version>

    <version label="3.0_B2">

        <enhancements>
            <item>
                Messaging module, allowing members to send and receive
                internal messages or e-mails
            </item>
            <item>
                Members can now hide their mail addresses from other
                members, allowing them to receive messages from other
                members only through the messaging module
            </item>
            <item>
                Ad interests module, allowing members to set interests
                and be notified about new ads matching those interests
            </item>
            <item>
                Home page status window, showing open / new
                notifications
            </item>
            <item>
                Customization of application pages, allowing customizing
                any JSP file
            </item>
            <item>
                Customized files now have a built-in control for
                conflicts generated by new versions
            </item>
        </enhancements>

        <bug-fixes>
            <item>All known bugs were resolved</item>
        </bug-fixes>

        <new-libraries>
            <item>asm-2.2.2.jar</item>
            <item>asm-commons-2.2.2.jar</item>
            <item>asm-util-2.2.2.jar</item>
            <item>cglib-nodep-2.1_3.jar</item>
            <item>commons-io-1.3.1.jar</item>
            <item>hibernate-3.2.2.jar</item>
            <item>jcaptcha-all-1.0-RC4.jar</item>
            <item>spring_2.0.3.jar</item>
        </new-libraries>

        <removed-libraries>
            <item>asm.jar</item>
            <item>cglib-2.1.3.jar</item>
            <item>commons-io-1.2.jar</item>
            <item>hibernate-3.2.jar</item>
            <item>jcaptcha-all-1.0-RC3.jar</item>
            <item>spring_2.0.jar</item>
        </removed-libraries>

        <new-helps>
            <item>ad_interest_insert.jsp</item>
            <item>ad_interest_modify.jsp</item>
            <item>customize_application_pages.jsp</item>
            <item>customized_application_pages.jsp</item>
            <item>list_ad_interests.jsp</item>
            <item>manage_message_categories.jsp</item>
            <item>manage_notification_preferences.jsp</item>
            <item>member_status.jsp</item>
            <item>message_category_list.jsp</item>
            <item>search_messages_by_admin.jsp</item>
            <item>search_messages_by_member.jsp</item>
            <item>search_messages_result.jsp</item>
            <item>send_message_by_admin.jsp</item>
            <item>send_message_by_member.jsp</item>
            <item>view_message.jsp</item>
        </new-helps>

        <new-translation-keys>
            <item>adCategory.children</item>
            <item>adCategory.inserted</item>
            <item>adCategory.modified</item>
            <item>adCategory.name</item>
            <item>adCategory.new</item>
            <item>adCategory.parent</item>
            <item>adCategory.removeConfirmation</item>
            <item>adCategory.removed</item>
            <item>adCategory.root</item>
            <item>adCategory.title.insert</item>
            <item>adCategory.title.list</item>
            <item>adCategory.title.modify</item>
            <item>adCategoryerrorRemoving</item>
            <item>adInterest.adFields</item>
            <item>adInterest.category</item>
            <item>adInterest.error.missingData</item>
            <item>adInterest.groupFilter</item>
            <item>adInterest.inserted</item>
            <item>adInterest.keywords</item>
            <item>adInterest.modified</item>
            <item>adInterest.new</item>
            <item>adInterest.priceRange</item>
            <item>adInterest.removeOne.confirm</item>
            <item>adInterest.removeSelected.confirm</item>
            <item>adInterest.removed</item>
            <item>adInterest.title</item>
            <item>adInterest.title.insert</item>
            <item>adInterest.title.list</item>
            <item>adInterest.title.modify</item>
            <item>adInterest.type</item>
            <item>adInterest.type.OFFER</item>
            <item>adInterest.type.SEARCH</item>
            <item>alert.system.newVersionOfApplicationPage</item>
            <item>alert.system.newVersionOfHelpFile</item>
            <item>alert.system.newVersionOfStaticFile</item>
            <item>brokering.status.ACTI0VE</item>
            <item>createMember.public.alreadyExists</item>
            <item>customImage.system.message_read.gif</item>
            <item>customImage.system.message_removed.gif</item>
            <item>customImage.system.message_replied.gif</item>
            <item>customImage.system.message_unread.gif</item>
            <item>customizedFile.newContents</item>
            <item>customizedFile.newContentsNotification</item>
            <item>customizedFile.originalContents</item>
            <item>customizedFile.path</item>
            <item>customizedFile.resolveConflict</item>
            <item>customizedFile.title.applicationPage</item>
            <item>customizedFile.title.customize.page</item>
            <item>customizedFile.title.search.page</item>
            <item>customizedFile.type.APPLICATION_PAGE</item>
            <item>global.choose</item>
            <item>global.hide</item>
            <item>global.show</item>
            <item>global.up</item>
            <item>home.admin.status.openInvoices</item>
            <item>home.admin.status.unreadMessages</item>
            <item>home.member.status.title</item>
            <item>home.status.newPayments</item>
            <item>home.status.newReferences</item>
            <item>home.status.openInvoices</item>
            <item>home.status.openLoans</item>
            <item>home.status.unreadMessages</item>
            <item>menu.admin.contentManagement.applicationPage</item>
            <item>menu.admin.messages</item>
            <item>menu.admin.messages.messageCategory</item>
            <item>menu.admin.messages.messages</item>
            <item>menu.member.personal.messages</item>
            <item>menu.member.preferences</item>
            <item>menu.member.preferences.adInterests</item>
            <item>menu.member.preferences.notification</item>
            <item>menu.member.preferences.notifications</item>
            <item>message.action.DELETE</item>
            <item>message.action.MARK_AS_READ</item>
            <item>message.action.MARK_AS_UNREAD</item>
            <item>message.action.MOVE_TO_TRASH</item>
            <item>message.action.RESTORE</item>
            <item>message.action.choose</item>
            <item>message.action.confirmDelete</item>
            <item>message.action.reply</item>
            <item>message.actionPerformed.DELETE</item>
            <item>message.actionPerformed.MOVE_TO_TRASH</item>
            <item>message.actionPerformed.RESTORE</item>
            <item>message.body</item>
            <item>message.category</item>
            <item>message.category.choose</item>
            <item>message.category.noCategory</item>
            <item>message.date</item>
            <item>message.error.emailNotSent</item>
            <item>message.error.memberCannotReceive</item>
            <item>message.error.memberWontReceiveNotification</item>
            <item>message.from</item>
            <item>message.fromTo</item>
            <item>message.html</item>
            <item>message.link.label</item>
            <item>message.messageBox</item>
            <item>message.messageBox.INBOX</item>
            <item>message.messageBox.SENT</item>
            <item>message.messageBox.TRASH</item>
            <item>message.reply.subject</item>
            <item>message.rootType</item>
            <item>message.rootType.ADMIN</item>
            <item>message.rootType.MEMBER</item>
            <item>message.rootType.SYSTEM</item>
            <item>message.rootType.all</item>
            <item>message.search.keywords</item>
            <item>message.search.noResults</item>
            <item>message.sendTo</item>
            <item>message.sendTo.ADMIN</item>
            <item>message.sendTo.GROUP</item>
            <item>message.sendTo.MEMBER</item>
            <item>message.sent</item>
            <item>message.subject</item>
            <item>message.system</item>
            <item>message.title.send</item>
            <item>message.title.view</item>
            <item>message.to</item>
            <item>message.toGroups</item>
            <item>message.toMember</item>
            <item>message.type</item>
            <item>message.type.ACCESS</item>
            <item>message.type.ACCOUNT</item>
            <item>message.type.AD_EXPIRATION</item>
            <item>message.type.AD_INTEREST</item>
            <item>message.type.BROKERING</item>
            <item>message.type.FROM_ADMIN_TO_GROUP</item>
            <item>message.type.FROM_ADMIN_TO_MEMBER</item>
            <item>message.type.FROM_MEMBER</item>
            <item>message.type.INVOICE</item>
            <item>message.type.LOAN</item>
            <item>message.type.PAYMENT</item>
            <item>message.type.REFERENCE</item>
            <item>message.warning.messageNotReceivedByEmail</item>
            <item>messageCategory.action.new</item>
            <item>messageCategory.all</item>
            <item>messageCategory.inserted</item>
            <item>messageCategory.modified</item>
            <item>messageCategory.name</item>
            <item>messageCategory.removeConfirmation</item>
            <item>messageCategory.removed</item>
            <item>messageCategory.title.insert</item>
            <item>messageCategory.title.list</item>
            <item>messageCategory.title.modify</item>
            <item>notificationPreferences.email</item>
            <item>notificationPreferences.hasntEmail</item>
            <item>notificationPreferences.message</item>
            <item>notificationPreferences.modified</item>
            <item>notificationPreferences.title.name</item>
            <item>permission.adminMemberInvoices.accept</item>
            <item>permission.adminMemberInvoices.acceptAsMember</item>
            <item>permission.adminMemberInvoices.cancelAsMember</item>
            <item>permission.adminMemberInvoices.deny</item>
            <item>permission.adminMemberInvoices.denyAsMember</item>
            <item>permission.adminMemberInvoices.sendAsMember</item>
            <item>permission.adminMemberMessages.manage</item>
            <item>permission.adminMemberMessages.view</item>
            <item>permission.memberAdInterests.manage</item>
            <item>permission.memberInvoices.acceptFromMember</item>
            <item>permission.memberInvoices.acceptFromSystem</item>
            <item>permission.memberMessages</item>
            <item>permission.memberMessages.manage</item>
            <item>permission.memberMessages.sendToAdministration</item>
            <item>permission.memberMessages.sendToMember</item>
            <item>permission.memberMessages.view</item>
            <item>permission.memberPreferences</item>
            <item>permission.memberPreferences.manageAdInterests</item>
            <item>
                permission.memberPreferences.manageNotifications
            </item>
            <item>permission.systemMessageCategories</item>
            <item>permission.systemMessageCategories.manage</item>
            <item>permission.systemMessageCategories.view</item>
            <item>profile.action.message</item>
            <item>
                reports.stats.keydevelopments.averageAmountPerTransaction
            </item>
            <item>
                reports.stats.keydevelopments.averageAmountPerTransaction.title
            </item>
            <item>
                reports.stats.keydevelopments.averageAmountPerTransaction.yAxis
            </item>
            <item>
                reports.stats.keydevelopments.highestAmountPerTransaction
            </item>
            <item>
                reports.stats.keydevelopments.highestAmountPerTransaction.title
            </item>
            <item>
                reports.stats.keydevelopments.highestAmountPerTransaction.yAxis
            </item>
            <item>settings.local.memberResultDisplay</item>
            <item>settings.mail.blindCarbonCopy</item>
            <item>settings.message.accountFeeReceivedMessage</item>
            <item>settings.message.adInterestMessage</item>
            <item>settings.message.body</item>
            <item>settings.message.brokerRemovedRemarkComments</item>
            <item>settings.message.loanGrantedMessage</item>
            <item>settings.message.lowUnitsMessage</item>
            <item>settings.message.paymentReceivedMessage</item>
            <item>settings.message.referenceReceivedMessage</item>
            <item>settings.message.remark</item>
            <item>settings.message.subject</item>
            <item>theme.error.notSelected</item>
            <item>theme.select.message</item>
            <item>transfer.relatedTransfers</item>
            <item>translationMessage.action.export</item>
            <item>translationMessage.action.new</item>
            <item>translationMessage.import.confirmation</item>
            <item>translationMessage.import.error.noFile</item>
            <item>translationMessage.import.error.reading</item>
            <item>translationMessage.import.file</item>
            <item>translationMessage.import.type</item>
            <item>translationMessage.import.type.NEW_AND_MODIFIED</item>
            <item>translationMessage.import.type.ONLY_NEW</item>
            <item>translationMessage.import.type.REPLACE</item>
            <item>translationMessage.imported</item>
            <item>translationMessage.inserted</item>
            <item>translationMessage.key</item>
            <item>translationMessage.message</item>
            <item>translationMessage.modified</item>
            <item>translationMessage.removeOne.confirm</item>
            <item>translationMessage.removeSelected.confirm</item>
            <item>translationMessage.removed</item>
            <item>translationMessage.search.showOnlyEmpty</item>
            <item>translationMessage.title.export</item>
            <item>translationMessage.title.import</item>
            <item>translationMessage.title.insert</item>
            <item>translationMessage.title.modify</item>
            <item>translationMessage.title.search</item>
        </new-translation-keys>

        <removed-translation-keys>
            <item>category.children</item>
            <item>category.errorRemoving</item>
            <item>category.inserted</item>
            <item>category.modified</item>
            <item>category.name</item>
            <item>category.new</item>
            <item>category.parent</item>
            <item>category.removeConfirmation</item>
            <item>category.removed</item>
            <item>category.root</item>
            <item>category.title.insert</item>
            <item>category.title.list</item>
            <item>category.title.modify</item>
            <item>message.action.export</item>
            <item>message.import.confirmation</item>
            <item>message.import.error.noFile</item>
            <item>message.import.error.reading</item>
            <item>message.import.file</item>
            <item>message.import.type</item>
            <item>message.import.type.NEW_AND_MODIFIED</item>
            <item>message.import.type.ONLY_NEW</item>
            <item>message.import.type.REPLACE</item>
            <item>message.imported</item>
            <item>message.inserted</item>
            <item>message.key</item>
            <item>message.message</item>
            <item>message.modified</item>
            <item>message.removeOne.confirm</item>
            <item>message.removeSelected.confirm</item>
            <item>message.removed</item>
            <item>message.search.showOnlyEmpty</item>
            <item>message.title.export</item>
            <item>message.title.import</item>
            <item>message.title.insert</item>
            <item>message.title.modify</item>
            <item>personalMessage.date</item>
            <item>personalMessage.groups</item>
            <item>personalMessage.message</item>
            <item>personalMessage.removeSelectedConfirmation</item>
            <item>personalMessage.removeSingleConfirmation</item>
            <item>personalMessage.removed</item>
            <item>personalMessage.sent.group</item>
            <item>personalMessage.sent.member</item>
            <item>personalMessage.title.list</item>
            <item>personalMessage.title.send.group</item>
            <item>personalMessage.title.send.member</item>
            <item>settings.message.brokerRemovedMessage</item>
        </removed-translation-keys>

        <statements database="mysql">
            <item>alter table documents drop subclass</item>
            <item>
                alter table files add column original_contents text
                after contents
            </item>
            <item>
                alter table files add column new_contents text after
                original_contents
            </item>
            <item>
                delete from permissions where operation_id in (select
                o.id from operations o inner join modules m on
                o.module_id = m.id where m.name in
                ('adminMemberMessages', 'brokerMessages'))
            </item>
            <item>
                delete from operations where id in (select id from
                (select o.id from operations o inner join modules m on
                o.module_id = m.id where m.name in
                ('adminMemberMessages', 'brokerMessages')) as new_table)
            </item>
            <item>
                delete from modules where name in
                ('adminMemberMessages', 'brokerMessages')
            </item>
            <item>
                delete from messages where msg_key like
                '%adminMemberMessages%' or msg_key like
                '%brokerMessages%' or msg_key like 'personalMessage%' or
                msg_key like 'message.%'
            </item>
            <item>
                alter table messages rename translation_messages
            </item>
            <item>alter table categories rename ad_categories</item>
            <item>
                create table ad_interests ( id int(11) NOT NULL
                auto_increment, owner_id int(11) NOT NULL, title
                varchar(100) NOT NULL, trade_type varchar(1) NOT NULL,
                category_id int(11) default NULL, member_id int(11)
                default NULL, group_filter_id int(11) default NULL,
                initial_price float default NULL, final_price float
                default NULL, keywords varchar(255) default NULL,
                PRIMARY KEY (id), KEY fk_group_filter (group_filter_id),
                KEY fk_category (category_id), KEY fk_owner (owner_id),
                KEY fk_member (member_id), KEY FKD8DBB56DFE01A09E
                (owner_id), KEY FKD8DBB56DEAE0AB57 (member_id), KEY
                FKD8DBB56D3F6F4BDC (category_id), KEY FKD8DBB56D9D46A867
                (group_filter_id), CONSTRAINT FKD8DBB56D9D46A867 FOREIGN
                KEY (group_filter_id) REFERENCES group_filters (id),
                CONSTRAINT FKD8DBB56D3F6F4BDC FOREIGN KEY (category_id)
                REFERENCES ad_categories (id), CONSTRAINT
                FKD8DBB56DEAE0AB57 FOREIGN KEY (member_id) REFERENCES
                members (id), CONSTRAINT FKD8DBB56DFE01A09E FOREIGN KEY
                (owner_id) REFERENCES members (id) ) ENGINE=InnoDB
            </item>
            <item>
                create table message_categories ( id integer not null
                auto_increment, name varchar(255) not null, PRIMARY KEY
                (id) ) ENGINE=InnoDB
            </item>
            <item>
                create table messages ( id integer not null
                auto_increment, date datetime not null, subject
                varchar(255) not null, type varchar(3) not null,
                direction varchar(1) not null, is_read bit not null,
                is_removed bit not null, is_replied bit not null,
                from_member_id integer, to_member_id integer,
                to_group_id integer, category_id integer, body text,
                primary key (id) ) ENGINE=InnoDB
            </item>
            <item>
                create index fk_category on messages (category_id)
            </item>
            <item>
                create index fk_to on messages (to_member_id,
                to_group_id)
            </item>
            <item>
                create index fk_from on messages (from_member_id)
            </item>
            <item>
                alter table messages add index FKE475014C1D376432
                (to_group_id), add constraint FKE475014C1D376432 foreign
                key (to_group_id) references groups (id)
            </item>
            <item>
                alter table messages add index FKE475014C3F6F4BDC
                (category_id), add constraint FKE475014C3F6F4BDC foreign
                key (category_id) references message_categories (id)
            </item>
            <item>
                alter table messages add index FKE475014C823FB102
                (from_member_id), add constraint FKE475014C823FB102
                foreign key (from_member_id) references members (id)
            </item>
            <item>
                alter table messages add index FKE475014C9DCA1693
                (to_member_id), add constraint FKE475014C9DCA1693
                foreign key (to_member_id) references members (id)
            </item>
            <item>
                create table admin_view_message_categories (group_id
                integer not null, category_id integer not null)
                ENGINE=InnoDB
            </item>
            <item>
                alter table admin_view_message_categories add index
                FKE4A2E43E3F6F4BDC (category_id), add constraint
                FKE4A2E43E3F6F4BDC foreign key (category_id) references
                message_categories (id)
            </item>
            <item>
                alter table admin_view_message_categories add index
                FKE4A2E43E3794D57D (group_id), add constraint
                FKE4A2E43E3794D57D foreign key (group_id) references
                groups (id)
            </item>
            <item>
                alter table members add hide_email bit(1) not null
                default false after group_id
            </item>
            <item>
                create table notification_preferences (id integer not
                null auto_increment, type varchar(3) not null, member
                integer, is_message bit not null, is_email bit not null,
                primary key (id)) ENGINE=InnoDB
            </item>
            <item>
                create index fk_member on notification_preferences
                (member)
            </item>
            <item>
                alter table notification_preferences add index
                FK9BBCBDA45AA28D11 (member), add constraint
                FK9BBCBDA45AA28D11 foreign key (member) references
                members (id)
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'mbr', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'a2m', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'a2g', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'acs', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'act', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'brk', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'pmt', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'loa', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'ade', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'adi', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'inv', id, false, true from
                members where subclass='M'
            </item>
            <item>
                insert into notification_preferences (type, member,
                is_email, is_message) select 'ref', id, false, true from
                members where subclass='M'
            </item>
            <item>
                delete from permissions where operation_id in (select
                o.id from operations o, modules m where o.module_id =
                m.id and o.name='manage' and
                m.name='adminMemberInvoices')
            </item>
            <item>
                delete from operations where name='manage' and module_id
                in (select id from modules where
                name='adminMemberInvoices')
            </item>
            <item>
                delete from permissions where operation_id in (select
                o.id from operations o, modules m where o.module_id =
                m.id and m.name='systemInvoices')
            </item>
            <item>
                delete from operations where module_id in (select id
                from modules where name='systemInvoices')
            </item>
            <item>delete from modules where name='systemInvoices'</item>
            <item>
                alter table messages add column is_html bit not null
            </item>
        </statements>
    </version>

    <version label="3.0_B1">
        <description>Initial beta release</description>
    </version>

</cyclos-changelog>